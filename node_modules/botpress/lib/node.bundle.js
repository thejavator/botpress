module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/Users/slvn/bots/botpress";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 29);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

eval("module.exports = require(\"lodash\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImxvZGFzaFwiPzBjOGIiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibG9kYXNoXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwibG9kYXNoXCJcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///0\n");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

eval("module.exports = require(\"path\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcInBhdGhcIj81YjJhIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInBhdGhcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJwYXRoXCJcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n");

/***/ }),
/* 2 */
/***/ (function(module, exports) {

eval("module.exports = require(\"fs\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImZzXCI/MmUwOSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJmc1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImZzXCJcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///2\n");

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _chalk = __webpack_require__(7);\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _module = __webpack_require__(35);\n\nvar _module2 = _interopRequireDefault(_module);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar IS_DEV = process.env.NODE_ENV !== 'production';\n\nvar NPM_CMD = /^win/.test(process.platform) ? 'npm.cmd' : 'npm';\n\nvar print = function print() {\n  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  var mapping = {\n    info: _chalk2.default.white,\n    warn: function warn() {\n      return _chalk2.default.yellow.apply(_chalk2.default, ['WARN'].concat(Array.prototype.slice.call(arguments)));\n    },\n    error: function error() {\n      return _chalk2.default.red.apply(_chalk2.default, ['ERR'].concat(Array.prototype.slice.call(arguments)));\n    },\n    success: function success() {\n      return _chalk2.default.green.apply(_chalk2.default, ['OK'].concat(Array.prototype.slice.call(arguments)));\n    }\n  };\n\n  var level = mapping[args[0]];\n  var matched = !!level;\n\n  if (!matched) {\n    level = mapping.info;\n  } else {\n    args.splice(0, 1);\n  }\n\n  console.log(_chalk2.default.black.bgWhite('[botpress]'), '\\t', level.apply(undefined, args));\n};\n\nvar resolveFromDir = function resolveFromDir(fromDir, moduleId) {\n  fromDir = _path2.default.resolve(fromDir);\n  var fromFile = _path2.default.join(fromDir, 'noop.js');\n  try {\n    return _module2.default._resolveFilename(moduleId, {\n      id: fromFile,\n      filename: fromFile,\n      paths: _module2.default._nodeModulePaths(fromDir)\n    });\n  } catch (err) {\n    return null;\n  }\n};\n\nvar resolveModuleRootPath = function resolveModuleRootPath(entryPath) {\n  var current = _path2.default.dirname(entryPath);\n  while (current !== '/') {\n    var lookup = _path2.default.join(current, 'package.json');\n    if (_fs2.default.existsSync(lookup)) {\n      return current;\n    }\n    current = _path2.default.resolve(_path2.default.join(current, '..'));\n  }\n  return null;\n};\n\nvar resolveProjectFile = function resolveProjectFile(file, projectLocation, throwIfNotExist) {\n  var packagePath = _path2.default.resolve(projectLocation || './', file);\n\n  if (!_fs2.default.existsSync(packagePath)) {\n    if (throwIfNotExist) {\n      throw new Error('Could not find bot\\'s package.json file');\n    }\n    return null;\n  }\n\n  return packagePath;\n};\n\nvar getDataLocation = function getDataLocation(dataDir, projectLocation) {\n  return dataDir && _path2.default.isAbsolute(dataDir) ? _path2.default.resolve(dataDir) : _path2.default.resolve(projectLocation, dataDir || 'data');\n};\n\nvar getBotpressVersion = function getBotpressVersion() {\n  var botpressPackagePath = _path2.default.join(__dirname, '../package.json');\n  var botpressJson = JSON.parse(_fs2.default.readFileSync(botpressPackagePath));\n  return botpressJson.version;\n};\n\nvar collectArgs = function collectArgs(val, memo) {\n  memo.push(val);\n  return memo;\n};\n\nmodule.exports = {\n  print: print,\n  resolveFromDir: resolveFromDir,\n  isDeveloping: IS_DEV,\n  resolveModuleRootPath: resolveModuleRootPath,\n  resolveProjectFile: resolveProjectFile,\n  getDataLocation: getDataLocation,\n  npmCmd: NPM_CMD,\n  getBotpressVersion: getBotpressVersion,\n  collectArgs: collectArgs\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdXRpbC5qcz8zNGE2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjaGFsayBmcm9tICdjaGFsaydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgTW9kdWxlIGZyb20gJ21vZHVsZSdcbmltcG9ydCBmcyBmcm9tICdmcydcblxuY29uc3QgSVNfREVWID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJ1xuXG5jb25zdCBOUE1fQ01EID0gL153aW4vLnRlc3QocHJvY2Vzcy5wbGF0Zm9ybSkgPyAnbnBtLmNtZCcgOiAnbnBtJ1xuXG5jb25zdCBwcmludCA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgY29uc3QgbWFwcGluZyA9IHtcbiAgICBpbmZvOiBjaGFsay53aGl0ZSxcbiAgICB3YXJuOiBmdW5jdGlvbigpIHsgcmV0dXJuIGNoYWxrLnllbGxvdygnV0FSTicsIC4uLmFyZ3VtZW50cykgfSxcbiAgICBlcnJvcjogZnVuY3Rpb24oKSB7IHJldHVybiBjaGFsay5yZWQoJ0VSUicsIC4uLmFyZ3VtZW50cykgfSxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHsgcmV0dXJuIGNoYWxrLmdyZWVuKCdPSycsIC4uLmFyZ3VtZW50cykgfVxuICB9XG5cbiAgbGV0IGxldmVsID0gbWFwcGluZ1thcmdzWzBdXVxuICBjb25zdCBtYXRjaGVkID0gISFsZXZlbFxuXG4gIGlmICghbWF0Y2hlZCkge1xuICAgIGxldmVsID0gbWFwcGluZy5pbmZvXG4gIH0gZWxzZSB7XG4gICAgYXJncy5zcGxpY2UoMCwgMSlcbiAgfVxuXG4gIGNvbnNvbGUubG9nKGNoYWxrLmJsYWNrLmJnV2hpdGUoJ1tib3RwcmVzc10nKSwgJ1xcdCcsIGxldmVsKC4uLmFyZ3MpKVxufVxuXG5jb25zdCByZXNvbHZlRnJvbURpciA9IGZ1bmN0aW9uIChmcm9tRGlyLCBtb2R1bGVJZCkge1xuICBmcm9tRGlyID0gcGF0aC5yZXNvbHZlKGZyb21EaXIpXG4gIGNvbnN0IGZyb21GaWxlID0gcGF0aC5qb2luKGZyb21EaXIsICdub29wLmpzJylcbiAgdHJ5IHtcbiAgICByZXR1cm4gTW9kdWxlLl9yZXNvbHZlRmlsZW5hbWUobW9kdWxlSWQsIHtcbiAgICAgIGlkOiBmcm9tRmlsZSxcbiAgICAgIGZpbGVuYW1lOiBmcm9tRmlsZSxcbiAgICAgIHBhdGhzOiBNb2R1bGUuX25vZGVNb2R1bGVQYXRocyhmcm9tRGlyKVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuY29uc3QgcmVzb2x2ZU1vZHVsZVJvb3RQYXRoID0gZnVuY3Rpb24oZW50cnlQYXRoKSB7XG4gIGxldCBjdXJyZW50ID0gcGF0aC5kaXJuYW1lKGVudHJ5UGF0aClcbiAgd2hpbGUgKGN1cnJlbnQgIT09ICcvJykge1xuICAgIGNvbnN0IGxvb2t1cCA9IHBhdGguam9pbihjdXJyZW50LCAncGFja2FnZS5qc29uJylcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhsb29rdXApKSB7XG4gICAgICByZXR1cm4gY3VycmVudFxuICAgIH1cbiAgICBjdXJyZW50ID0gcGF0aC5yZXNvbHZlKHBhdGguam9pbihjdXJyZW50LCAnLi4nKSlcbiAgfVxuICByZXR1cm4gbnVsbFxufVxuXG5jb25zdCByZXNvbHZlUHJvamVjdEZpbGUgPSAoZmlsZSwgcHJvamVjdExvY2F0aW9uLCB0aHJvd0lmTm90RXhpc3QpID0+IHtcbiAgY29uc3QgcGFja2FnZVBhdGggPSBwYXRoLnJlc29sdmUocHJvamVjdExvY2F0aW9uIHx8ICcuLycsIGZpbGUpXG5cbiAgaWYgKCFmcy5leGlzdHNTeW5jKHBhY2thZ2VQYXRoKSkge1xuICAgIGlmICh0aHJvd0lmTm90RXhpc3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgYm90XFwncyBwYWNrYWdlLmpzb24gZmlsZScpXG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICByZXR1cm4gcGFja2FnZVBhdGhcbn1cblxuY29uc3QgZ2V0RGF0YUxvY2F0aW9uID0gKGRhdGFEaXIsIHByb2plY3RMb2NhdGlvbikgPT4gKFxuICBkYXRhRGlyICYmIHBhdGguaXNBYnNvbHV0ZShkYXRhRGlyKVxuICAgID8gcGF0aC5yZXNvbHZlKGRhdGFEaXIpXG4gICAgOiBwYXRoLnJlc29sdmUocHJvamVjdExvY2F0aW9uLCBkYXRhRGlyIHx8ICdkYXRhJylcbilcblxuY29uc3QgZ2V0Qm90cHJlc3NWZXJzaW9uID0gKCkgPT4ge1xuICBjb25zdCBib3RwcmVzc1BhY2thZ2VQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL3BhY2thZ2UuanNvbicpXG4gIGNvbnN0IGJvdHByZXNzSnNvbiA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKGJvdHByZXNzUGFja2FnZVBhdGgpKVxuICByZXR1cm4gYm90cHJlc3NKc29uLnZlcnNpb25cbn1cblxuY29uc3QgY29sbGVjdEFyZ3MgPSAodmFsLCBtZW1vKSA9PiB7XG4gIG1lbW8ucHVzaCh2YWwpXG4gIHJldHVybiBtZW1vXG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHByaW50LFxuICByZXNvbHZlRnJvbURpcixcbiAgaXNEZXZlbG9waW5nOiBJU19ERVYsXG4gIHJlc29sdmVNb2R1bGVSb290UGF0aCxcbiAgcmVzb2x2ZVByb2plY3RGaWxlLFxuICBnZXREYXRhTG9jYXRpb24sXG4gIG5wbUNtZDogTlBNX0NNRCxcbiAgZ2V0Qm90cHJlc3NWZXJzaW9uLFxuICBjb2xsZWN0QXJnc1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy91dGlsLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUpBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///3\n");

/***/ }),
/* 4 */
/***/ (function(module, exports) {

eval("module.exports = require(\"bluebird\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImJsdWViaXJkXCI/ZmIzZSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJibHVlYmlyZFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImJsdWViaXJkXCJcbi8vIG1vZHVsZSBpZCA9IDRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///4\n");

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _moment = __webpack_require__(8);\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _isLite = function _isLite(knex) {\n  return knex.client.config.client === 'sqlite3';\n}; /*\n     The goal of these helpers is to generate SQL queries\n     that are valid for both SQLite and Postgres\n   */\n\nmodule.exports = function (knex) {\n\n  var dateParse = function dateParse(exp) {\n    return _isLite(knex) ? knex.raw('strftime(\\'%Y-%m-%dT%H:%M:%fZ\\', ' + exp + ')') : knex.raw(exp);\n  };\n\n  var dateFormat = function dateFormat(date) {\n    var iso = (0, _moment2.default)(date).toDate().toISOString();\n    return dateParse('\\'' + iso + '\\'');\n  };\n\n  var columnOrDateFormat = function columnOrDateFormat(colOrDate) {\n    var lite = _isLite(knex);\n\n    if (colOrDate.sql) {\n      return colOrDate.sql;\n    }\n\n    if (typeof colOrDate === 'string') {\n      return lite ? dateParse(colOrDate) : '\"' + colOrDate + '\"';\n    }\n\n    return dateFormat(colOrDate);\n  };\n\n  return {\n    isLite: function isLite() {\n      return _isLite(knex);\n    },\n\n    // knex's createTableIfNotExists doesn't work with postgres\n    // https://github.com/tgriesser/knex/issues/1303\n    createTableIfNotExists: function createTableIfNotExists(tableName, cb) {\n      return knex.schema.hasTable(tableName).then(function (exists) {\n        if (exists) {\n          return;\n        }\n        return knex.schema.createTableIfNotExists(tableName, cb);\n      });\n    },\n\n    date: {\n      format: dateFormat,\n\n      now: function now() {\n        return _isLite(knex) ? knex.raw(\"strftime('%Y-%m-%dT%H:%M:%fZ', 'now')\") : knex.raw('now()');\n      },\n\n      isBefore: function isBefore(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw(d1 + ' < ' + d2);\n      },\n\n      isAfter: function isAfter(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw(d1 + ' > ' + d2);\n      },\n\n      isBetween: function isBetween(d1, d2, d3) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n        d3 = columnOrDateFormat(d3);\n\n        return knex.raw(d1 + ' BETWEEN ' + d2 + ' AND ' + d3);\n      },\n\n      isSameDay: function isSameDay(d1, d2) {\n        d1 = columnOrDateFormat(d1);\n        d2 = columnOrDateFormat(d2);\n\n        return knex.raw('date(' + d1 + ') = date(' + d2 + ')');\n      },\n\n      hourOfDay: function hourOfDay(date) {\n        date = columnOrDateFormat(date);\n        return _isLite(knex) ? knex.raw('strftime(\\'%H\\', ' + date + ')') : knex.raw('to_char(' + date + ', \\'HH24\\')');\n      }\n    },\n\n    bool: {\n\n      true: function _true() {\n        return _isLite(knex) ? 1 : true;\n      },\n      false: function _false() {\n        return _isLite(knex) ? 0 : false;\n      },\n      parse: function parse(value) {\n        return _isLite(knex) ? !!value : value;\n      }\n\n    },\n\n    json: {\n      set: function set(obj) {\n        return _isLite(knex) ? obj && JSON.stringify(obj) : obj;\n      },\n      get: function get(obj) {\n        return _isLite(knex) ? obj && JSON.parse(obj) : obj;\n      }\n    }\n\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvZGF0YWJhc2UvaGVscGVycy5qcz9lNGE5Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIFRoZSBnb2FsIG9mIHRoZXNlIGhlbHBlcnMgaXMgdG8gZ2VuZXJhdGUgU1FMIHF1ZXJpZXNcbiAgdGhhdCBhcmUgdmFsaWQgZm9yIGJvdGggU1FMaXRlIGFuZCBQb3N0Z3Jlc1xuKi9cblxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnXG5cbmNvbnN0IGlzTGl0ZSA9IGtuZXggPT4ge1xuICByZXR1cm4ga25leC5jbGllbnQuY29uZmlnLmNsaWVudCA9PT0gJ3NxbGl0ZTMnXG59XG5cbm1vZHVsZS5leHBvcnRzID0ga25leCA9PiB7XG5cbiAgY29uc3QgZGF0ZVBhcnNlID0gZXhwID0+IHtcbiAgICByZXR1cm4gaXNMaXRlKGtuZXgpXG4gICAgICA/IGtuZXgucmF3KGBzdHJmdGltZSgnJVktJW0tJWRUJUg6JU06JWZaJywgJHtleHB9KWApXG4gICAgICA6IGtuZXgucmF3KGV4cClcbiAgfVxuXG4gIGNvbnN0IGRhdGVGb3JtYXQgPSBkYXRlID0+IHtcbiAgICBjb25zdCBpc28gPSBtb21lbnQoZGF0ZSkudG9EYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIHJldHVybiBkYXRlUGFyc2UoYCcke2lzb30nYClcbiAgfVxuXG4gIGNvbnN0IGNvbHVtbk9yRGF0ZUZvcm1hdCA9IGNvbE9yRGF0ZSA9PiB7XG4gICAgY29uc3QgbGl0ZSA9IGlzTGl0ZShrbmV4KVxuXG4gICAgaWYgKGNvbE9yRGF0ZS5zcWwpIHtcbiAgICAgIHJldHVybiBjb2xPckRhdGUuc3FsXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBjb2xPckRhdGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gbGl0ZSA/IGRhdGVQYXJzZShjb2xPckRhdGUpIDogYFwiJHtjb2xPckRhdGV9XCJgXG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGVGb3JtYXQoY29sT3JEYXRlKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc0xpdGU6ICgpID0+IGlzTGl0ZShrbmV4KSxcblxuICAgIC8vIGtuZXgncyBjcmVhdGVUYWJsZUlmTm90RXhpc3RzIGRvZXNuJ3Qgd29yayB3aXRoIHBvc3RncmVzXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Rncmllc3Nlci9rbmV4L2lzc3Vlcy8xMzAzXG4gICAgY3JlYXRlVGFibGVJZk5vdEV4aXN0czogKHRhYmxlTmFtZSwgY2IpID0+IHtcbiAgICAgIHJldHVybiBrbmV4LnNjaGVtYS5oYXNUYWJsZSh0YWJsZU5hbWUpXG4gICAgICAgIC50aGVuKGV4aXN0cyA9PiB7XG4gICAgICAgICAgaWYgKGV4aXN0cykgeyByZXR1cm4gfVxuICAgICAgICAgIHJldHVybiBrbmV4LnNjaGVtYS5jcmVhdGVUYWJsZUlmTm90RXhpc3RzKHRhYmxlTmFtZSwgY2IpXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIGRhdGU6IHtcbiAgICAgIGZvcm1hdDogZGF0ZUZvcm1hdCxcblxuICAgICAgbm93OiAoKSA9PiBpc0xpdGUoa25leCkgPyBrbmV4LnJhdyhcInN0cmZ0aW1lKCclWS0lbS0lZFQlSDolTTolZlonLCAnbm93JylcIikgOiBrbmV4LnJhdygnbm93KCknKSxcblxuICAgICAgaXNCZWZvcmU6IChkMSwgZDIpID0+IHtcbiAgICAgICAgZDEgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDEpXG4gICAgICAgIGQyID0gY29sdW1uT3JEYXRlRm9ybWF0KGQyKVxuXG4gICAgICAgIHJldHVybiBrbmV4LnJhdyhkMSArICcgPCAnICsgZDIpXG4gICAgICB9LFxuXG4gICAgICBpc0FmdGVyOiAoZDEsIGQyKSA9PiB7XG4gICAgICAgIGQxID0gY29sdW1uT3JEYXRlRm9ybWF0KGQxKVxuICAgICAgICBkMiA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkMilcblxuICAgICAgICByZXR1cm4ga25leC5yYXcoZDEgKyAnID4gJyArIGQyKVxuICAgICAgfSxcblxuICAgICAgaXNCZXR3ZWVuOiAoZDEsIGQyLCBkMykgPT4ge1xuICAgICAgICBkMSA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkMSlcbiAgICAgICAgZDIgPSBjb2x1bW5PckRhdGVGb3JtYXQoZDIpXG4gICAgICAgIGQzID0gY29sdW1uT3JEYXRlRm9ybWF0KGQzKVxuXG4gICAgICAgIHJldHVybiBrbmV4LnJhdyhgJHtkMX0gQkVUV0VFTiAke2QyfSBBTkQgJHtkM31gKVxuICAgICAgfSxcblxuICAgICAgaXNTYW1lRGF5OiAoZDEsIGQyKSA9PiB7XG4gICAgICAgIGQxID0gY29sdW1uT3JEYXRlRm9ybWF0KGQxKVxuICAgICAgICBkMiA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkMilcblxuICAgICAgICByZXR1cm4ga25leC5yYXcoYGRhdGUoJHtkMX0pID0gZGF0ZSgke2QyfSlgKVxuICAgICAgfSxcblxuICAgICAgaG91ck9mRGF5OiBkYXRlID0+IHtcbiAgICAgICAgZGF0ZSA9IGNvbHVtbk9yRGF0ZUZvcm1hdChkYXRlKVxuICAgICAgICByZXR1cm4gaXNMaXRlKGtuZXgpXG4gICAgICAgICAgPyBrbmV4LnJhdyhgc3RyZnRpbWUoJyVIJywgJHtkYXRlfSlgKVxuICAgICAgICAgIDoga25leC5yYXcoYHRvX2NoYXIoJHtkYXRlfSwgJ0hIMjQnKWApXG4gICAgICB9XG4gICAgfSxcblxuICAgIGJvb2w6IHtcblxuICAgICAgdHJ1ZTogKCkgPT4gaXNMaXRlKGtuZXgpID8gMSA6IHRydWUsXG4gICAgICBmYWxzZTogKCkgPT4gaXNMaXRlKGtuZXgpID8gMCA6IGZhbHNlLFxuICAgICAgcGFyc2U6IHZhbHVlID0+IGlzTGl0ZShrbmV4KSA/ICEhdmFsdWUgOiB2YWx1ZVxuXG4gICAgfSxcblxuICAgIGpzb246IHtcbiAgICAgIHNldDogb2JqID0+IHtcbiAgICAgICAgcmV0dXJuIGlzTGl0ZShrbmV4KSA/IG9iaiAmJiBKU09OLnN0cmluZ2lmeShvYmopIDogb2JqXG4gICAgICB9LFxuICAgICAgZ2V0OiBvYmogPT4ge1xuICAgICAgICByZXR1cm4gaXNMaXRlKGtuZXgpID8gb2JqICYmIEpTT04ucGFyc2Uob2JqKSA6IG9ialxuICAgICAgfVxuICAgIH1cblxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2RhdGFiYXNlL2hlbHBlcnMuanMiXSwibWFwcGluZ3MiOiI7O0FBS0E7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBdkNBO0FBQ0E7QUF5Q0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBTEE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQWhFQTtBQXlFQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///5\n");

/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _os = __webpack_require__(17);\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _crypto = __webpack_require__(18);\n\nvar _crypto2 = _interopRequireDefault(_crypto);\n\nvar _universalAnalytics = __webpack_require__(36);\n\nvar _universalAnalytics2 = _interopRequireDefault(_universalAnalytics);\n\nvar _nodeMachineId = __webpack_require__(37);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (botfile) {\n\n  var visitor = null;\n  var queued = [];\n\n  (0, _nodeMachineId.machineId)().catch(function () {\n    var hash = _crypto2.default.createHash('sha256');\n    hash.update(_os2.default.arch() + _os2.default.hostname() + _os2.default.platform() + _os2.default.type());\n    return hash.digest('hex');\n  }).then(function (mid) {\n    visitor = (0, _universalAnalytics2.default)('UA-90044826-1', mid, { strictCidFormat: false });\n    queued.forEach(function (a) {\n      return a();\n    });\n    queued = [];\n  });\n\n  var track = function track(category, action) {\n    var label = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\n    if (!!botfile.optOutStats) {\n      return; // Don't track if bot explicitly opted out from stats collection\n    }\n\n    if (!visitor) {\n      queued.push(function () {\n        return track(category, action, label, value);\n      });\n      return;\n    }\n\n    visitor.event(category, action, label, value, function () {/* ignore errors */});\n  };\n\n  var trackException = function trackException(message) {\n    if (!!botfile.optOutStats) {\n      return; // Don't track if bot explicitly opted out from stats collection\n    }\n\n    if (!visitor) {\n      queued.push(function () {\n        return trackException(message);\n      });\n      return;\n    }\n\n    visitor.event(message, function () {/* ignore errors */});\n  };\n\n  return { track: track, trackException: trackException };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvc3RhdHMuanM/NjYzNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3MgZnJvbSAnb3MnXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0bydcbmltcG9ydCB1YSBmcm9tICd1bml2ZXJzYWwtYW5hbHl0aWNzJ1xuaW1wb3J0IHsgbWFjaGluZUlkIH0gZnJvbSAnbm9kZS1tYWNoaW5lLWlkJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IChib3RmaWxlKSA9PiB7XG5cbiAgbGV0IHZpc2l0b3IgPSBudWxsXG4gIGxldCBxdWV1ZWQgPSBbXVxuXG4gIG1hY2hpbmVJZCgpXG4gICAgLmNhdGNoKCgpID0+IHtcbiAgICAgIGNvbnN0IGhhc2ggPSBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMjU2JylcbiAgICAgIGhhc2gudXBkYXRlKG9zLmFyY2goKSArIG9zLmhvc3RuYW1lKCkgKyBvcy5wbGF0Zm9ybSgpICsgb3MudHlwZSgpKVxuICAgICAgcmV0dXJuIGhhc2guZGlnZXN0KCdoZXgnKVxuICAgIH0pXG4gICAgLnRoZW4obWlkID0+IHtcbiAgICAgIHZpc2l0b3IgPSB1YSgnVUEtOTAwNDQ4MjYtMScsIG1pZCwgeyBzdHJpY3RDaWRGb3JtYXQ6IGZhbHNlIH0pXG4gICAgICBxdWV1ZWQuZm9yRWFjaChhID0+IGEoKSlcbiAgICAgIHF1ZXVlZCA9IFtdXG4gICAgfSlcblxuICBjb25zdCB0cmFjayA9IChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCA9IG51bGwsIHZhbHVlID0gbnVsbCkgPT4ge1xuICAgIGlmICghIWJvdGZpbGUub3B0T3V0U3RhdHMpIHtcbiAgICAgIHJldHVybiAvLyBEb24ndCB0cmFjayBpZiBib3QgZXhwbGljaXRseSBvcHRlZCBvdXQgZnJvbSBzdGF0cyBjb2xsZWN0aW9uXG4gICAgfVxuXG4gICAgaWYgKCF2aXNpdG9yKSB7XG4gICAgICBxdWV1ZWQucHVzaCgoKSA9PiB0cmFjayhjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUpKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdmlzaXRvci5ldmVudChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUsICgpID0+IHsgLyogaWdub3JlIGVycm9ycyAqLyB9KVxuICB9XG5cbiAgY29uc3QgdHJhY2tFeGNlcHRpb24gPSBtZXNzYWdlID0+IHtcbiAgICBpZiAoISFib3RmaWxlLm9wdE91dFN0YXRzKSB7XG4gICAgICByZXR1cm4gLy8gRG9uJ3QgdHJhY2sgaWYgYm90IGV4cGxpY2l0bHkgb3B0ZWQgb3V0IGZyb20gc3RhdHMgY29sbGVjdGlvblxuICAgIH1cblxuICAgIGlmICghdmlzaXRvcikge1xuICAgICAgcXVldWVkLnB1c2goKCkgPT4gdHJhY2tFeGNlcHRpb24obWVzc2FnZSkpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB2aXNpdG9yLmV2ZW50KG1lc3NhZ2UsICgpID0+IHsgLyogaWdub3JlIGVycm9ycyAqLyB9KVxuICB9XG5cbiAgcmV0dXJuIHsgdHJhY2ssIHRyYWNrRXhjZXB0aW9uIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvc3RhdHMuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///6\n");

/***/ }),
/* 7 */
/***/ (function(module, exports) {

eval("module.exports = require(\"chalk\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImNoYWxrXCI/NTNmNyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjaGFsa1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImNoYWxrXCJcbi8vIG1vZHVsZSBpZCA9IDdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///7\n");

/***/ }),
/* 8 */
/***/ (function(module, exports) {

eval("module.exports = require(\"moment\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcIm1vbWVudFwiP2E4OGQiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibW9tZW50XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwibW9tZW50XCJcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///8\n");

/***/ }),
/* 9 */
/***/ (function(module, exports) {

eval("module.exports = require(\"child_process\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9leHRlcm5hbCBcImNoaWxkX3Byb2Nlc3NcIj80MzA4Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNoaWxkX3Byb2Nlc3NcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJjaGlsZF9wcm9jZXNzXCJcbi8vIG1vZHVsZSBpZCA9IDlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///9\n");

/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _child_process = __webpack_require__(9);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _moment = __webpack_require__(8);\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _axios = __webpack_require__(43);\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _configurator = __webpack_require__(44);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar MODULES_URL = 'https://s3.amazonaws.com/botpress-io/all-modules.json';\nvar FETCH_TIMEOUT = 5000;\n\nmodule.exports = function (logger, projectLocation, dataLocation, kvs) {\n  var log = function log(level) {\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (logger && logger[level]) {\n      logger[level].apply(undefined, args);\n    } else {\n      _util.print.apply(undefined, [level].concat(args));\n    }\n  };\n\n  var fetchAllModules = function fetchAllModules() {\n    return _axios2.default.get(MODULES_URL, { timeout: FETCH_TIMEOUT }).then(function (_ref) {\n      var data = _ref.data;\n      return data;\n    }).catch(function () {\n      return logger.error('Could not fetch modules');\n    });\n  };\n\n  var loadModules = function loadModules(moduleDefinitions, botpress) {\n    var loadedCount = 0;\n    var loadedModules = {};\n\n    moduleDefinitions.forEach(function (mod) {\n      // eslint-disable-next-line no-eval\n      var loader = eval('require')(mod.entry);\n\n      if ((typeof loader === 'undefined' ? 'undefined' : _typeof(loader)) !== 'object') {\n        return logger.warn('Ignoring module ' + mod.name + '. Invalid entry point signature.');\n      }\n\n      mod.handlers = loader;\n\n      try {\n        mod.configuration = (0, _configurator.createConfig)({\n          kvs: kvs,\n          name: mod.name,\n          botfile: botpress.botfile,\n          projectLocation: projectLocation,\n          options: loader.config || {}\n        });\n      } catch (err) {\n        logger.error('Invalid module configuration in module ' + mod.name + ':', err);\n      }\n\n      try {\n        loader.init && loader.init(botpress, mod.configuration);\n      } catch (err) {\n        logger.warn('Error during module initialization: ', err);\n      }\n\n      loadedModules[mod.name] = mod;\n      logger.info('Loaded ' + mod.name + ', version ' + mod.version);\n      loadedCount++;\n    });\n\n    if (loadedCount > 0) {\n      logger.info('Loaded ' + loadedCount + ' modules');\n    }\n\n    return loadedModules;\n  };\n\n  var scanModules = function scanModules() {\n    var packagePath = _path2.default.join(projectLocation, 'package.json');\n\n    if (!_fs2.default.existsSync(packagePath)) {\n      return logger.warn('No package.json found at project root, ' + \"which means botpress can't load any module for the bot.\");\n    }\n\n    // eslint-disable-next-line no-eval\n    var botPackage = eval('require')(packagePath);\n\n    var deps = botPackage.dependencies || {};\n    if (_util.isDeveloping) {\n      deps = _lodash2.default.merge(deps, botPackage.devDependencies || {});\n    }\n\n    return _lodash2.default.reduce(deps, function (result, value, key) {\n      if (!/^botpress-/i.test(key)) {\n        return result;\n      }\n      var entry = (0, _util.resolveFromDir)(projectLocation, key);\n      if (!entry) {\n        return result;\n      }\n      var root = (0, _util.resolveModuleRootPath)(entry);\n      if (!root) {\n        return result;\n      }\n\n      // eslint-disable-next-line no-eval\n      var modulePackage = eval('require')(_path2.default.join(root, 'package.json'));\n      if (!modulePackage.botpress) {\n        return result;\n      }\n\n      return result.push({\n        name: key,\n        root: root,\n        homepage: modulePackage.homepage,\n        settings: modulePackage.botpress,\n        version: modulePackage.version,\n        entry: entry\n      }) && result;\n    }, []);\n  };\n\n  var getRandomCommunityHero = _bluebird2.default.method(function () {\n    var modulesCachePath = _path2.default.join(dataLocation, './modules-cache.json');\n\n    return listAllCommunityModules().then(function () {\n      var _JSON$parse = JSON.parse(_fs2.default.readFileSync(modulesCachePath)),\n          modules = _JSON$parse.modules;\n\n      var module = _lodash2.default.sample(modules);\n\n      if (!module) {\n        return {\n          username: 'danyfs',\n          github: 'https://github.com/danyfs',\n          avatar: 'https://avatars1.githubusercontent.com/u/5629987?v=3',\n          contributions: 'many',\n          module: 'botpress'\n        };\n      }\n\n      var hero = _lodash2.default.sample(module.contributors);\n\n      return {\n        username: hero.login,\n        github: hero.html_url,\n        avatar: hero.avatar_url,\n        contributions: hero.contributions,\n        module: module.name\n      };\n    });\n  });\n\n  var mapModuleList = function mapModuleList(modules) {\n    var installed = listInstalledModules();\n    return modules.map(function (mod) {\n      return {\n        name: mod.name,\n        stars: mod.github.stargazers_count,\n        forks: mod.github.forks_count,\n        docLink: mod.homepage,\n        version: mod['dist-tags'].latest,\n        keywords: mod.keywords,\n        fullName: mod.github.full_name,\n        updated: mod.github.updated_at,\n        issues: mod.github.open_issues_count,\n        icon: mod.package.botpress.menuIcon,\n        description: mod.description,\n        installed: _lodash2.default.includes(installed, mod.name),\n        license: mod.license,\n        author: !mod.author.name ? mod.author : mod.author.name,\n        title: mod.title,\n        category: mod.category,\n        featured: mod.featured,\n        popular: mod.popular,\n        official: mod.official\n      };\n    });\n  };\n\n  var listAllCommunityModules = _bluebird2.default.method(function () {\n    if (!_fs2.default) {\n      return []; // TODO Fetch & return\n    }\n\n    var modulesCachePath = _path2.default.join(dataLocation, './modules-cache.json');\n    if (!_fs2.default.existsSync(modulesCachePath)) {\n      _fs2.default.writeFileSync(modulesCachePath, JSON.stringify({\n        modules: [],\n        updated: null\n      }));\n    }\n\n    var _JSON$parse2 = JSON.parse(_fs2.default.readFileSync(modulesCachePath)),\n        modules = _JSON$parse2.modules,\n        updated = _JSON$parse2.updated;\n\n    if (updated && (0, _moment2.default)().diff((0, _moment2.default)(updated), 'minutes') <= 30) {\n      return mapModuleList(modules);\n    }\n\n    return _bluebird2.default.props({\n      newModules: fetchAllModules()\n    }).then(function (_ref2) {\n      var newModules = _ref2.newModules;\n\n      if (!newModules || !newModules.length) {\n        if (modules.length > 0) {\n          logger.debug('Fetched invalid modules. Report this to the Botpress Team.');\n          return mapModuleList(modules);\n        } else {\n          newModules = newModules || [];\n        }\n      }\n\n      _fs2.default.writeFileSync(modulesCachePath, JSON.stringify({\n        modules: newModules,\n        updated: new Date()\n      }));\n\n      return mapModuleList(newModules);\n    });\n  });\n\n  var resolveModuleNames = function resolveModuleNames(names) {\n    return names.map(function (name) {\n      if (!name || typeof name !== 'string') {\n        throw new TypeError('Expected module name to be a string');\n      }\n\n      var basename = _path2.default.basename(name);\n      var modulePath = '';\n\n      if (basename !== name) {\n        modulePath = name.substr(0, name.length - basename.length);\n      }\n\n      if (basename.replace(/botpress-?/i, '').length === 0) {\n        throw new Error('Invalid module name: ' + basename);\n      }\n\n      if (!/^botpress-/i.test(basename)) {\n        basename = 'botpress-' + basename;\n      }\n\n      return _path2.default.join(modulePath, basename);\n    });\n  };\n\n  var runSpawn = function runSpawn(command) {\n    return new _bluebird2.default(function (resolve, reject) {\n      command.stdout.on('data', function (data) {\n        log('info', data.toString());\n      });\n\n      command.stderr.on('data', function (data) {\n        log('error', data.toString());\n      });\n\n      command.on('close', function (code) {\n        if (code > 0) {\n          reject();\n        } else {\n          resolve();\n        }\n      });\n    });\n  };\n\n  var installModules = _bluebird2.default.method(function () {\n    for (var _len2 = arguments.length, names = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      names[_key2] = arguments[_key2];\n    }\n\n    var modules = resolveModuleNames(names);\n\n    var install = (0, _child_process.spawn)(_util.npmCmd, ['install', '--save'].concat(_toConsumableArray(modules)), {\n      cwd: projectLocation\n    });\n\n    log('info', 'Installing modules: ' + modules.join(', '));\n\n    return runSpawn(install).then(function () {\n      return log('success', 'Modules successfully installed');\n    }).catch(function (err) {\n      log('error', 'An error occurred during modules installation.');\n      throw err;\n    });\n  });\n\n  var uninstallModules = _bluebird2.default.method(function () {\n    for (var _len3 = arguments.length, names = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      names[_key3] = arguments[_key3];\n    }\n\n    var modules = resolveModuleNames(names);\n    var uninstall = (0, _child_process.spawn)(_util.npmCmd, ['uninstall', '--save'].concat(_toConsumableArray(modules)), {\n      cwd: projectLocation\n    });\n\n    log('info', 'Uninstalling modules: ' + modules.join(', '));\n\n    return runSpawn(uninstall).then(function () {\n      return log('success', 'Modules successfully removed');\n    }).catch(function (err) {\n      log('error', 'An error occurred during modules removal.');\n      throw err;\n    });\n  });\n\n  var listInstalledModules = function listInstalledModules() {\n    var packagePath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse3 = JSON.parse(_fs2.default.readFileSync(packagePath)),\n        dependencies = _JSON$parse3.dependencies;\n\n    var prodDeps = _lodash2.default.keys(dependencies);\n\n    return _lodash2.default.filter(prodDeps, function (dep) {\n      return (/botpress-.+/i.test(dep)\n      );\n    });\n  };\n\n  return {\n    listAllCommunityModules: listAllCommunityModules,\n    getRandomCommunityHero: getRandomCommunityHero,\n    install: installModules,\n    uninstall: uninstallModules,\n    listInstalled: listInstalledModules,\n    _scan: scanModules,\n    _load: loadModules\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL21vZHVsZXMuanM/ZmNhMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcGF3biB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCdcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcydcbmltcG9ydCB7IGNyZWF0ZUNvbmZpZyB9IGZyb20gJy4vY29uZmlndXJhdG9yJ1xuXG5pbXBvcnQgeyBwcmludCwgaXNEZXZlbG9waW5nLCBucG1DbWQsIHJlc29sdmVNb2R1bGVSb290UGF0aCwgcmVzb2x2ZUZyb21EaXIsIHJlc29sdmVQcm9qZWN0RmlsZSB9IGZyb20gJy4vdXRpbCdcblxuY29uc3QgTU9EVUxFU19VUkwgPSAnaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2JvdHByZXNzLWlvL2FsbC1tb2R1bGVzLmpzb24nXG5jb25zdCBGRVRDSF9USU1FT1VUID0gNTAwMFxuXG5tb2R1bGUuZXhwb3J0cyA9IChsb2dnZXIsIHByb2plY3RMb2NhdGlvbiwgZGF0YUxvY2F0aW9uLCBrdnMpID0+IHtcbiAgY29uc3QgbG9nID0gKGxldmVsLCAuLi5hcmdzKSA9PiB7XG4gICAgaWYgKGxvZ2dlciAmJiBsb2dnZXJbbGV2ZWxdKSB7XG4gICAgICBsb2dnZXJbbGV2ZWxdLmFwcGx5KHRoaXMsIGFyZ3MpXG4gICAgfSBlbHNlIHtcbiAgICAgIHByaW50LmFwcGx5KHRoaXMsIFtsZXZlbCwgLi4uYXJnc10pXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZmV0Y2hBbGxNb2R1bGVzID0gKCkgPT4ge1xuICAgIHJldHVybiBheGlvc1xuICAgICAgLmdldChNT0RVTEVTX1VSTCwgeyB0aW1lb3V0OiBGRVRDSF9USU1FT1VUIH0pXG4gICAgICAudGhlbigoeyBkYXRhIH0pID0+IGRhdGEpXG4gICAgICAuY2F0Y2goKCkgPT4gbG9nZ2VyLmVycm9yKCdDb3VsZCBub3QgZmV0Y2ggbW9kdWxlcycpKVxuICB9XG5cbiAgY29uc3QgbG9hZE1vZHVsZXMgPSAobW9kdWxlRGVmaW5pdGlvbnMsIGJvdHByZXNzKSA9PiB7XG4gICAgbGV0IGxvYWRlZENvdW50ID0gMFxuICAgIGNvbnN0IGxvYWRlZE1vZHVsZXMgPSB7fVxuXG4gICAgbW9kdWxlRGVmaW5pdGlvbnMuZm9yRWFjaChtb2QgPT4ge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICAgIGNvbnN0IGxvYWRlciA9IGV2YWwoJ3JlcXVpcmUnKShtb2QuZW50cnkpXG5cbiAgICAgIGlmICh0eXBlb2YgbG9hZGVyICE9PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gbG9nZ2VyLndhcm4oYElnbm9yaW5nIG1vZHVsZSAke21vZC5uYW1lfS4gSW52YWxpZCBlbnRyeSBwb2ludCBzaWduYXR1cmUuYClcbiAgICAgIH1cblxuICAgICAgbW9kLmhhbmRsZXJzID0gbG9hZGVyXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIG1vZC5jb25maWd1cmF0aW9uID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgICAgICBrdnM6IGt2cyxcbiAgICAgICAgICBuYW1lOiBtb2QubmFtZSxcbiAgICAgICAgICBib3RmaWxlOiBib3RwcmVzcy5ib3RmaWxlLFxuICAgICAgICAgIHByb2plY3RMb2NhdGlvbixcbiAgICAgICAgICBvcHRpb25zOiBsb2FkZXIuY29uZmlnIHx8IHt9XG4gICAgICAgIH0pXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKGBJbnZhbGlkIG1vZHVsZSBjb25maWd1cmF0aW9uIGluIG1vZHVsZSAke21vZC5uYW1lfTpgLCBlcnIpXG4gICAgICB9XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGxvYWRlci5pbml0ICYmIGxvYWRlci5pbml0KGJvdHByZXNzLCBtb2QuY29uZmlndXJhdGlvbilcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2dnZXIud2FybignRXJyb3IgZHVyaW5nIG1vZHVsZSBpbml0aWFsaXphdGlvbjogJywgZXJyKVxuICAgICAgfVxuXG4gICAgICBsb2FkZWRNb2R1bGVzW21vZC5uYW1lXSA9IG1vZFxuICAgICAgbG9nZ2VyLmluZm8oYExvYWRlZCAke21vZC5uYW1lfSwgdmVyc2lvbiAke21vZC52ZXJzaW9ufWApXG4gICAgICBsb2FkZWRDb3VudCsrXG4gICAgfSlcblxuICAgIGlmIChsb2FkZWRDb3VudCA+IDApIHtcbiAgICAgIGxvZ2dlci5pbmZvKGBMb2FkZWQgJHtsb2FkZWRDb3VudH0gbW9kdWxlc2ApXG4gICAgfVxuXG4gICAgcmV0dXJuIGxvYWRlZE1vZHVsZXNcbiAgfVxuXG4gIGNvbnN0IHNjYW5Nb2R1bGVzID0gKCkgPT4ge1xuICAgIGNvbnN0IHBhY2thZ2VQYXRoID0gcGF0aC5qb2luKHByb2plY3RMb2NhdGlvbiwgJ3BhY2thZ2UuanNvbicpXG5cbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMocGFja2FnZVBhdGgpKSB7XG4gICAgICByZXR1cm4gbG9nZ2VyLndhcm4oXG4gICAgICAgICdObyBwYWNrYWdlLmpzb24gZm91bmQgYXQgcHJvamVjdCByb290LCAnICsgXCJ3aGljaCBtZWFucyBib3RwcmVzcyBjYW4ndCBsb2FkIGFueSBtb2R1bGUgZm9yIHRoZSBib3QuXCJcbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbFxuICAgIGNvbnN0IGJvdFBhY2thZ2UgPSBldmFsKCdyZXF1aXJlJykocGFja2FnZVBhdGgpXG5cbiAgICBsZXQgZGVwcyA9IGJvdFBhY2thZ2UuZGVwZW5kZW5jaWVzIHx8IHt9XG4gICAgaWYgKGlzRGV2ZWxvcGluZykge1xuICAgICAgZGVwcyA9IF8ubWVyZ2UoZGVwcywgYm90UGFja2FnZS5kZXZEZXBlbmRlbmNpZXMgfHwge30pXG4gICAgfVxuXG4gICAgcmV0dXJuIF8ucmVkdWNlKFxuICAgICAgZGVwcyxcbiAgICAgIChyZXN1bHQsIHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgaWYgKCEvXmJvdHByZXNzLS9pLnRlc3Qoa2V5KSkge1xuICAgICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbnRyeSA9IHJlc29sdmVGcm9tRGlyKHByb2plY3RMb2NhdGlvbiwga2V5KVxuICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJvb3QgPSByZXNvbHZlTW9kdWxlUm9vdFBhdGgoZW50cnkpXG4gICAgICAgIGlmICghcm9vdCkge1xuICAgICAgICAgIHJldHVybiByZXN1bHRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgICAgIGNvbnN0IG1vZHVsZVBhY2thZ2UgPSBldmFsKCdyZXF1aXJlJykocGF0aC5qb2luKHJvb3QsICdwYWNrYWdlLmpzb24nKSlcbiAgICAgICAgaWYgKCFtb2R1bGVQYWNrYWdlLmJvdHByZXNzKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICByZXN1bHQucHVzaCh7XG4gICAgICAgICAgICBuYW1lOiBrZXksXG4gICAgICAgICAgICByb290OiByb290LFxuICAgICAgICAgICAgaG9tZXBhZ2U6IG1vZHVsZVBhY2thZ2UuaG9tZXBhZ2UsXG4gICAgICAgICAgICBzZXR0aW5nczogbW9kdWxlUGFja2FnZS5ib3RwcmVzcyxcbiAgICAgICAgICAgIHZlcnNpb246IG1vZHVsZVBhY2thZ2UudmVyc2lvbixcbiAgICAgICAgICAgIGVudHJ5OiBlbnRyeVxuICAgICAgICAgIH0pICYmIHJlc3VsdFxuICAgICAgICApXG4gICAgICB9LFxuICAgICAgW11cbiAgICApXG4gIH1cblxuICBjb25zdCBnZXRSYW5kb21Db21tdW5pdHlIZXJvID0gUHJvbWlzZS5tZXRob2QoKCkgPT4ge1xuICAgIGNvbnN0IG1vZHVsZXNDYWNoZVBhdGggPSBwYXRoLmpvaW4oZGF0YUxvY2F0aW9uLCAnLi9tb2R1bGVzLWNhY2hlLmpzb24nKVxuXG4gICAgcmV0dXJuIGxpc3RBbGxDb21tdW5pdHlNb2R1bGVzKCkudGhlbigoKSA9PiB7XG4gICAgICBjb25zdCB7IG1vZHVsZXMgfSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKG1vZHVsZXNDYWNoZVBhdGgpKVxuXG4gICAgICBjb25zdCBtb2R1bGUgPSBfLnNhbXBsZShtb2R1bGVzKVxuXG4gICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXJuYW1lOiAnZGFueWZzJyxcbiAgICAgICAgICBnaXRodWI6ICdodHRwczovL2dpdGh1Yi5jb20vZGFueWZzJyxcbiAgICAgICAgICBhdmF0YXI6ICdodHRwczovL2F2YXRhcnMxLmdpdGh1YnVzZXJjb250ZW50LmNvbS91LzU2Mjk5ODc/dj0zJyxcbiAgICAgICAgICBjb250cmlidXRpb25zOiAnbWFueScsXG4gICAgICAgICAgbW9kdWxlOiAnYm90cHJlc3MnXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgaGVybyA9IF8uc2FtcGxlKG1vZHVsZS5jb250cmlidXRvcnMpXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXJuYW1lOiBoZXJvLmxvZ2luLFxuICAgICAgICBnaXRodWI6IGhlcm8uaHRtbF91cmwsXG4gICAgICAgIGF2YXRhcjogaGVyby5hdmF0YXJfdXJsLFxuICAgICAgICBjb250cmlidXRpb25zOiBoZXJvLmNvbnRyaWJ1dGlvbnMsXG4gICAgICAgIG1vZHVsZTogbW9kdWxlLm5hbWVcbiAgICAgIH1cbiAgICB9KVxuICB9KVxuXG4gIGNvbnN0IG1hcE1vZHVsZUxpc3QgPSBtb2R1bGVzID0+IHtcbiAgICBjb25zdCBpbnN0YWxsZWQgPSBsaXN0SW5zdGFsbGVkTW9kdWxlcygpXG4gICAgcmV0dXJuIG1vZHVsZXMubWFwKG1vZCA9PiAoe1xuICAgICAgbmFtZTogbW9kLm5hbWUsXG4gICAgICBzdGFyczogbW9kLmdpdGh1Yi5zdGFyZ2F6ZXJzX2NvdW50LFxuICAgICAgZm9ya3M6IG1vZC5naXRodWIuZm9ya3NfY291bnQsXG4gICAgICBkb2NMaW5rOiBtb2QuaG9tZXBhZ2UsXG4gICAgICB2ZXJzaW9uOiBtb2RbJ2Rpc3QtdGFncyddLmxhdGVzdCxcbiAgICAgIGtleXdvcmRzOiBtb2Qua2V5d29yZHMsXG4gICAgICBmdWxsTmFtZTogbW9kLmdpdGh1Yi5mdWxsX25hbWUsXG4gICAgICB1cGRhdGVkOiBtb2QuZ2l0aHViLnVwZGF0ZWRfYXQsXG4gICAgICBpc3N1ZXM6IG1vZC5naXRodWIub3Blbl9pc3N1ZXNfY291bnQsXG4gICAgICBpY29uOiBtb2QucGFja2FnZS5ib3RwcmVzcy5tZW51SWNvbixcbiAgICAgIGRlc2NyaXB0aW9uOiBtb2QuZGVzY3JpcHRpb24sXG4gICAgICBpbnN0YWxsZWQ6IF8uaW5jbHVkZXMoaW5zdGFsbGVkLCBtb2QubmFtZSksXG4gICAgICBsaWNlbnNlOiBtb2QubGljZW5zZSxcbiAgICAgIGF1dGhvcjogIW1vZC5hdXRob3IubmFtZSA/IG1vZC5hdXRob3IgOiBtb2QuYXV0aG9yLm5hbWUsXG4gICAgICB0aXRsZTogbW9kLnRpdGxlLFxuICAgICAgY2F0ZWdvcnk6IG1vZC5jYXRlZ29yeSxcbiAgICAgIGZlYXR1cmVkOiBtb2QuZmVhdHVyZWQsXG4gICAgICBwb3B1bGFyOiBtb2QucG9wdWxhcixcbiAgICAgIG9mZmljaWFsOiBtb2Qub2ZmaWNpYWxcbiAgICB9KSlcbiAgfVxuXG4gIGNvbnN0IGxpc3RBbGxDb21tdW5pdHlNb2R1bGVzID0gUHJvbWlzZS5tZXRob2QoKCkgPT4ge1xuICAgIGlmICghZnMpIHtcbiAgICAgIHJldHVybiBbXSAvLyBUT0RPIEZldGNoICYgcmV0dXJuXG4gICAgfVxuXG4gICAgY29uc3QgbW9kdWxlc0NhY2hlUGF0aCA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sICcuL21vZHVsZXMtY2FjaGUuanNvbicpXG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKG1vZHVsZXNDYWNoZVBhdGgpKSB7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKFxuICAgICAgICBtb2R1bGVzQ2FjaGVQYXRoLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kdWxlczogW10sXG4gICAgICAgICAgdXBkYXRlZDogbnVsbFxuICAgICAgICB9KVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IHsgbW9kdWxlcywgdXBkYXRlZCB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMobW9kdWxlc0NhY2hlUGF0aCkpXG5cbiAgICBpZiAodXBkYXRlZCAmJiBtb21lbnQoKS5kaWZmKG1vbWVudCh1cGRhdGVkKSwgJ21pbnV0ZXMnKSA8PSAzMCkge1xuICAgICAgcmV0dXJuIG1hcE1vZHVsZUxpc3QobW9kdWxlcylcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5wcm9wcyh7XG4gICAgICBuZXdNb2R1bGVzOiBmZXRjaEFsbE1vZHVsZXMoKVxuICAgIH0pLnRoZW4oKHsgbmV3TW9kdWxlcyB9KSA9PiB7XG4gICAgICBpZiAoIW5ld01vZHVsZXMgfHwgIW5ld01vZHVsZXMubGVuZ3RoKSB7XG4gICAgICAgIGlmIChtb2R1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBsb2dnZXIuZGVidWcoJ0ZldGNoZWQgaW52YWxpZCBtb2R1bGVzLiBSZXBvcnQgdGhpcyB0byB0aGUgQm90cHJlc3MgVGVhbS4nKVxuICAgICAgICAgIHJldHVybiBtYXBNb2R1bGVMaXN0KG1vZHVsZXMpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3TW9kdWxlcyA9IG5ld01vZHVsZXMgfHwgW11cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmcy53cml0ZUZpbGVTeW5jKFxuICAgICAgICBtb2R1bGVzQ2FjaGVQYXRoLFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kdWxlczogbmV3TW9kdWxlcyxcbiAgICAgICAgICB1cGRhdGVkOiBuZXcgRGF0ZSgpXG4gICAgICAgIH0pXG4gICAgICApXG5cbiAgICAgIHJldHVybiBtYXBNb2R1bGVMaXN0KG5ld01vZHVsZXMpXG4gICAgfSlcbiAgfSlcblxuICBjb25zdCByZXNvbHZlTW9kdWxlTmFtZXMgPSBuYW1lcyA9PiB7XG4gICAgcmV0dXJuIG5hbWVzLm1hcChuYW1lID0+IHtcbiAgICAgIGlmICghbmFtZSB8fCB0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgbW9kdWxlIG5hbWUgdG8gYmUgYSBzdHJpbmcnKVxuICAgICAgfVxuXG4gICAgICBsZXQgYmFzZW5hbWUgPSBwYXRoLmJhc2VuYW1lKG5hbWUpXG4gICAgICBsZXQgbW9kdWxlUGF0aCA9ICcnXG5cbiAgICAgIGlmIChiYXNlbmFtZSAhPT0gbmFtZSkge1xuICAgICAgICBtb2R1bGVQYXRoID0gbmFtZS5zdWJzdHIoMCwgbmFtZS5sZW5ndGggLSBiYXNlbmFtZS5sZW5ndGgpXG4gICAgICB9XG5cbiAgICAgIGlmIChiYXNlbmFtZS5yZXBsYWNlKC9ib3RwcmVzcy0/L2ksICcnKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG1vZHVsZSBuYW1lOiAke2Jhc2VuYW1lfWApXG4gICAgICB9XG5cbiAgICAgIGlmICghL15ib3RwcmVzcy0vaS50ZXN0KGJhc2VuYW1lKSkge1xuICAgICAgICBiYXNlbmFtZSA9IGBib3RwcmVzcy0ke2Jhc2VuYW1lfWBcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHBhdGguam9pbihtb2R1bGVQYXRoLCBiYXNlbmFtZSlcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgcnVuU3Bhd24gPSBjb21tYW5kID0+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29tbWFuZC5zdGRvdXQub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgbG9nKCdpbmZvJywgZGF0YS50b1N0cmluZygpKVxuICAgICAgfSlcblxuICAgICAgY29tbWFuZC5zdGRlcnIub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgbG9nKCdlcnJvcicsIGRhdGEudG9TdHJpbmcoKSlcbiAgICAgIH0pXG5cbiAgICAgIGNvbW1hbmQub24oJ2Nsb3NlJywgY29kZSA9PiB7XG4gICAgICAgIGlmIChjb2RlID4gMCkge1xuICAgICAgICAgIHJlamVjdCgpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZSgpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IGluc3RhbGxNb2R1bGVzID0gUHJvbWlzZS5tZXRob2QoKC4uLm5hbWVzKSA9PiB7XG4gICAgbGV0IG1vZHVsZXMgPSByZXNvbHZlTW9kdWxlTmFtZXMobmFtZXMpXG5cbiAgICBjb25zdCBpbnN0YWxsID0gc3Bhd24obnBtQ21kLCBbJ2luc3RhbGwnLCAnLS1zYXZlJywgLi4ubW9kdWxlc10sIHtcbiAgICAgIGN3ZDogcHJvamVjdExvY2F0aW9uXG4gICAgfSlcblxuICAgIGxvZygnaW5mbycsICdJbnN0YWxsaW5nIG1vZHVsZXM6ICcgKyBtb2R1bGVzLmpvaW4oJywgJykpXG5cbiAgICByZXR1cm4gcnVuU3Bhd24oaW5zdGFsbClcbiAgICAgIC50aGVuKCgpID0+IGxvZygnc3VjY2VzcycsICdNb2R1bGVzIHN1Y2Nlc3NmdWxseSBpbnN0YWxsZWQnKSlcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgICBsb2coJ2Vycm9yJywgJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBtb2R1bGVzIGluc3RhbGxhdGlvbi4nKVxuICAgICAgICB0aHJvdyBlcnJcbiAgICAgIH0pXG4gIH0pXG5cbiAgY29uc3QgdW5pbnN0YWxsTW9kdWxlcyA9IFByb21pc2UubWV0aG9kKCguLi5uYW1lcykgPT4ge1xuICAgIGxldCBtb2R1bGVzID0gcmVzb2x2ZU1vZHVsZU5hbWVzKG5hbWVzKVxuICAgIGNvbnN0IHVuaW5zdGFsbCA9IHNwYXduKG5wbUNtZCwgWyd1bmluc3RhbGwnLCAnLS1zYXZlJywgLi4ubW9kdWxlc10sIHtcbiAgICAgIGN3ZDogcHJvamVjdExvY2F0aW9uXG4gICAgfSlcblxuICAgIGxvZygnaW5mbycsIGBVbmluc3RhbGxpbmcgbW9kdWxlczogJHttb2R1bGVzLmpvaW4oJywgJyl9YClcblxuICAgIHJldHVybiBydW5TcGF3bih1bmluc3RhbGwpXG4gICAgICAudGhlbigoKSA9PiBsb2coJ3N1Y2Nlc3MnLCAnTW9kdWxlcyBzdWNjZXNzZnVsbHkgcmVtb3ZlZCcpKVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGxvZygnZXJyb3InLCAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIG1vZHVsZXMgcmVtb3ZhbC4nKVxuICAgICAgICB0aHJvdyBlcnJcbiAgICAgIH0pXG4gIH0pXG5cbiAgY29uc3QgbGlzdEluc3RhbGxlZE1vZHVsZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgcGFja2FnZVBhdGggPSByZXNvbHZlUHJvamVjdEZpbGUoJ3BhY2thZ2UuanNvbicsIHByb2plY3RMb2NhdGlvbiwgdHJ1ZSlcbiAgICBjb25zdCB7IGRlcGVuZGVuY2llcyB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGFja2FnZVBhdGgpKVxuICAgIGNvbnN0IHByb2REZXBzID0gXy5rZXlzKGRlcGVuZGVuY2llcylcblxuICAgIHJldHVybiBfLmZpbHRlcihwcm9kRGVwcywgZGVwID0+IC9ib3RwcmVzcy0uKy9pLnRlc3QoZGVwKSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgbGlzdEFsbENvbW11bml0eU1vZHVsZXMsXG4gICAgZ2V0UmFuZG9tQ29tbXVuaXR5SGVybyxcbiAgICBpbnN0YWxsOiBpbnN0YWxsTW9kdWxlcyxcbiAgICB1bmluc3RhbGw6IHVuaW5zdGFsbE1vZHVsZXMsXG4gICAgbGlzdEluc3RhbGxlZDogbGlzdEluc3RhbGxlZE1vZHVsZXMsXG4gICAgX3NjYW46IHNjYW5Nb2R1bGVzLFxuICAgIF9sb2FkOiBsb2FkTW9kdWxlc1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL21vZHVsZXMuanMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBU0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbkJBO0FBQUE7QUFxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBZkE7QUFBQTtBQUFBO0FBQ0E7QUFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRkE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFTQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///10\n");

/***/ }),
/* 11 */
/***/ (function(module, exports) {

eval("module.exports = require(\"knex\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJrbmV4XCI/ZjNhNiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJrbmV4XCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwia25leFwiXG4vLyBtb2R1bGUgaWQgPSAxMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///11\n");

/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar matches = function matches(conditions, event) {\n  if (!_lodash2.default.isPlainObject(conditions)) {\n    conditions = { text: conditions };\n  }\n\n  var pairs = _lodash2.default.toPairs(conditions);\n  return _lodash2.default.every(pairs, function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        key = _ref2[0],\n        comparrer = _ref2[1];\n\n    var eventValue = _lodash2.default.get(event, key, null);\n\n    if (_lodash2.default.isFunction(comparrer)) {\n      return comparrer(eventValue, event) === true;\n    } else if (_lodash2.default.isRegExp(comparrer)) {\n      var _matches = comparrer.test(eventValue);\n\n      if (_matches && _lodash2.default.isString(eventValue)) {\n        if (_lodash2.default.isNil(event.captured)) {\n          event.captured = [];\n        }\n\n        var a = _lodash2.default.tail(comparrer.exec(eventValue));\n        a.forEach(function (m) {\n          return event.captured.push(m);\n        });\n      }\n\n      return _matches;\n    } else {\n      return _lodash2.default.isEqual(comparrer, eventValue);\n    }\n  });\n};\n\nvar hear = function hear(conditions, callback) {\n  return function (event, next) {\n    var result = false;\n    if (_lodash2.default.isArray(conditions)) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = conditions[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var conditionsItem = _step.value;\n\n          if (matches(conditionsItem, event)) {\n            result = true;\n            break;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    } else {\n      result = matches(conditions, event);\n    }\n\n    if (result && _lodash2.default.isFunction(callback)) {\n      if (callback.length <= 1) {\n        if (_lodash2.default.isFunction(next)) {\n          next();\n        }\n        callback(event);\n      } else {\n        callback(event, next);\n      }\n    } else {\n      if (_lodash2.default.isFunction(next)) {\n        next();\n      }\n    }\n  };\n};\n\nmodule.exports = { hear: hear, matches: matches };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2xpc3RlbmVycy5qcz82MThjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuY29uc3QgbWF0Y2hlcyA9IGZ1bmN0aW9uKGNvbmRpdGlvbnMsIGV2ZW50KSB7XG4gIGlmICghXy5pc1BsYWluT2JqZWN0KGNvbmRpdGlvbnMpKSB7XG4gICAgY29uZGl0aW9ucyA9IHsgdGV4dDogY29uZGl0aW9ucyB9XG4gIH1cblxuICBjb25zdCBwYWlycyA9IF8udG9QYWlycyhjb25kaXRpb25zKVxuICByZXR1cm4gXy5ldmVyeShwYWlycywgKFtrZXksIGNvbXBhcnJlcl0pID0+IHtcbiAgICBjb25zdCBldmVudFZhbHVlID0gXy5nZXQoZXZlbnQsIGtleSwgbnVsbClcblxuICAgIGlmIChfLmlzRnVuY3Rpb24oY29tcGFycmVyKSkge1xuICAgICAgcmV0dXJuIGNvbXBhcnJlcihldmVudFZhbHVlLCBldmVudCkgPT09IHRydWVcbiAgICB9IGVsc2UgaWYgKF8uaXNSZWdFeHAoY29tcGFycmVyKSkge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IGNvbXBhcnJlci50ZXN0KGV2ZW50VmFsdWUpXG4gICAgICBcbiAgICAgIGlmIChtYXRjaGVzICYmIF8uaXNTdHJpbmcoZXZlbnRWYWx1ZSkpIHtcbiAgICAgICAgaWYgKF8uaXNOaWwoZXZlbnQuY2FwdHVyZWQpKSB7XG4gICAgICAgICAgZXZlbnQuY2FwdHVyZWQgPSBbXVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBhID0gXy50YWlsKGNvbXBhcnJlci5leGVjKGV2ZW50VmFsdWUpKVxuICAgICAgICBhLmZvckVhY2gobSA9PiBldmVudC5jYXB0dXJlZC5wdXNoKG0pKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWF0Y2hlc1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXy5pc0VxdWFsKGNvbXBhcnJlciwgZXZlbnRWYWx1ZSlcbiAgICB9XG4gIH0pXG59XG5cbmNvbnN0IGhlYXIgPSBmdW5jdGlvbihjb25kaXRpb25zLCBjYWxsYmFjaykge1xuICByZXR1cm4gKGV2ZW50LCBuZXh0KSA9PiB7XG4gICAgbGV0IHJlc3VsdCA9IGZhbHNlXG4gICAgaWYgKF8uaXNBcnJheShjb25kaXRpb25zKSkge1xuICAgICAgZm9yIChsZXQgY29uZGl0aW9uc0l0ZW0gb2YgY29uZGl0aW9ucykge1xuICAgICAgICBpZiAobWF0Y2hlcyhjb25kaXRpb25zSXRlbSwgZXZlbnQpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gdHJ1ZVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0ID0gbWF0Y2hlcyhjb25kaXRpb25zLCBldmVudClcbiAgICB9XG5cbiAgICBpZiAocmVzdWx0ICYmIF8uaXNGdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgIGlmIChjYWxsYmFjay5sZW5ndGggPD0gMSkge1xuICAgICAgICBpZiAoXy5pc0Z1bmN0aW9uKG5leHQpKSB7IFxuICAgICAgICAgIG5leHQoKVxuICAgICAgICB9XG4gICAgICAgIGNhbGxiYWNrKGV2ZW50KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FsbGJhY2soZXZlbnQsIG5leHQpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChfLmlzRnVuY3Rpb24obmV4dCkpIHsgXG4gICAgICAgIG5leHQoKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgaGVhciwgbWF0Y2hlcyB9XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2xpc3RlbmVycy5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///12\n");

/***/ }),
/* 13 */
/***/ (function(module, exports) {

eval("module.exports = require(\"uuid\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1dWlkXCI/Mjk4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ1dWlkXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidXVpZFwiXG4vLyBtb2R1bGUgaWQgPSAxM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///13\n");

/***/ }),
/* 14 */
/***/ (function(module, exports) {

eval("module.exports = require(\"ms\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtc1wiPzVmNGQiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibXNcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJtc1wiXG4vLyBtb2R1bGUgaWQgPSAxNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///14\n");

/***/ }),
/* 15 */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzXCI/ZDJkMiJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiZXhwcmVzc1wiXG4vLyBtb2R1bGUgaWQgPSAxNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///15\n");

/***/ }),
/* 16 */
/***/ (function(module, exports) {

eval("module.exports = require(\"prompt\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJwcm9tcHRcIj81YWZkIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInByb21wdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInByb21wdFwiXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///16\n");

/***/ }),
/* 17 */
/***/ (function(module, exports) {

eval("module.exports = require(\"os\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJvc1wiPzQ5YmMiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwib3NcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJvc1wiXG4vLyBtb2R1bGUgaWQgPSAxN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///17\n");

/***/ }),
/* 18 */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjcnlwdG9cIj9lZjQ5Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNyeXB0b1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImNyeXB0b1wiXG4vLyBtb2R1bGUgaWQgPSAxOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///18\n");

/***/ }),
/* 19 */
/***/ (function(module, exports) {

eval("module.exports = require(\"js-yaml\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqcy15YW1sXCI/MTllYyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJqcy15YW1sXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwianMteWFtbFwiXG4vLyBtb2R1bGUgaWQgPSAxOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///19\n");

/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

eval("var map = {\n\t\"./0.1\": 21,\n\t\"./0.1.js\": 21\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 20;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY2xpL21pZ3JhdGlvbnMgXlxcLlxcLy4qJD8xMzcxIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBtYXAgPSB7XG5cdFwiLi8wLjFcIjogMjEsXG5cdFwiLi8wLjEuanNcIjogMjFcbn07XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dChyZXEpIHtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18od2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkpO1xufTtcbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpIHtcblx0dmFyIGlkID0gbWFwW3JlcV07XG5cdGlmKCEoaWQgKyAxKSkgLy8gY2hlY2sgZm9yIG51bWJlciBvciBzdHJpbmdcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInLlwiKTtcblx0cmV0dXJuIGlkO1xufTtcbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSAyMDtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jbGkvbWlncmF0aW9ucyBeXFwuXFwvLiokXG4vLyBtb2R1bGUgaWQgPSAyMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///20\n");

/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _knex = __webpack_require__(11);\n\nvar _knex2 = _interopRequireDefault(_knex);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _kvs = __webpack_require__(22);\n\nvar _kvs2 = _interopRequireDefault(_kvs);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (bot_path) {\n  var botfilePath = _path2.default.join(bot_path, 'botfile.js');\n  // eslint-disable-next-line no-eval\n  var botfile = eval('require')(botfilePath);\n  var dbLocation = _path2.default.resolve(_path2.default.join(bot_path, botfile.dataDir, 'db.sqlite'));\n\n  return migrate_database_schema(dbLocation).then(function () {\n    return migrate_botfile(botfilePath);\n  });\n};\n\nfunction migrate_database_schema(dbLocation) {\n\n  var updateUsers = 'strftime(\\'%Y-%m-%dT%H:%M:%fZ\\', created_on/1000, \\'unixepoch\\')';\n\n  var knex = (0, _knex2.default)({\n    client: 'sqlite3',\n    connection: { filename: dbLocation },\n    useNullAsDefault: true\n  });\n\n  return knex.schema.table('users', function (table) {\n    table.string('picture_url');\n    table.string('first_name');\n    table.string('last_name');\n  }).then(function () {\n    return knex('users').update({ created_on: knex.raw(updateUsers) });\n  }).then(function (rows) {\n    _util2.default.print('info', 'Updated ' + rows + ' users');\n    _util2.default.print('warn', 'Users table was migrated to new schema but existing ' + 'users will miss the following fields: `picture_url`, `first_name`, ' + '`last_name`. They have been left to `null`.');\n  }).catch(function () {\n    _util2.default.print('warn', 'Did not migrate table `users` as schema was already up to date');\n  }).then(function () {\n    return (0, _kvs2.default)(knex).bootstrap();\n  }).catch(function () {\n    _util2.default.print('warn', 'Did not create table `kvs` as schema was already up to date');\n  }).then(function () {\n\n    if (!process.env.DELETE_TABLES) {\n      _util2.default.print('warn', \"This migration must delete the tables of \" + \"the following modules: `botpress-scheduler`, `botpress-analytics`, \" + \"`botpress-hitl` and `botpress-subscription`.\");\n\n      _util2.default.print('warn', \"This step has been skipped because you didn't provide \" + \"the DELETE_TABLES=true environement variable.\");\n\n      _util2.default.print('warn', \"Please backup your data if necessary then re-run with DELETE_TABLES=true\");\n      return false;\n    }\n\n    return dropTableIfExists(knex, 'analytics_interactions').then(function () {\n      return dropTableIfExists(knex, 'analytics_runs');\n    }).then(function () {\n      return dropTableIfExists(knex, 'broadcast_outbox');\n    }).then(function () {\n      return dropTableIfExists(knex, 'broadcast_schedules');\n    }).then(function () {\n      return dropTableIfExists(knex, 'hitl_messages');\n    }).then(function () {\n      return dropTableIfExists(knex, 'hitl_sessions');\n    }).then(function () {\n      return dropTableIfExists(knex, 'subscription_users');\n    }).then(function () {\n      return dropTableIfExists(knex, 'subscriptions');\n    }).then(function () {\n      return dropTableIfExists(knex, 'scheduler_schedules');\n    }).then(function () {\n      return dropTableIfExists(knex, 'scheduler_tasks');\n    }).then(function () {\n      return _util2.default.print('info', 'Dropped module tables');\n    });\n  });\n}\n\nfunction dropTableIfExists(knex, tableName) {\n  return knex.schema.hasTable(tableName).then(function (has) {\n    if (has) {\n      return knex.schema.dropTable(tableName);\n    }\n  });\n}\n\nfunction migrate_botfile(botfilePath) {\n  var before = _fs2.default.readFileSync(botfilePath).toString();\n\n  if (before.indexOf('postgres:') >= 0) {\n    _util2.default.print('warn', 'Did not migrate botfile as it seemed like `postgres`' + ' was already present. Please migrate manually if this is a mistake.');\n    return false;\n  }\n\n  var after = before.replace(/module\\.exports.*?=.*?{/i, 'module.exports = {\\n\\n  /**\\n  * Postgres configuration\\n  */\\n  postgres: {\\n    enabled: process.env.DATABASE === \\'postgres\\',\\n    host: process.env.PG_HOST || \\'127.0.0.1\\',\\n    port: process.env.PG_PORT || 5432,\\n    user: process.env.PG_USER || \\'\\',\\n    password: process.env.PG_PASSWORD || \\'\\',\\n    database: process.env.PG_DB || \\'\\'\\n  },');\n\n  _fs2.default.writeFileSync(botfilePath, after);\n\n  _util2.default.print('info', 'Updated botfile');\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9taWdyYXRpb25zLzAuMS5qcz8wOTgzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBLbmV4IGZyb20gJ2tuZXgnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuXG5pbXBvcnQga3ZzIGZyb20gJy4uLy4uL2RhdGFiYXNlL2t2cydcbmltcG9ydCB1dGlsIGZyb20gJy4uLy4uL3V0aWwnXG5cbm1vZHVsZS5leHBvcnRzID0gYm90X3BhdGggPT4ge1xuICBjb25zdCBib3RmaWxlUGF0aCA9IHBhdGguam9pbihib3RfcGF0aCwgJ2JvdGZpbGUuanMnKVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbFxuICBjb25zdCBib3RmaWxlID0gZXZhbCgncmVxdWlyZScpKGJvdGZpbGVQYXRoKVxuICBjb25zdCBkYkxvY2F0aW9uID0gcGF0aC5yZXNvbHZlKHBhdGguam9pbihib3RfcGF0aCwgYm90ZmlsZS5kYXRhRGlyLCAnZGIuc3FsaXRlJykpXG5cbiAgcmV0dXJuIG1pZ3JhdGVfZGF0YWJhc2Vfc2NoZW1hKGRiTG9jYXRpb24pXG4gICAgLnRoZW4oKCkgPT4gbWlncmF0ZV9ib3RmaWxlKGJvdGZpbGVQYXRoKSlcbn1cblxuXG5mdW5jdGlvbiBtaWdyYXRlX2RhdGFiYXNlX3NjaGVtYShkYkxvY2F0aW9uKSB7XG5cbiAgY29uc3QgdXBkYXRlVXNlcnMgPSBgc3RyZnRpbWUoJyVZLSVtLSVkVCVIOiVNOiVmWicsIGNyZWF0ZWRfb24vMTAwMCwgJ3VuaXhlcG9jaCcpYFxuXG4gIGNvbnN0IGtuZXggPSBLbmV4KHtcbiAgICBjbGllbnQ6ICdzcWxpdGUzJyxcbiAgICBjb25uZWN0aW9uOiB7IGZpbGVuYW1lOiBkYkxvY2F0aW9uIH0sXG4gICAgdXNlTnVsbEFzRGVmYXVsdDogdHJ1ZVxuICB9KVxuXG4gIHJldHVybiBrbmV4LnNjaGVtYS50YWJsZSgndXNlcnMnLCBmdW5jdGlvbiAodGFibGUpIHtcbiAgICB0YWJsZS5zdHJpbmcoJ3BpY3R1cmVfdXJsJylcbiAgICB0YWJsZS5zdHJpbmcoJ2ZpcnN0X25hbWUnKVxuICAgIHRhYmxlLnN0cmluZygnbGFzdF9uYW1lJylcbiAgfSlcbiAgICAudGhlbigoKSA9PiBrbmV4KCd1c2VycycpLnVwZGF0ZSh7IGNyZWF0ZWRfb246IGtuZXgucmF3KHVwZGF0ZVVzZXJzKSB9KSlcbiAgICAudGhlbihyb3dzID0+IHtcbiAgICAgIHV0aWwucHJpbnQoJ2luZm8nLCAnVXBkYXRlZCAnICsgcm93cyArICcgdXNlcnMnKVxuICAgICAgdXRpbC5wcmludCgnd2FybicsICdVc2VycyB0YWJsZSB3YXMgbWlncmF0ZWQgdG8gbmV3IHNjaGVtYSBidXQgZXhpc3RpbmcgJ1xuICAgICAgKyAndXNlcnMgd2lsbCBtaXNzIHRoZSBmb2xsb3dpbmcgZmllbGRzOiBgcGljdHVyZV91cmxgLCBgZmlyc3RfbmFtZWAsICdcbiAgICAgICsgJ2BsYXN0X25hbWVgLiBUaGV5IGhhdmUgYmVlbiBsZWZ0IHRvIGBudWxsYC4nKVxuICAgIH0pXG4gICAgLmNhdGNoKCgpID0+IHtcbiAgICAgIHV0aWwucHJpbnQoJ3dhcm4nLCAnRGlkIG5vdCBtaWdyYXRlIHRhYmxlIGB1c2Vyc2AgYXMgc2NoZW1hIHdhcyBhbHJlYWR5IHVwIHRvIGRhdGUnKVxuICAgIH0pXG4gICAgLnRoZW4oKCkgPT4ga3ZzKGtuZXgpLmJvb3RzdHJhcCgpKVxuICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICB1dGlsLnByaW50KCd3YXJuJywgJ0RpZCBub3QgY3JlYXRlIHRhYmxlIGBrdnNgIGFzIHNjaGVtYSB3YXMgYWxyZWFkeSB1cCB0byBkYXRlJylcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcblxuICAgICAgaWYgKCFwcm9jZXNzLmVudi5ERUxFVEVfVEFCTEVTKSB7XG4gICAgICAgIHV0aWwucHJpbnQoJ3dhcm4nLCBcIlRoaXMgbWlncmF0aW9uIG11c3QgZGVsZXRlIHRoZSB0YWJsZXMgb2YgXCJcbiAgICAgICAgKyBcInRoZSBmb2xsb3dpbmcgbW9kdWxlczogYGJvdHByZXNzLXNjaGVkdWxlcmAsIGBib3RwcmVzcy1hbmFseXRpY3NgLCBcIlxuICAgICAgICArIFwiYGJvdHByZXNzLWhpdGxgIGFuZCBgYm90cHJlc3Mtc3Vic2NyaXB0aW9uYC5cIilcblxuICAgICAgICB1dGlsLnByaW50KCd3YXJuJywgXCJUaGlzIHN0ZXAgaGFzIGJlZW4gc2tpcHBlZCBiZWNhdXNlIHlvdSBkaWRuJ3QgcHJvdmlkZSBcIlxuICAgICAgICArIFwidGhlIERFTEVURV9UQUJMRVM9dHJ1ZSBlbnZpcm9uZW1lbnQgdmFyaWFibGUuXCIpXG5cbiAgICAgICAgdXRpbC5wcmludCgnd2FybicsIFwiUGxlYXNlIGJhY2t1cCB5b3VyIGRhdGEgaWYgbmVjZXNzYXJ5IHRoZW4gcmUtcnVuIHdpdGggREVMRVRFX1RBQkxFUz10cnVlXCIpXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ2FuYWx5dGljc19pbnRlcmFjdGlvbnMnKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnYW5hbHl0aWNzX3J1bnMnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ2Jyb2FkY2FzdF9vdXRib3gnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ2Jyb2FkY2FzdF9zY2hlZHVsZXMnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ2hpdGxfbWVzc2FnZXMnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ2hpdGxfc2Vzc2lvbnMnKSlcbiAgICAgICAgLnRoZW4oKCkgPT4gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgJ3N1YnNjcmlwdGlvbl91c2VycycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnc3Vic2NyaXB0aW9ucycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnc2NoZWR1bGVyX3NjaGVkdWxlcycpKVxuICAgICAgICAudGhlbigoKSA9PiBkcm9wVGFibGVJZkV4aXN0cyhrbmV4LCAnc2NoZWR1bGVyX3Rhc2tzJykpXG4gICAgICAgIC50aGVuKCgpID0+IHV0aWwucHJpbnQoJ2luZm8nLCAnRHJvcHBlZCBtb2R1bGUgdGFibGVzJykpXG4gICAgfSlcbn1cblxuZnVuY3Rpb24gZHJvcFRhYmxlSWZFeGlzdHMoa25leCwgdGFibGVOYW1lKSB7XG4gIHJldHVybiBrbmV4LnNjaGVtYS5oYXNUYWJsZSh0YWJsZU5hbWUpXG4gICAgLnRoZW4oaGFzID0+IHtcbiAgICAgIGlmIChoYXMpIHtcbiAgICAgICAgcmV0dXJuIGtuZXguc2NoZW1hLmRyb3BUYWJsZSh0YWJsZU5hbWUpXG4gICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gbWlncmF0ZV9ib3RmaWxlKGJvdGZpbGVQYXRoKSB7XG4gIGNvbnN0IGJlZm9yZSA9IGZzLnJlYWRGaWxlU3luYyhib3RmaWxlUGF0aCkudG9TdHJpbmcoKVxuXG4gIGlmIChiZWZvcmUuaW5kZXhPZigncG9zdGdyZXM6JykgPj0gMCkge1xuICAgIHV0aWwucHJpbnQoJ3dhcm4nLCAnRGlkIG5vdCBtaWdyYXRlIGJvdGZpbGUgYXMgaXQgc2VlbWVkIGxpa2UgYHBvc3RncmVzYCdcbiAgICAgICsgJyB3YXMgYWxyZWFkeSBwcmVzZW50LiBQbGVhc2UgbWlncmF0ZSBtYW51YWxseSBpZiB0aGlzIGlzIGEgbWlzdGFrZS4nKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgY29uc3QgYWZ0ZXIgPSBiZWZvcmUucmVwbGFjZSgvbW9kdWxlXFwuZXhwb3J0cy4qPz0uKj97L2ksIGBtb2R1bGUuZXhwb3J0cyA9IHtcblxuICAvKipcbiAgKiBQb3N0Z3JlcyBjb25maWd1cmF0aW9uXG4gICovXG4gIHBvc3RncmVzOiB7XG4gICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuREFUQUJBU0UgPT09ICdwb3N0Z3JlcycsXG4gICAgaG9zdDogcHJvY2Vzcy5lbnYuUEdfSE9TVCB8fCAnMTI3LjAuMC4xJyxcbiAgICBwb3J0OiBwcm9jZXNzLmVudi5QR19QT1JUIHx8IDU0MzIsXG4gICAgdXNlcjogcHJvY2Vzcy5lbnYuUEdfVVNFUiB8fCAnJyxcbiAgICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuUEdfUEFTU1dPUkQgfHwgJycsXG4gICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LlBHX0RCIHx8ICcnXG4gIH0sYClcblxuICBmcy53cml0ZUZpbGVTeW5jKGJvdGZpbGVQYXRoLCBhZnRlcilcblxuICB1dGlsLnByaW50KCdpbmZvJywgJ1VwZGF0ZWQgYm90ZmlsZScpXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9taWdyYXRpb25zLzAuMS5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///21\n");

/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n  Possible options:\n    - betweenGetAndSetCallback: will be called between the get and the set\n    and wait for promise to resolve\n    - tableName: overrides the KVS table's name\n*/\nmodule.exports = function (knex) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var getSetCallback = options.betweenGetAndSetCallback || function () {\n    return _bluebird2.default.resolve();\n  };\n  var tableName = options.tableName || 'kvs';\n\n  var upsert = function upsert(key, value) {\n    var sql = void 0;\n\n    var params = {\n      tableName: tableName,\n      keyCol: 'key',\n      valueCol: 'value',\n      modifiedOnCol: 'modified_on',\n      key: key,\n      value: JSON.stringify(value),\n      now: (0, _helpers2.default)(knex).date.now()\n    };\n\n    if ((0, _helpers2.default)(knex).isLite()) {\n      sql = '\\n        INSERT OR REPLACE INTO :tableName: (:keyCol:, :valueCol:, :modifiedOnCol:)\\n        VALUES (:key, :value, :now)\\n      ';\n    } else {\n      sql = '\\n        INSERT INTO :tableName: (:keyCol:, :valueCol:, :modifiedOnCol:)\\n        VALUES (:key, :value, :now)\\n        ON CONFLICT (:keyCol:) DO UPDATE\\n          SET :valueCol: = :value, :modifiedOnCol: = :now\\n      ';\n    }\n\n    return knex.raw(sql, params);\n  };\n\n  var get = function get(key, path) {\n    return knex(tableName).where({ key: key }).limit(1).then().get(0).then(function (row) {\n      if (!row) {\n        return null;\n      }\n\n      var obj = JSON.parse(row.value);\n      if (!path) {\n        return obj;\n      }\n\n      return _lodash2.default.at(obj, [path])[0];\n    });\n  };\n\n  var set = function set(key, value, path) {\n    if (!path) {\n      return upsert(key, value);\n    }\n\n    var setValue = function setValue(obj) {\n      if (path) {\n        _lodash2.default.set(obj, path, value);\n        return obj;\n      } else {\n        return value;\n      }\n    };\n\n    return get(key).then(function (original) {\n      return getSetCallback().then(function () {\n        if (!_lodash2.default.isNil(original)) {\n          return upsert(key, setValue(Object.assign({}, original)));\n        } else {\n          return upsert(key, setValue({}));\n        }\n      });\n    });\n  };\n\n  var bootstrap = function bootstrap() {\n    return (0, _helpers2.default)(knex).createTableIfNotExists(tableName, function (table) {\n      table.string('key').primary();\n      table.text('value');\n      table.timestamp('modified_on');\n    });\n  };\n\n  return { get: get, set: set, bootstrap: bootstrap };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL2t2cy5qcz83MTM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnXG5cbi8qXG4gIFBvc3NpYmxlIG9wdGlvbnM6XG4gICAgLSBiZXR3ZWVuR2V0QW5kU2V0Q2FsbGJhY2s6IHdpbGwgYmUgY2FsbGVkIGJldHdlZW4gdGhlIGdldCBhbmQgdGhlIHNldFxuICAgIGFuZCB3YWl0IGZvciBwcm9taXNlIHRvIHJlc29sdmVcbiAgICAtIHRhYmxlTmFtZTogb3ZlcnJpZGVzIHRoZSBLVlMgdGFibGUncyBuYW1lXG4qL1xubW9kdWxlLmV4cG9ydHMgPSAoa25leCwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gIGNvbnN0IGdldFNldENhbGxiYWNrID0gb3B0aW9ucy5iZXR3ZWVuR2V0QW5kU2V0Q2FsbGJhY2sgfHwgKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKVxuICBjb25zdCB0YWJsZU5hbWUgPSBvcHRpb25zLnRhYmxlTmFtZSB8fCAna3ZzJ1xuXG4gIGNvbnN0IHVwc2VydCA9IChrZXksIHZhbHVlKSA9PiB7XG4gICAgbGV0IHNxbFxuXG4gICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgdGFibGVOYW1lLFxuICAgICAga2V5Q29sOiAna2V5JyxcbiAgICAgIHZhbHVlQ29sOiAndmFsdWUnLFxuICAgICAgbW9kaWZpZWRPbkNvbDogJ21vZGlmaWVkX29uJyxcbiAgICAgIGtleSxcbiAgICAgIHZhbHVlOiBKU09OLnN0cmluZ2lmeSh2YWx1ZSksXG4gICAgICBub3c6IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuICAgIH1cblxuICAgIGlmIChoZWxwZXJzKGtuZXgpLmlzTGl0ZSgpKSB7XG4gICAgICBzcWwgPSBgXG4gICAgICAgIElOU0VSVCBPUiBSRVBMQUNFIElOVE8gOnRhYmxlTmFtZTogKDprZXlDb2w6LCA6dmFsdWVDb2w6LCA6bW9kaWZpZWRPbkNvbDopXG4gICAgICAgIFZBTFVFUyAoOmtleSwgOnZhbHVlLCA6bm93KVxuICAgICAgYFxuICAgIH0gZWxzZSB7XG4gICAgICBzcWwgPSBgXG4gICAgICAgIElOU0VSVCBJTlRPIDp0YWJsZU5hbWU6ICg6a2V5Q29sOiwgOnZhbHVlQ29sOiwgOm1vZGlmaWVkT25Db2w6KVxuICAgICAgICBWQUxVRVMgKDprZXksIDp2YWx1ZSwgOm5vdylcbiAgICAgICAgT04gQ09ORkxJQ1QgKDprZXlDb2w6KSBETyBVUERBVEVcbiAgICAgICAgICBTRVQgOnZhbHVlQ29sOiA9IDp2YWx1ZSwgOm1vZGlmaWVkT25Db2w6ID0gOm5vd1xuICAgICAgYFxuICAgIH1cblxuICAgIHJldHVybiBrbmV4LnJhdyhzcWwsIHBhcmFtcylcbiAgfVxuXG4gIGNvbnN0IGdldCA9IChrZXksIHBhdGgpID0+IHtcbiAgICByZXR1cm4ga25leCh0YWJsZU5hbWUpLndoZXJlKHsga2V5IH0pLmxpbWl0KDEpLnRoZW4oKS5nZXQoMCkudGhlbihyb3cgPT4ge1xuICAgICAgaWYgKCFyb3cpIHtcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb2JqID0gSlNPTi5wYXJzZShyb3cudmFsdWUpXG4gICAgICBpZiAoIXBhdGgpIHtcbiAgICAgICAgcmV0dXJuIG9ialxuICAgICAgfVxuXG4gICAgICByZXR1cm4gXy5hdChvYmosIFtwYXRoXSlbMF1cbiAgICB9KVxuICB9XG5cbiAgY29uc3Qgc2V0ID0gKGtleSwgdmFsdWUsIHBhdGgpID0+IHtcbiAgICBpZiAoIXBhdGgpIHtcbiAgICAgIHJldHVybiB1cHNlcnQoa2V5LCB2YWx1ZSlcbiAgICB9XG5cbiAgICBjb25zdCBzZXRWYWx1ZSA9IG9iaiA9PiB7XG4gICAgICBpZiAocGF0aCkge1xuICAgICAgICBfLnNldChvYmosIHBhdGgsIHZhbHVlKVxuICAgICAgICByZXR1cm4gb2JqXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWVcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0KGtleSlcbiAgICAgIC50aGVuKG9yaWdpbmFsID0+IHtcbiAgICAgICAgcmV0dXJuIGdldFNldENhbGxiYWNrKClcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIV8uaXNOaWwob3JpZ2luYWwpKSB7XG4gICAgICAgICAgICAgIHJldHVybiB1cHNlcnQoa2V5LCBzZXRWYWx1ZShPYmplY3QuYXNzaWduKHt9LCBvcmlnaW5hbCkpKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHVwc2VydChrZXksIHNldFZhbHVlKHt9KSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgfSlcbiAgfVxuXG4gIGNvbnN0IGJvb3RzdHJhcCA9ICgpID0+IHtcbiAgICByZXR1cm4gaGVscGVycyhrbmV4KS5jcmVhdGVUYWJsZUlmTm90RXhpc3RzKHRhYmxlTmFtZSwgZnVuY3Rpb24odGFibGUpIHtcbiAgICAgIHRhYmxlLnN0cmluZygna2V5JykucHJpbWFyeSgpXG4gICAgICB0YWJsZS50ZXh0KCd2YWx1ZScpXG4gICAgICB0YWJsZS50aW1lc3RhbXAoJ21vZGlmaWVkX29uJylcbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIHsgZ2V0LCBzZXQsIGJvb3RzdHJhcCB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2RhdGFiYXNlL2t2cy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7OztBQUNBOzs7Ozs7QUFNQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBBO0FBQ0E7QUFTQTtBQUNBO0FBSUE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///22\n");

/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar init = function () {\n  var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(obj) {\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (initPromise.isFulfilled()) {\n              _context.next = 8;\n              break;\n            }\n\n            resolveInit();\n            _context.t0 = Object;\n            _context.t1 = _services;\n            _context.next = 6;\n            return (0, _services3.default)(obj);\n\n          case 6:\n            _context.t2 = _context.sent;\n\n            _context.t0.assign.call(_context.t0, _context.t1, _context.t2);\n\n          case 8:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function init(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar getService = function () {\n  var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(name) {\n    var throwIfNotFound = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return initPromise.timeout(5000).catch(function (err) {\n              throw new Error('ServiceLocator was not initialized');\n            });\n\n          case 2:\n            if (!(throwIfNotFound && !_services[name])) {\n              _context2.next = 4;\n              break;\n            }\n\n            throw new Error('Service \\'' + name + '\\' not registered');\n\n          case 4:\n            return _context2.abrupt('return', _services[name]);\n\n          case 5:\n          case 'end':\n            return _context2.stop();\n        }\n      }\n    }, _callee2, this);\n  }));\n\n  return function getService(_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _services2 = __webpack_require__(52);\n\nvar _services3 = _interopRequireDefault(_services2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar _services = {};\nvar resolveInit = false;\n\nvar initPromise = new _bluebird2.default(function (resolve) {\n  resolveInit = resolve;\n});\n\nfunction registerService(name, fn) {\n  if (!!_services[name]) {\n    throw new Error('Service \\'' + name + '\\' has already been set');\n  }\n\n  _services[name] = fn;\n}\n\nmodule.exports = { init: init, registerService: registerService, getService: getService };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL1NlcnZpY2VMb2NhdG9yLmpzPzkzYjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgc2VydmljZXMgZnJvbSAnKy9zZXJ2aWNlcydcblxuY29uc3QgX3NlcnZpY2VzID0ge31cbmxldCByZXNvbHZlSW5pdCA9IGZhbHNlXG5cbmxldCBpbml0UHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICByZXNvbHZlSW5pdCA9IHJlc29sdmVcbn0pXG5cbmFzeW5jIGZ1bmN0aW9uIGluaXQob2JqKSB7XG4gIGlmICghaW5pdFByb21pc2UuaXNGdWxmaWxsZWQoKSkge1xuICAgIHJlc29sdmVJbml0KClcbiAgICBPYmplY3QuYXNzaWduKF9zZXJ2aWNlcywgYXdhaXQgc2VydmljZXMob2JqKSlcbiAgfVxufVxuXG5mdW5jdGlvbiByZWdpc3RlclNlcnZpY2UobmFtZSwgZm4pIHtcbiAgaWYgKCEhX3NlcnZpY2VzW25hbWVdKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTZXJ2aWNlICcke25hbWV9JyBoYXMgYWxyZWFkeSBiZWVuIHNldGApXG4gIH1cblxuICBfc2VydmljZXNbbmFtZV0gPSBmblxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRTZXJ2aWNlKG5hbWUsIHRocm93SWZOb3RGb3VuZCA9IHRydWUpIHtcbiAgYXdhaXQgaW5pdFByb21pc2VcbiAgICAudGltZW91dCg1MDAwKVxuICAgIC5jYXRjaChlcnIgPT4ge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZXJ2aWNlTG9jYXRvciB3YXMgbm90IGluaXRpYWxpemVkJylcbiAgICB9KVxuICBcbiAgaWYgKHRocm93SWZOb3RGb3VuZCAmJiAhX3NlcnZpY2VzW25hbWVdKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBTZXJ2aWNlICcke25hbWV9JyBub3QgcmVnaXN0ZXJlZGApXG4gIH1cblxuICByZXR1cm4gX3NlcnZpY2VzW25hbWVdXG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBpbml0LCByZWdpc3RlclNlcnZpY2UsIGdldFNlcnZpY2UgfVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGV4dGVuc2lvbnMvbGl0ZS9TZXJ2aWNlTG9jYXRvci5qcyJdLCJtYXBwaW5ncyI6Ijs7O0FBVUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBOzs7Ozs7QUFlQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBTkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTs7Ozs7QUF6QkE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWVBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///23\n");

/***/ }),
/* 24 */
/***/ (function(module, exports) {

eval("module.exports = require(\"eventemitter2\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJldmVudGVtaXR0ZXIyXCI/MDllOSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJldmVudGVtaXR0ZXIyXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiZXZlbnRlbWl0dGVyMlwiXG4vLyBtb2R1bGUgaWQgPSAyNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///24\n");

/***/ }),
/* 25 */
/***/ (function(module, exports) {

eval("module.exports = require(\"mware\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtd2FyZVwiP2M2NzUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibXdhcmVcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJtd2FyZVwiXG4vLyBtb2R1bGUgaWQgPSAyNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///25\n");

/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _listeners = __webpack_require__(12);\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nvar _util = __webpack_require__(3);\n\nvar _license = __webpack_require__(55);\n\nvar _license2 = _interopRequireDefault(_license);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var logger = _ref.logger,\n      version = _ref.version,\n      projectLocation = _ref.projectLocation,\n      db = _ref.db,\n      botfile = _ref.botfile;\n\n\n  var licensesPath = _path2.default.join(__dirname, '../licenses');\n\n  var getLicenses = function getLicenses() {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse = JSON.parse(_fs2.default.readFileSync(packageJsonPath)),\n        license = _JSON$parse.license;\n\n    var agplContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, 'LICENSE_AGPL3')).toString();\n    var botpressContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, 'LICENSE_BOTPRESS')).toString();\n\n    return {\n      agpl: {\n        name: 'AGPL-3.0',\n        licensedUnder: license === 'AGPL-3.0',\n        text: agplContent\n      },\n      botpress: {\n        name: 'Botpress',\n        licensedUnder: license.toLowerCase().indexOf('botpress') >= 0,\n        text: botpressContent\n      }\n    };\n  };\n\n  var changeLicense = _bluebird2.default.method(function (license) {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var licensePath = (0, _util.resolveProjectFile)('LICENSE', projectLocation, true);\n    var licenseFileName = license === 'AGPL-3.0' ? 'LICENSE_AGPL3' : 'LICENSE_BOTPRESS';\n    var licenseContent = _fs2.default.readFileSync(_path2.default.join(licensesPath, licenseFileName));\n\n    var pkg = JSON.parse(_fs2.default.readFileSync(packageJsonPath));\n    pkg.license = license;\n\n    _fs2.default.writeFileSync(licensePath, licenseContent);\n    _fs2.default.writeFileSync(packageJsonPath, JSON.stringify(pkg, null, 2));\n  });\n\n  var middleware = _listeners2.default.hear(/^BOT_LICENSE$/, function (event, next) {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n\n    var _JSON$parse2 = JSON.parse(_fs2.default.readFileSync(packageJsonPath)),\n        license = _JSON$parse2.license,\n        name = _JSON$parse2.name,\n        author = _JSON$parse2.author;\n\n    var bp = event.bp;\n\n    var response = 'Bot:  ' + name + '\\nCreated by: ' + author + '\\nLicense: ' + license + '\\nBotpress: ' + bp.version;\n\n    var userId = event.user && event.user.id;\n\n    if (bp[event.platform] && bp[event.platform].sendText) {\n      bp[event.platform].sendText(userId, response);\n    } else {\n      bp.middlewares.sendOutgoing({\n        platform: event.platform,\n        type: 'text',\n        text: response,\n        raw: {\n          to: userId,\n          message: response,\n          responseTo: event\n        }\n      });\n    }\n  });\n\n  var guard = (0, _license2.default)(logger, db, botfile);\n  guard.start();\n\n  return {\n    getLicensing: function () {\n      var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n        var licenses, currentLicense;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                licenses = getLicenses();\n                currentLicense = _lodash2.default.find(licenses, { licensedUnder: true });\n\n                currentLicense = currentLicense || licenses.botpress;\n\n                _context.t0 = Object;\n                _context.next = 6;\n                return guard.getStatus();\n\n              case 6:\n                _context.t1 = _context.sent;\n                _context.t2 = {\n                  text: currentLicense.text\n                };\n                return _context.abrupt('return', _context.t0.assign.call(_context.t0, _context.t1, _context.t2));\n\n              case 9:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function getLicensing() {\n        return _ref2.apply(this, arguments);\n      };\n    }(),\n    changeLicense: changeLicense,\n    middleware: middleware,\n    getFeatures: guard.getFeatures\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2xpY2Vuc2luZy5qcz9lYzhhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5pbXBvcnQgbGlzdGVuZXJzIGZyb20gJy4vbGlzdGVuZXJzJ1xuaW1wb3J0IHsgcmVzb2x2ZVByb2plY3RGaWxlLCBpc0RldmVsb3BpbmcgfSBmcm9tICcuL3V0aWwnXG5pbXBvcnQgTGljZW5zZUd1YXJkIGZyb20gJysvbGljZW5zZSdcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBsb2dnZXIsIHZlcnNpb24sIHByb2plY3RMb2NhdGlvbiwgZGIsIGJvdGZpbGUgfSkgPT4ge1xuXG4gIGNvbnN0IGxpY2Vuc2VzUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9saWNlbnNlcycpXG5cbiAgY29uc3QgZ2V0TGljZW5zZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgcGFja2FnZUpzb25QYXRoID0gcmVzb2x2ZVByb2plY3RGaWxlKCdwYWNrYWdlLmpzb24nLCBwcm9qZWN0TG9jYXRpb24sIHRydWUpXG4gICAgY29uc3QgeyBsaWNlbnNlIH0gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYWNrYWdlSnNvblBhdGgpKVxuXG4gICAgY29uc3QgYWdwbENvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGxpY2Vuc2VzUGF0aCwgJ0xJQ0VOU0VfQUdQTDMnKSkudG9TdHJpbmcoKVxuICAgIGNvbnN0IGJvdHByZXNzQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4obGljZW5zZXNQYXRoLCAnTElDRU5TRV9CT1RQUkVTUycpKS50b1N0cmluZygpXG5cbiAgICByZXR1cm4ge1xuICAgICAgYWdwbDoge1xuICAgICAgICBuYW1lOiAnQUdQTC0zLjAnLFxuICAgICAgICBsaWNlbnNlZFVuZGVyOiBsaWNlbnNlID09PSAnQUdQTC0zLjAnLFxuICAgICAgICB0ZXh0OiBhZ3BsQ29udGVudFxuICAgICAgfSxcbiAgICAgIGJvdHByZXNzOiB7XG4gICAgICAgIG5hbWU6ICdCb3RwcmVzcycsXG4gICAgICAgIGxpY2Vuc2VkVW5kZXI6IGxpY2Vuc2UudG9Mb3dlckNhc2UoKS5pbmRleE9mKCdib3RwcmVzcycpID49IDAsXG4gICAgICAgIHRleHQ6IGJvdHByZXNzQ29udGVudFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGNoYW5nZUxpY2Vuc2UgPSBQcm9taXNlLm1ldGhvZCgobGljZW5zZSkgPT4ge1xuICAgIGNvbnN0IHBhY2thZ2VKc29uUGF0aCA9IHJlc29sdmVQcm9qZWN0RmlsZSgncGFja2FnZS5qc29uJywgcHJvamVjdExvY2F0aW9uLCB0cnVlKVxuXG4gICAgY29uc3QgbGljZW5zZVBhdGggPSByZXNvbHZlUHJvamVjdEZpbGUoJ0xJQ0VOU0UnLCBwcm9qZWN0TG9jYXRpb24sIHRydWUpXG4gICAgY29uc3QgbGljZW5zZUZpbGVOYW1lID0gKGxpY2Vuc2UgPT09ICdBR1BMLTMuMCcpID8gJ0xJQ0VOU0VfQUdQTDMnIDogJ0xJQ0VOU0VfQk9UUFJFU1MnXG4gICAgY29uc3QgbGljZW5zZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGxpY2Vuc2VzUGF0aCwgbGljZW5zZUZpbGVOYW1lKSlcblxuICAgIGNvbnN0IHBrZyA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhY2thZ2VKc29uUGF0aCkpXG4gICAgcGtnLmxpY2Vuc2UgPSBsaWNlbnNlXG5cbiAgICBmcy53cml0ZUZpbGVTeW5jKGxpY2Vuc2VQYXRoLCBsaWNlbnNlQ29udGVudClcbiAgICBmcy53cml0ZUZpbGVTeW5jKHBhY2thZ2VKc29uUGF0aCwgSlNPTi5zdHJpbmdpZnkocGtnLCBudWxsLCAyKSlcbiAgfSlcblxuICBjb25zdCBtaWRkbGV3YXJlID0gbGlzdGVuZXJzLmhlYXIoL15CT1RfTElDRU5TRSQvLCAoZXZlbnQsIG5leHQpID0+IHtcbiAgICBjb25zdCBwYWNrYWdlSnNvblBhdGggPSByZXNvbHZlUHJvamVjdEZpbGUoJ3BhY2thZ2UuanNvbicsIHByb2plY3RMb2NhdGlvbiwgdHJ1ZSlcbiAgICBjb25zdCB7IGxpY2Vuc2UsIG5hbWUsIGF1dGhvciB9ID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGFja2FnZUpzb25QYXRoKSlcbiAgICBjb25zdCBicCA9IGV2ZW50LmJwXG5cbiAgICBjb25zdCByZXNwb25zZSA9IGBCb3Q6ICAke25hbWV9XG5DcmVhdGVkIGJ5OiAke2F1dGhvcn1cbkxpY2Vuc2U6ICR7bGljZW5zZX1cbkJvdHByZXNzOiAke2JwLnZlcnNpb259YFxuXG4gICAgY29uc3QgdXNlcklkID0gZXZlbnQudXNlciAmJiBldmVudC51c2VyLmlkXG5cbiAgICBpZiAoYnBbZXZlbnQucGxhdGZvcm1dICYmIGJwW2V2ZW50LnBsYXRmb3JtXS5zZW5kVGV4dCkge1xuICAgICAgYnBbZXZlbnQucGxhdGZvcm1dLnNlbmRUZXh0KHVzZXJJZCwgcmVzcG9uc2UpXG4gICAgfSBlbHNlIHtcbiAgICAgIGJwLm1pZGRsZXdhcmVzLnNlbmRPdXRnb2luZyh7XG4gICAgICAgIHBsYXRmb3JtOiBldmVudC5wbGF0Zm9ybSxcbiAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICB0ZXh0OiByZXNwb25zZSxcbiAgICAgICAgcmF3OiB7XG4gICAgICAgICAgdG86IHVzZXJJZCxcbiAgICAgICAgICBtZXNzYWdlOiByZXNwb25zZSxcbiAgICAgICAgICByZXNwb25zZVRvOiBldmVudFxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfSlcblxuICBjb25zdCBndWFyZCA9IExpY2Vuc2VHdWFyZChsb2dnZXIsIGRiLCBib3RmaWxlKVxuICBndWFyZC5zdGFydCgpXG5cbiAgcmV0dXJuIHtcbiAgICBnZXRMaWNlbnNpbmc6IGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxpY2Vuc2VzID0gZ2V0TGljZW5zZXMoKVxuICAgICAgbGV0IGN1cnJlbnRMaWNlbnNlID0gXy5maW5kKGxpY2Vuc2VzLCB7IGxpY2Vuc2VkVW5kZXI6IHRydWUgfSlcbiAgICAgIGN1cnJlbnRMaWNlbnNlID0gY3VycmVudExpY2Vuc2UgfHwgbGljZW5zZXMuYm90cHJlc3NcblxuICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oYXdhaXQgZ3VhcmQuZ2V0U3RhdHVzKCksIHtcbiAgICAgICAgdGV4dDogY3VycmVudExpY2Vuc2UudGV4dFxuICAgICAgfSlcbiAgICB9LFxuICAgIGNoYW5nZUxpY2Vuc2UsXG4gICAgbWlkZGxld2FyZSxcbiAgICBnZXRGZWF0dXJlczogZ3VhcmQuZ2V0RmVhdHVyZXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9saWNlbnNpbmcuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFOQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUpBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFKQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQU1BO0FBREE7QUFMQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBU0E7QUFDQTtBQUNBO0FBWkE7QUFjQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///26\n");

/***/ }),
/* 27 */
/***/ (function(module, exports) {

eval("module.exports = require(\"util\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1dGlsXCI/NzBjNSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ1dGlsXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidXRpbFwiXG4vLyBtb2R1bGUgaWQgPSAyN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///27\n");

/***/ }),
/* 28 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _accounts = __webpack_require__(92);\n\nvar _accounts2 = _interopRequireDefault(_accounts);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (bp, app) {\n  return {\n    anonymous: [(0, _accounts2.default)(bp, app).installAnonymous],\n    secured: [(0, _accounts2.default)(bp, app).installSecured]\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2FwaS9pbmRleC5qcz8yY2M3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhY2NvdW50cyBmcm9tICcrL2FwaS9hY2NvdW50cydcblxubW9kdWxlLmV4cG9ydHMgPSAoYnAsIGFwcCkgPT4gKHtcbiAgYW5vbnltb3VzOiBbYWNjb3VudHMoYnAsIGFwcCkuaW5zdGFsbEFub255bW91c10sXG4gIHNlY3VyZWQ6IFthY2NvdW50cyhicCwgYXBwKS5pbnN0YWxsU2VjdXJlZF1cbn0pXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZXh0ZW5zaW9ucy9saXRlL2FwaS9pbmRleC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///28\n");

/***/ }),
/* 29 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(30);


/***/ }),
/* 30 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nif (!global._babelPolyfill) {\n  __webpack_require__(31);\n}\n\nvar path = __webpack_require__(1);\n\nvar DatabaseHelpers = __webpack_require__(5);\n\nvar CLI = function CLI() {\n  return __webpack_require__(32);\n};\nvar Botpress = function Botpress() {\n  return __webpack_require__(48);\n};\n\nmodule.exports = { Botpress: Botpress, DatabaseHelpers: DatabaseHelpers, CLI: CLI };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5kZXguanM/MTY4NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpZiAoIWdsb2JhbC5fYmFiZWxQb2x5ZmlsbCkge1xuICByZXF1aXJlKCdiYWJlbC1wb2x5ZmlsbCcpXG59XG5cbnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5cbnZhciBEYXRhYmFzZUhlbHBlcnMgPSByZXF1aXJlKCcuL3NyYy9kYXRhYmFzZS9oZWxwZXJzLmpzJylcblxudmFyIENMSSA9ICgpID0+IHJlcXVpcmUoJy4vc3JjL2NsaScpXG52YXIgQm90cHJlc3MgPSAoKSA9PiByZXF1aXJlKCcuL3NyYy9ib3RwcmVzcy5qcycpXG5cbm1vZHVsZS5leHBvcnRzID0geyBCb3RwcmVzcywgRGF0YWJhc2VIZWxwZXJzLCBDTEkgfVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGluZGV4LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///30\n");

/***/ }),
/* 31 */
/***/ (function(module, exports) {

eval("module.exports = require(\"babel-polyfill\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJiYWJlbC1wb2x5ZmlsbFwiP2QwZDYiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYmFiZWwtcG9seWZpbGxcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJiYWJlbC1wb2x5ZmlsbFwiXG4vLyBtb2R1bGUgaWQgPSAzMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///31\n");

/***/ }),
/* 32 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _commander = __webpack_require__(33);\n\nvar _commander2 = _interopRequireDefault(_commander);\n\nvar _init = __webpack_require__(34);\n\nvar _init2 = _interopRequireDefault(_init);\n\nvar _start = __webpack_require__(38);\n\nvar _start2 = _interopRequireDefault(_start);\n\nvar _create = __webpack_require__(41);\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _install = __webpack_require__(42);\n\nvar _install2 = _interopRequireDefault(_install);\n\nvar _uninstall = __webpack_require__(45);\n\nvar _uninstall2 = _interopRequireDefault(_uninstall);\n\nvar _migrate = __webpack_require__(46);\n\nvar _migrate2 = _interopRequireDefault(_migrate);\n\nvar _list = __webpack_require__(47);\n\nvar _list2 = _interopRequireDefault(_list);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_commander2.default.command('init').description('Create a new bot in current directory').option('-y, --yes', 'Say yes to every prompt and use default values').action(_init2.default);\n\nvar defaultWatchExt = '.js,.jsx,.json,.yml';\n_commander2.default.command('start [path]').alias('s').description('Starts running a bot').option('-w, --watch', 'Watch bot for changes, and restart automatically').option('--watchExt <extensions>', 'When watching, which file extensions to watch. Default: \"' + defaultWatchExt + '\"', defaultWatchExt).option('--watchDir <dir>', 'When watching, what to watch. Can be repeated. Default: Directory of botfile.js', _util.collectArgs, []).option('--watchIgnore <file|dir>', 'When watching, what to ignore. Can be repeated. Default: dataDir, watchExt from botfile.js, and node_modules', _util.collectArgs, []).action(_start2.default);\n\n_commander2.default.command('install <module> [modules...]').alias('i').description('Add modules to the current bot').action(_install2.default);\n\n_commander2.default.command('uninstall <module> [modules...]').alias('u').description('Remove modules from the current bot').action(_uninstall2.default);\n\n_commander2.default.command('list').alias('ls').description('List installed modules').action(_list2.default);\n\n_commander2.default.command('create').alias('c').description('Create a new module for development or distribution').action(_create2.default);\n\n_commander2.default.command('migrate <fromVersion>').description('Migrates the current bot from version X').action(_migrate2.default);\n\n_commander2.default.version((0, _util.getBotpressVersion)()).description('Easily create, manage and extend chatbots.').parse(process.argv);\n\nif (!_commander2.default.args.length) {\n  _commander2.default.help();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9pbmRleC5qcz84NjdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwcm9ncmFtIGZyb20gJ2NvbW1hbmRlcidcblxuaW1wb3J0IGluaXQgZnJvbSAnLi9pbml0J1xuaW1wb3J0IHN0YXJ0IGZyb20gJy4vc3RhcnQnXG5pbXBvcnQgY3JlYXRlIGZyb20gJy4vY3JlYXRlJ1xuaW1wb3J0IGluc3RhbGwgZnJvbSAnLi9pbnN0YWxsJ1xuaW1wb3J0IHVuaW5zdGFsbCBmcm9tICcuL3VuaW5zdGFsbCdcbmltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSdcbmltcG9ydCBsaXN0IGZyb20gJy4vbGlzdCdcblxuaW1wb3J0IHsgZ2V0Qm90cHJlc3NWZXJzaW9uLCBjb2xsZWN0QXJncyB9IGZyb20gJy4uL3V0aWwnXG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoJ2luaXQnKVxuICAuZGVzY3JpcHRpb24oJ0NyZWF0ZSBhIG5ldyBib3QgaW4gY3VycmVudCBkaXJlY3RvcnknKVxuICAub3B0aW9uKCcteSwgLS15ZXMnLCAnU2F5IHllcyB0byBldmVyeSBwcm9tcHQgYW5kIHVzZSBkZWZhdWx0IHZhbHVlcycpXG4gIC5hY3Rpb24oaW5pdClcblxuY29uc3QgZGVmYXVsdFdhdGNoRXh0ID0gJy5qcywuanN4LC5qc29uLC55bWwnXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdzdGFydCBbcGF0aF0nKVxuICAuYWxpYXMoJ3MnKVxuICAuZGVzY3JpcHRpb24oJ1N0YXJ0cyBydW5uaW5nIGEgYm90JylcbiAgLm9wdGlvbignLXcsIC0td2F0Y2gnLCAnV2F0Y2ggYm90IGZvciBjaGFuZ2VzLCBhbmQgcmVzdGFydCBhdXRvbWF0aWNhbGx5JylcbiAgLm9wdGlvbihcbiAgICAnLS13YXRjaEV4dCA8ZXh0ZW5zaW9ucz4nLFxuICAgIGBXaGVuIHdhdGNoaW5nLCB3aGljaCBmaWxlIGV4dGVuc2lvbnMgdG8gd2F0Y2guIERlZmF1bHQ6IFwiJHtkZWZhdWx0V2F0Y2hFeHR9XCJgLFxuICAgIGRlZmF1bHRXYXRjaEV4dFxuICApXG4gIC5vcHRpb24oXG4gICAgJy0td2F0Y2hEaXIgPGRpcj4nLFxuICAgIGBXaGVuIHdhdGNoaW5nLCB3aGF0IHRvIHdhdGNoLiBDYW4gYmUgcmVwZWF0ZWQuIERlZmF1bHQ6IERpcmVjdG9yeSBvZiBib3RmaWxlLmpzYCxcbiAgICBjb2xsZWN0QXJncyxcbiAgICBbXVxuICApXG4gIC5vcHRpb24oXG4gICAgJy0td2F0Y2hJZ25vcmUgPGZpbGV8ZGlyPicsXG4gICAgYFdoZW4gd2F0Y2hpbmcsIHdoYXQgdG8gaWdub3JlLiBDYW4gYmUgcmVwZWF0ZWQuIERlZmF1bHQ6IGRhdGFEaXIsIHdhdGNoRXh0IGZyb20gYm90ZmlsZS5qcywgYW5kIG5vZGVfbW9kdWxlc2AsXG4gICAgY29sbGVjdEFyZ3MsXG4gICAgW11cbiAgKVxuICAuYWN0aW9uKHN0YXJ0KVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdpbnN0YWxsIDxtb2R1bGU+IFttb2R1bGVzLi4uXScpXG4gIC5hbGlhcygnaScpXG4gIC5kZXNjcmlwdGlvbignQWRkIG1vZHVsZXMgdG8gdGhlIGN1cnJlbnQgYm90JylcbiAgLmFjdGlvbihpbnN0YWxsKVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCd1bmluc3RhbGwgPG1vZHVsZT4gW21vZHVsZXMuLi5dJylcbiAgLmFsaWFzKCd1JylcbiAgLmRlc2NyaXB0aW9uKCdSZW1vdmUgbW9kdWxlcyBmcm9tIHRoZSBjdXJyZW50IGJvdCcpXG4gIC5hY3Rpb24odW5pbnN0YWxsKVxuXG5wcm9ncmFtXG4gIC5jb21tYW5kKCdsaXN0JylcbiAgLmFsaWFzKCdscycpXG4gIC5kZXNjcmlwdGlvbignTGlzdCBpbnN0YWxsZWQgbW9kdWxlcycpXG4gIC5hY3Rpb24obGlzdClcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnY3JlYXRlJylcbiAgLmFsaWFzKCdjJylcbiAgLmRlc2NyaXB0aW9uKCdDcmVhdGUgYSBuZXcgbW9kdWxlIGZvciBkZXZlbG9wbWVudCBvciBkaXN0cmlidXRpb24nKVxuICAuYWN0aW9uKGNyZWF0ZSlcblxucHJvZ3JhbVxuICAuY29tbWFuZCgnbWlncmF0ZSA8ZnJvbVZlcnNpb24+JylcbiAgLmRlc2NyaXB0aW9uKCdNaWdyYXRlcyB0aGUgY3VycmVudCBib3QgZnJvbSB2ZXJzaW9uIFgnKVxuICAuYWN0aW9uKG1pZ3JhdGUpXG5cbnByb2dyYW1cbiAgLnZlcnNpb24oZ2V0Qm90cHJlc3NWZXJzaW9uKCkpXG4gIC5kZXNjcmlwdGlvbignRWFzaWx5IGNyZWF0ZSwgbWFuYWdlIGFuZCBleHRlbmQgY2hhdGJvdHMuJylcbiAgLnBhcnNlKHByb2Nlc3MuYXJndilcblxuaWYgKCFwcm9ncmFtLmFyZ3MubGVuZ3RoKSB7XG4gIHByb2dyYW0uaGVscCgpXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9pbmRleC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBdUJBO0FBQ0E7QUFLQTtBQUNBO0FBS0E7QUFDQTtBQUtBO0FBQ0E7QUFLQTtBQUNBO0FBSUE7QUFDQTtBQUlBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///32\n");

/***/ }),
/* 33 */
/***/ (function(module, exports) {

eval("module.exports = require(\"commander\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb21tYW5kZXJcIj83NTczIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvbW1hbmRlclwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImNvbW1hbmRlclwiXG4vLyBtb2R1bGUgaWQgPSAzM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///33\n");

/***/ }),
/* 34 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _child_process = __webpack_require__(9);\n\nvar _prompt = __webpack_require__(16);\n\nvar _prompt2 = _interopRequireDefault(_prompt);\n\nvar _chalk = __webpack_require__(7);\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar introductionText = '\\nHey there, thanks for using botpress!' + \"\\nWe'll walk you through the creation of your new bot.\" + '\\nFor more information or help, please visit http://github.com/botpress/botpress' + '\\n---------------';\n\nvar waitingText = 'please wait, we are installing everything for you...';\nvar nextStepText = 'now run ' + _chalk2.default.bold('`bp start`') + ' in your terminal';\n\nvar assertDoesntExist = function assertDoesntExist(file) {\n  if (_fs2.default.existsSync(file)) {\n    _util2.default.print('error', 'package.json or botfile.js are already in repository, ' + 'remove them before running this command again.');\n    process.exit(1);\n  }\n};\n\nvar getTemplate = function getTemplate(template) {\n  var templatePath = _path2.default.join(__dirname, 'cli/templates/init', template);\n  var templateContent = _fs2.default.readFileSync(templatePath);\n  return _lodash2.default.template(templateContent);\n};\n\nvar generateTemplate = function generateTemplate(filename) {\n  var variables = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var template = getTemplate(filename);\n  var compiled = template(variables);\n  var destination = _path2.default.join(filename.replace(/_\\._/, '.'));\n  _fs2.default.writeFileSync(destination, compiled);\n};\n\nvar generate = function generate(result) {\n  generateTemplate('package.json', result);\n  generateTemplate('LICENSE');\n  generateTemplate('botfile.js');\n  generateTemplate('index.js');\n  generateTemplate('content.yml');\n  generateTemplate('_._gitignore');\n  generateTemplate('_._welcome');\n\n  _fs2.default.mkdirSync('data');\n  _fs2.default.writeFileSync('data/bot.log', '');\n  _fs2.default.writeFileSync('data/notification.json', '[]');\n\n  _fs2.default.mkdirSync('modules_config');\n\n  _util2.default.print(waitingText);\n  var install = (0, _child_process.spawn)(_util2.default.npmCmd, ['install']);\n\n  install.stdout.on('data', function (data) {\n    process.stdout.write(data.toString());\n  });\n\n  install.stderr.on('data', function (data) {\n    process.stdout.write(data.toString());\n  });\n\n  install.on('close', function (code) {\n    if (code > 0) {\n      _util2.default.print('error', 'an error occurred during installation');\n    } else {\n      _util2.default.print('success', 'installation has completed successfully');\n      _util2.default.print(nextStepText);\n    }\n  });\n};\n\nmodule.exports = function (program) {\n  var dirName = process.argv[3];\n  if (dirName != undefined) {\n    if (!_fs2.default.existsSync(dirName)) {\n      _fs2.default.mkdirSync(dirName);\n      process.chdir(dirName);\n    } else {\n      _util2.default.print('error', dirName + ' directory already exists');\n      return;\n    }\n  }\n  (0, _stats2.default)({}).track('cli', 'bot', 'init');\n\n  _util2.default.print(introductionText);\n\n  _lodash2.default.each(['package.json', 'botfile.js', 'index.js'], assertDoesntExist);\n\n  var currentDirectoryName = _path2.default.basename(_path2.default.resolve('./'));\n\n  var schema = {\n    properties: {\n      name: {\n        description: _chalk2.default.white('name:'),\n        pattern: /^[a-z0-9][a-z0-9-_\\.]+$/,\n        message: 'name must be only lowercase letters, ' + 'digits, dashes, underscores and dots.',\n        required: true,\n        default: currentDirectoryName\n      },\n      description: {\n        required: false,\n        description: _chalk2.default.white('description:')\n      },\n      author: {\n        required: false,\n        description: _chalk2.default.white('author:')\n      },\n      version: {\n        required: false,\n        description: _chalk2.default.white('version:'),\n        default: '0.0.1'\n      }\n    }\n  };\n\n  if (program.yes) {\n    generate({\n      name: currentDirectoryName,\n      description: '',\n      author: '',\n      version: '0.0.1'\n    });\n  } else {\n    _prompt2.default.message = '';\n    _prompt2.default.delimiter = '';\n    _prompt2.default.start();\n    _prompt2.default.get(schema, function (err, result) {\n      generate(result);\n    });\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9pbml0LmpzPzg4ZDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJ1xuaW1wb3J0IHByb21wdCBmcm9tICdwcm9tcHQnXG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcbmltcG9ydCBzdGF0cyBmcm9tICcuLi9zdGF0cydcblxuY29uc3QgaW50cm9kdWN0aW9uVGV4dCA9XG4gICdcXG5IZXkgdGhlcmUsIHRoYW5rcyBmb3IgdXNpbmcgYm90cHJlc3MhJyArXG4gIFwiXFxuV2UnbGwgd2FsayB5b3UgdGhyb3VnaCB0aGUgY3JlYXRpb24gb2YgeW91ciBuZXcgYm90LlwiICtcbiAgJ1xcbkZvciBtb3JlIGluZm9ybWF0aW9uIG9yIGhlbHAsIHBsZWFzZSB2aXNpdCBodHRwOi8vZ2l0aHViLmNvbS9ib3RwcmVzcy9ib3RwcmVzcycgK1xuICAnXFxuLS0tLS0tLS0tLS0tLS0tJ1xuXG5jb25zdCB3YWl0aW5nVGV4dCA9ICdwbGVhc2Ugd2FpdCwgd2UgYXJlIGluc3RhbGxpbmcgZXZlcnl0aGluZyBmb3IgeW91Li4uJ1xuY29uc3QgbmV4dFN0ZXBUZXh0ID0gJ25vdyBydW4gJyArIGNoYWxrLmJvbGQoJ2BicCBzdGFydGAnKSArICcgaW4geW91ciB0ZXJtaW5hbCdcblxuY29uc3QgYXNzZXJ0RG9lc250RXhpc3QgPSBmaWxlID0+IHtcbiAgaWYgKGZzLmV4aXN0c1N5bmMoZmlsZSkpIHtcbiAgICB1dGlsLnByaW50KFxuICAgICAgJ2Vycm9yJyxcbiAgICAgICdwYWNrYWdlLmpzb24gb3IgYm90ZmlsZS5qcyBhcmUgYWxyZWFkeSBpbiByZXBvc2l0b3J5LCAnICsgJ3JlbW92ZSB0aGVtIGJlZm9yZSBydW5uaW5nIHRoaXMgY29tbWFuZCBhZ2Fpbi4nXG4gICAgKVxuICAgIHByb2Nlc3MuZXhpdCgxKVxuICB9XG59XG5cbmNvbnN0IGdldFRlbXBsYXRlID0gdGVtcGxhdGUgPT4ge1xuICBjb25zdCB0ZW1wbGF0ZVBhdGggPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnY2xpL3RlbXBsYXRlcy9pbml0JywgdGVtcGxhdGUpXG4gIGNvbnN0IHRlbXBsYXRlQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyh0ZW1wbGF0ZVBhdGgpXG4gIHJldHVybiBfLnRlbXBsYXRlKHRlbXBsYXRlQ29udGVudClcbn1cblxuY29uc3QgZ2VuZXJhdGVUZW1wbGF0ZSA9IChmaWxlbmFtZSwgdmFyaWFibGVzID0ge30pID0+IHtcbiAgY29uc3QgdGVtcGxhdGUgPSBnZXRUZW1wbGF0ZShmaWxlbmFtZSlcbiAgY29uc3QgY29tcGlsZWQgPSB0ZW1wbGF0ZSh2YXJpYWJsZXMpXG4gIGNvbnN0IGRlc3RpbmF0aW9uID0gcGF0aC5qb2luKGZpbGVuYW1lLnJlcGxhY2UoL19cXC5fLywgJy4nKSlcbiAgZnMud3JpdGVGaWxlU3luYyhkZXN0aW5hdGlvbiwgY29tcGlsZWQpXG59XG5cbmNvbnN0IGdlbmVyYXRlID0gcmVzdWx0ID0+IHtcbiAgZ2VuZXJhdGVUZW1wbGF0ZSgncGFja2FnZS5qc29uJywgcmVzdWx0KVxuICBnZW5lcmF0ZVRlbXBsYXRlKCdMSUNFTlNFJylcbiAgZ2VuZXJhdGVUZW1wbGF0ZSgnYm90ZmlsZS5qcycpXG4gIGdlbmVyYXRlVGVtcGxhdGUoJ2luZGV4LmpzJylcbiAgZ2VuZXJhdGVUZW1wbGF0ZSgnY29udGVudC55bWwnKVxuICBnZW5lcmF0ZVRlbXBsYXRlKCdfLl9naXRpZ25vcmUnKVxuICBnZW5lcmF0ZVRlbXBsYXRlKCdfLl93ZWxjb21lJylcblxuICBmcy5ta2RpclN5bmMoJ2RhdGEnKVxuICBmcy53cml0ZUZpbGVTeW5jKCdkYXRhL2JvdC5sb2cnLCAnJylcbiAgZnMud3JpdGVGaWxlU3luYygnZGF0YS9ub3RpZmljYXRpb24uanNvbicsICdbXScpXG5cbiAgZnMubWtkaXJTeW5jKCdtb2R1bGVzX2NvbmZpZycpXG5cbiAgdXRpbC5wcmludCh3YWl0aW5nVGV4dClcbiAgY29uc3QgaW5zdGFsbCA9IHNwYXduKHV0aWwubnBtQ21kLCBbJ2luc3RhbGwnXSlcblxuICBpbnN0YWxsLnN0ZG91dC5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGRhdGEudG9TdHJpbmcoKSlcbiAgfSlcblxuICBpbnN0YWxsLnN0ZGVyci5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGRhdGEudG9TdHJpbmcoKSlcbiAgfSlcblxuICBpbnN0YWxsLm9uKCdjbG9zZScsIGNvZGUgPT4ge1xuICAgIGlmIChjb2RlID4gMCkge1xuICAgICAgdXRpbC5wcmludCgnZXJyb3InLCAnYW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGluc3RhbGxhdGlvbicpXG4gICAgfSBlbHNlIHtcbiAgICAgIHV0aWwucHJpbnQoJ3N1Y2Nlc3MnLCAnaW5zdGFsbGF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JylcbiAgICAgIHV0aWwucHJpbnQobmV4dFN0ZXBUZXh0KVxuICAgIH1cbiAgfSlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwcm9ncmFtKSB7XG4gIHZhciBkaXJOYW1lID0gcHJvY2Vzcy5hcmd2WzNdXG4gIGlmIChkaXJOYW1lICE9IHVuZGVmaW5lZCkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXJOYW1lKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRpck5hbWUpXG4gICAgICBwcm9jZXNzLmNoZGlyKGRpck5hbWUpXG4gICAgfSBlbHNlIHtcbiAgICAgIHV0aWwucHJpbnQoJ2Vycm9yJywgZGlyTmFtZSArICcgZGlyZWN0b3J5IGFscmVhZHkgZXhpc3RzJylcbiAgICAgIHJldHVyblxuICAgIH1cbiAgfVxuICBzdGF0cyh7fSkudHJhY2soJ2NsaScsICdib3QnLCAnaW5pdCcpXG5cbiAgdXRpbC5wcmludChpbnRyb2R1Y3Rpb25UZXh0KVxuXG4gIF8uZWFjaChbJ3BhY2thZ2UuanNvbicsICdib3RmaWxlLmpzJywgJ2luZGV4LmpzJ10sIGFzc2VydERvZXNudEV4aXN0KVxuXG4gIGNvbnN0IGN1cnJlbnREaXJlY3RvcnlOYW1lID0gcGF0aC5iYXNlbmFtZShwYXRoLnJlc29sdmUoJy4vJykpXG5cbiAgdmFyIHNjaGVtYSA9IHtcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBuYW1lOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnbmFtZTonKSxcbiAgICAgICAgcGF0dGVybjogL15bYS16MC05XVthLXowLTktX1xcLl0rJC8sXG4gICAgICAgIG1lc3NhZ2U6ICduYW1lIG11c3QgYmUgb25seSBsb3dlcmNhc2UgbGV0dGVycywgJyArICdkaWdpdHMsIGRhc2hlcywgdW5kZXJzY29yZXMgYW5kIGRvdHMuJyxcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIGRlZmF1bHQ6IGN1cnJlbnREaXJlY3RvcnlOYW1lXG4gICAgICB9LFxuICAgICAgZGVzY3JpcHRpb246IHtcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ2Rlc2NyaXB0aW9uOicpXG4gICAgICB9LFxuICAgICAgYXV0aG9yOiB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNoYWxrLndoaXRlKCdhdXRob3I6JylcbiAgICAgIH0sXG4gICAgICB2ZXJzaW9uOiB7XG4gICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNoYWxrLndoaXRlKCd2ZXJzaW9uOicpLFxuICAgICAgICBkZWZhdWx0OiAnMC4wLjEnXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb2dyYW0ueWVzKSB7XG4gICAgZ2VuZXJhdGUoe1xuICAgICAgbmFtZTogY3VycmVudERpcmVjdG9yeU5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogJycsXG4gICAgICBhdXRob3I6ICcnLFxuICAgICAgdmVyc2lvbjogJzAuMC4xJ1xuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgcHJvbXB0Lm1lc3NhZ2UgPSAnJ1xuICAgIHByb21wdC5kZWxpbWl0ZXIgPSAnJ1xuICAgIHByb21wdC5zdGFydCgpXG4gICAgcHJvbXB0LmdldChzY2hlbWEsIGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICBnZW5lcmF0ZShyZXN1bHQpXG4gICAgfSlcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9jbGkvaW5pdC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBaEJBO0FBREE7QUFDQTtBQXdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///34\n");

/***/ }),
/* 35 */
/***/ (function(module, exports) {

eval("module.exports = require(\"module\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb2R1bGVcIj8wYmVmIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vZHVsZVwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIm1vZHVsZVwiXG4vLyBtb2R1bGUgaWQgPSAzNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///35\n");

/***/ }),
/* 36 */
/***/ (function(module, exports) {

eval("module.exports = require(\"universal-analytics\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ1bml2ZXJzYWwtYW5hbHl0aWNzXCI/MDM5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ1bml2ZXJzYWwtYW5hbHl0aWNzXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwidW5pdmVyc2FsLWFuYWx5dGljc1wiXG4vLyBtb2R1bGUgaWQgPSAzNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///36\n");

/***/ }),
/* 37 */
/***/ (function(module, exports) {

eval("module.exports = require(\"node-machine-id\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJub2RlLW1hY2hpbmUtaWRcIj82MDM1Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm5vZGUtbWFjaGluZS1pZFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIm5vZGUtbWFjaGluZS1pZFwiXG4vLyBtb2R1bGUgaWQgPSAzN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///37\n");

/***/ }),
/* 38 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _os = __webpack_require__(17);\n\nvar _os2 = _interopRequireDefault(_os);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _chalk = __webpack_require__(7);\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _nodemon = __webpack_require__(39);\n\nvar _nodemon2 = _interopRequireDefault(_nodemon);\n\nvar _monitorctrlc = __webpack_require__(40);\n\nvar _child_process = __webpack_require__(9);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar getPath = function getPath(path) {\n  if (_os2.default.platform() === 'win32') {\n    var shortPath = (0, _child_process.execSync)('@echo off && for %I in (\"' + path + '\") do echo %~sI');\n    return shortPath.toString('utf8').replace(/(\\n|\\r)+$/, '');\n  } else {\n    return path;\n  }\n};\n\n/**\n * Entry point of botpress\n *\n * It will do the following things:\n *\n * 1. Find botpress instance creator in `node_modules` folder in current project.\n * 2. Find the `botfile.js` which will be injected into the creator to create the instance.\n * 3. Start the botpress instance.\n */\nmodule.exports = function (projectPath, options) {\n  var Botpress = null;\n\n  if (!projectPath || typeof projectPath !== 'string') {\n    projectPath = '.';\n  }\n\n  projectPath = _path2.default.resolve(projectPath);\n\n  try {\n    // eslint-disable-next-line no-eval\n    Botpress = eval('require')(_path2.default.join(projectPath, 'node_modules', 'botpress')).Botpress();\n  } catch (err) {\n    _util2.default.print('error', err.message);\n    _util2.default.print('error', err.stack);\n    _util2.default.print('error', '(fatal) Could not load the local version of botpress');\n    _util2.default.print('Hint: 1) have you used `botpress init` to create a new bot the proper way?');\n    _util2.default.print('Hint: 2) Do you have read and write permissions on the current directory?');\n    _util2.default.print('-------------');\n    _util2.default.print('If none of the above works, this might be a bug in botpress. ' + 'Please contact the Botpress Team on gitter and provide the printed error above.');\n    process.exit(1);\n  }\n\n  var botfile = _path2.default.join(projectPath, 'botfile.js');\n  if (!_fs2.default.existsSync(botfile)) {\n    _util2.default.print('error', '(fatal) No ' + _chalk2.default.bold('botfile.js') + ' file found at: ' + botfile);\n    process.exit(1);\n  }\n\n  var getDefaultWatchIgnore = function getDefaultWatchIgnore() {\n    // eslint-disable-next-line no-eval\n    var bf = eval('require')(botfile);\n    var dataDir = _util2.default.getDataLocation(bf.dataDir, projectPath);\n    var modulesConfigDir = _util2.default.getDataLocation(bf.modulesConfigDir, projectPath);\n    return [dataDir, modulesConfigDir, 'node_modules'];\n  };\n\n  var opts = options.opts();\n  if (opts.watch || opts.w) {\n    (function () {\n      _util2.default.print('info', '*** watching files for changes ***');\n\n      var argvWithoutWatch = process.argv.filter(function (arg) {\n        return !/^(--watch|-w)$/.test(arg);\n      });\n      argvWithoutWatch[0] = getPath(argvWithoutWatch[0]);\n\n      var nodemonOptions = {\n        cwd: process.cwd(),\n        exec: argvWithoutWatch.join(' '),\n        ext: opts.watchExt,\n        watch: opts.watchDir && opts.watchDir.length ? opts.watchDir : undefined,\n        ignore: opts.watchIgnore && opts.watchIgnore.length ? opts.watchIgnore : getDefaultWatchIgnore(),\n        stdin: false,\n        restartable: false\n      };\n\n      var mon = (0, _nodemon2.default)(nodemonOptions);\n      mon.on('restart', function (changedFile, two) {\n        return _util2.default.print('info', '*** restarting botpress because of file change: ', changedFile);\n      });\n\n      (0, _monitorctrlc.monitorCtrlC)(function () {\n        mon.emit('quit');\n        setTimeout(function () {\n          return process.exit();\n        }, 100);\n      });\n    })();\n  } else {\n    var bot = new Botpress({ botfile: botfile });\n    bot.start();\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9zdGFydC5qcz8zOThiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBvcyBmcm9tICdvcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IGNoYWxrIGZyb20gJ2NoYWxrJ1xuaW1wb3J0IG5vZGVtb24gZnJvbSAnbm9kZW1vbidcbmltcG9ydCB7IG1vbml0b3JDdHJsQyB9IGZyb20gJ21vbml0b3JjdHJsYydcbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSAnY2hpbGRfcHJvY2VzcydcblxuY29uc3QgZ2V0UGF0aCA9IHBhdGggPT4ge1xuICBpZiAob3MucGxhdGZvcm0oKSA9PT0gJ3dpbjMyJykge1xuICAgIHZhciBzaG9ydFBhdGggPSBleGVjU3luYyhgQGVjaG8gb2ZmICYmIGZvciAlSSBpbiAoXCIke3BhdGh9XCIpIGRvIGVjaG8gJX5zSWApXG4gICAgcmV0dXJuIHNob3J0UGF0aC50b1N0cmluZygndXRmOCcpLnJlcGxhY2UoLyhcXG58XFxyKSskLywgJycpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHBhdGhcbiAgfVxufVxuXG4vKipcbiAqIEVudHJ5IHBvaW50IG9mIGJvdHByZXNzXG4gKlxuICogSXQgd2lsbCBkbyB0aGUgZm9sbG93aW5nIHRoaW5nczpcbiAqXG4gKiAxLiBGaW5kIGJvdHByZXNzIGluc3RhbmNlIGNyZWF0b3IgaW4gYG5vZGVfbW9kdWxlc2AgZm9sZGVyIGluIGN1cnJlbnQgcHJvamVjdC5cbiAqIDIuIEZpbmQgdGhlIGBib3RmaWxlLmpzYCB3aGljaCB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGNyZWF0b3IgdG8gY3JlYXRlIHRoZSBpbnN0YW5jZS5cbiAqIDMuIFN0YXJ0IHRoZSBib3RwcmVzcyBpbnN0YW5jZS5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwcm9qZWN0UGF0aCwgb3B0aW9ucykge1xuICBsZXQgQm90cHJlc3MgPSBudWxsXG5cbiAgaWYgKCFwcm9qZWN0UGF0aCB8fCB0eXBlb2YgcHJvamVjdFBhdGggIT09ICdzdHJpbmcnKSB7XG4gICAgcHJvamVjdFBhdGggPSAnLidcbiAgfVxuXG4gIHByb2plY3RQYXRoID0gcGF0aC5yZXNvbHZlKHByb2plY3RQYXRoKVxuXG4gIHRyeSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICBCb3RwcmVzcyA9IGV2YWwoJ3JlcXVpcmUnKShwYXRoLmpvaW4ocHJvamVjdFBhdGgsICdub2RlX21vZHVsZXMnLCAnYm90cHJlc3MnKSkuQm90cHJlc3MoKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICB1dGlsLnByaW50KCdlcnJvcicsIGVyci5tZXNzYWdlKVxuICAgIHV0aWwucHJpbnQoJ2Vycm9yJywgZXJyLnN0YWNrKVxuICAgIHV0aWwucHJpbnQoJ2Vycm9yJywgJyhmYXRhbCkgQ291bGQgbm90IGxvYWQgdGhlIGxvY2FsIHZlcnNpb24gb2YgYm90cHJlc3MnKVxuICAgIHV0aWwucHJpbnQoJ0hpbnQ6IDEpIGhhdmUgeW91IHVzZWQgYGJvdHByZXNzIGluaXRgIHRvIGNyZWF0ZSBhIG5ldyBib3QgdGhlIHByb3BlciB3YXk/JylcbiAgICB1dGlsLnByaW50KCdIaW50OiAyKSBEbyB5b3UgaGF2ZSByZWFkIGFuZCB3cml0ZSBwZXJtaXNzaW9ucyBvbiB0aGUgY3VycmVudCBkaXJlY3Rvcnk/JylcbiAgICB1dGlsLnByaW50KCctLS0tLS0tLS0tLS0tJylcbiAgICB1dGlsLnByaW50KFxuICAgICAgJ0lmIG5vbmUgb2YgdGhlIGFib3ZlIHdvcmtzLCB0aGlzIG1pZ2h0IGJlIGEgYnVnIGluIGJvdHByZXNzLiAnICtcbiAgICAgICAgJ1BsZWFzZSBjb250YWN0IHRoZSBCb3RwcmVzcyBUZWFtIG9uIGdpdHRlciBhbmQgcHJvdmlkZSB0aGUgcHJpbnRlZCBlcnJvciBhYm92ZS4nXG4gICAgKVxuICAgIHByb2Nlc3MuZXhpdCgxKVxuICB9XG5cbiAgY29uc3QgYm90ZmlsZSA9IHBhdGguam9pbihwcm9qZWN0UGF0aCwgJ2JvdGZpbGUuanMnKVxuICBpZiAoIWZzLmV4aXN0c1N5bmMoYm90ZmlsZSkpIHtcbiAgICB1dGlsLnByaW50KCdlcnJvcicsIGAoZmF0YWwpIE5vICR7Y2hhbGsuYm9sZCgnYm90ZmlsZS5qcycpfSBmaWxlIGZvdW5kIGF0OiBgICsgYm90ZmlsZSlcbiAgICBwcm9jZXNzLmV4aXQoMSlcbiAgfVxuXG4gIGNvbnN0IGdldERlZmF1bHRXYXRjaElnbm9yZSA9ICgpID0+IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZXZhbFxuICAgIGNvbnN0IGJmID0gZXZhbCgncmVxdWlyZScpKGJvdGZpbGUpXG4gICAgY29uc3QgZGF0YURpciA9IHV0aWwuZ2V0RGF0YUxvY2F0aW9uKGJmLmRhdGFEaXIsIHByb2plY3RQYXRoKVxuICAgIGNvbnN0IG1vZHVsZXNDb25maWdEaXIgPSB1dGlsLmdldERhdGFMb2NhdGlvbihiZi5tb2R1bGVzQ29uZmlnRGlyLCBwcm9qZWN0UGF0aClcbiAgICByZXR1cm4gW2RhdGFEaXIsIG1vZHVsZXNDb25maWdEaXIsICdub2RlX21vZHVsZXMnXVxuICB9XG5cbiAgY29uc3Qgb3B0cyA9IG9wdGlvbnMub3B0cygpXG4gIGlmIChvcHRzLndhdGNoIHx8IG9wdHMudykge1xuICAgIHV0aWwucHJpbnQoJ2luZm8nLCAnKioqIHdhdGNoaW5nIGZpbGVzIGZvciBjaGFuZ2VzICoqKicpXG5cbiAgICBjb25zdCBhcmd2V2l0aG91dFdhdGNoID0gcHJvY2Vzcy5hcmd2LmZpbHRlcihhcmcgPT4gIS9eKC0td2F0Y2h8LXcpJC8udGVzdChhcmcpKVxuICAgIGFyZ3ZXaXRob3V0V2F0Y2hbMF0gPSBnZXRQYXRoKGFyZ3ZXaXRob3V0V2F0Y2hbMF0pXG5cbiAgICBjb25zdCBub2RlbW9uT3B0aW9ucyA9IHtcbiAgICAgIGN3ZDogcHJvY2Vzcy5jd2QoKSxcbiAgICAgIGV4ZWM6IGFyZ3ZXaXRob3V0V2F0Y2guam9pbignICcpLFxuICAgICAgZXh0OiBvcHRzLndhdGNoRXh0LFxuICAgICAgd2F0Y2g6IG9wdHMud2F0Y2hEaXIgJiYgb3B0cy53YXRjaERpci5sZW5ndGggPyBvcHRzLndhdGNoRGlyIDogdW5kZWZpbmVkLFxuICAgICAgaWdub3JlOiBvcHRzLndhdGNoSWdub3JlICYmIG9wdHMud2F0Y2hJZ25vcmUubGVuZ3RoID8gb3B0cy53YXRjaElnbm9yZSA6IGdldERlZmF1bHRXYXRjaElnbm9yZSgpLFxuICAgICAgc3RkaW46IGZhbHNlLFxuICAgICAgcmVzdGFydGFibGU6IGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3QgbW9uID0gbm9kZW1vbihub2RlbW9uT3B0aW9ucylcbiAgICBtb24ub24oJ3Jlc3RhcnQnLCAoY2hhbmdlZEZpbGUsIHR3bykgPT5cbiAgICAgIHV0aWwucHJpbnQoJ2luZm8nLCAnKioqIHJlc3RhcnRpbmcgYm90cHJlc3MgYmVjYXVzZSBvZiBmaWxlIGNoYW5nZTogJywgY2hhbmdlZEZpbGUpXG4gICAgKVxuXG4gICAgbW9uaXRvckN0cmxDKCgpID0+IHtcbiAgICAgIG1vbi5lbWl0KCdxdWl0JylcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gcHJvY2Vzcy5leGl0KCksIDEwMClcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IGJvdCA9IG5ldyBCb3RwcmVzcyh7IGJvdGZpbGUgfSlcbiAgICBib3Quc3RhcnQoKVxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9zdGFydC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBO0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUEE7QUFDQTtBQVNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUF4QkE7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///38\n");

/***/ }),
/* 39 */
/***/ (function(module, exports) {

eval("module.exports = require(\"nodemon\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJub2RlbW9uXCI/YjgxYyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJub2RlbW9uXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwibm9kZW1vblwiXG4vLyBtb2R1bGUgaWQgPSAzOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///39\n");

/***/ }),
/* 40 */
/***/ (function(module, exports) {

eval("module.exports = require(\"monitorctrlc\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb25pdG9yY3RybGNcIj8wNWQ3Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbml0b3JjdHJsY1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIm1vbml0b3JjdHJsY1wiXG4vLyBtb2R1bGUgaWQgPSA0MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///40\n");

/***/ }),
/* 41 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _child_process = __webpack_require__(9);\n\nvar _prompt = __webpack_require__(16);\n\nvar _prompt2 = _interopRequireDefault(_prompt);\n\nvar _chalk = __webpack_require__(7);\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MODULE_NAME_CONVENTION_BEGINS = 'botpress-';\nvar MODULE_NAME_REGEX = new RegExp(/^botpress-.*/g);\n\nvar introductionText = \"This program will bootstrap a new Botpress module\";\nvar doneText = \"You're all set! The module is boostrapped and ready to be developed.\";\nvar documentation = \"Tip: when coding your bot, use the command `npm run watch` to recompile\" + \" your module automatically. Also, we strongly recommend that you install your module using \" + \"`npm link ../path/to/botpress-module` so that your bot always points to the most recent version.\";\n\nvar getTemplate = function getTemplate(template) {\n  var templatePath = _path2.default.join(__dirname, 'cli/templates/create', template);\n  var templateContent = _fs2.default.readFileSync(templatePath);\n  return _lodash2.default.template(templateContent);\n};\n\nvar generateTemplate = function generateTemplate(directory, filename) {\n  var variables = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  var template = getTemplate(filename);\n  var compiled = template(variables);\n  var destination = _path2.default.join(directory, filename.replace(/_\\._/, '.'));\n  _fs2.default.writeFileSync(destination, compiled);\n};\n\nvar prefixModuleNameWithBotpress = function prefixModuleNameWithBotpress(name) {\n\n  if (!MODULE_NAME_REGEX.test(name)) {\n    _util2.default.print('warn', 'the name of your module needs to begin by \"botpress-\"');\n    _util2.default.print('warn', 'we renamed your module to ' + _chalk2.default.bold(MODULE_NAME_CONVENTION_BEGINS + name));\n    name = MODULE_NAME_CONVENTION_BEGINS + name;\n  }\n\n  return name;\n};\n\nmodule.exports = function () {\n  var moduleDirectory = _path2.default.resolve('.');\n  var dirname = _path2.default.basename(moduleDirectory);\n\n  (0, _stats2.default)({}).track('cli', 'modules', 'create');\n\n  _util2.default.print(introductionText);\n\n  var schema = {\n    properties: {\n      name: {\n        description: _chalk2.default.white('module name:'),\n        pattern: /^[a-z0-9][a-z0-9-_\\.]+$/,\n        message: 'name must be only lowercase letters, ' + 'digits, dashes, underscores and dots.',\n        required: true,\n        default: dirname\n      },\n      description: {\n        required: false,\n        description: _chalk2.default.white('description:')\n      },\n      author: {\n        required: false,\n        description: _chalk2.default.white('author:')\n      },\n      version: {\n        required: false,\n        description: _chalk2.default.white('version:'),\n        default: '1.0.0'\n      }\n    }\n  };\n\n  _prompt2.default.message = '';\n  _prompt2.default.delimiter = '';\n\n  _prompt2.default.start();\n\n  _prompt2.default.get(schema, function (err, result) {\n    result.name = prefixModuleNameWithBotpress(result.name);\n\n    if (dirname !== result.name) {\n      _util2.default.print('warn', 'We usually recommend that the name of the module directory' + (' (' + dirname + ') be the same as the module name (' + result.name + ')'));\n    }\n\n    if (_fs2.default.existsSync(_path2.default.join(moduleDirectory, 'package.json'))) {\n      _util2.default.print('error', \"Expected module directory to be empty / uninitialized\");\n      process.exit(1);\n    } else {\n      generateTemplate(moduleDirectory, 'package.json', result);\n      generateTemplate(moduleDirectory, 'LICENSE');\n      generateTemplate(moduleDirectory, 'webpack.js');\n      generateTemplate(moduleDirectory, '_._gitignore');\n      generateTemplate(moduleDirectory, '_._npmignore');\n\n      _fs2.default.mkdirSync(moduleDirectory + '/src');\n      generateTemplate(moduleDirectory, 'src/index.js');\n\n      _fs2.default.mkdirSync(moduleDirectory + '/src/views');\n      generateTemplate(moduleDirectory, 'src/views/index.jsx');\n      generateTemplate(moduleDirectory, 'src/views/style.scss');\n\n      _util2.default.print('Installing dependencies, please wait...');\n\n      var install = (0, _child_process.spawn)(_util2.default.npmCmd, ['install']);\n\n      install.stdout.on('data', function (data) {\n        process.stdout.write(data.toString());\n      });\n\n      install.stderr.on('data', function (data) {\n        process.stdout.write(data.toString());\n      });\n\n      install.on('close', function (code) {\n        if (code > 0) {\n          _util2.default.print('error', 'An error occurred during the dependencies installation of your module');\n        } else {\n          _util2.default.print('success', 'Module dependencies installed');\n          _util2.default.print(doneText);\n          _util2.default.print(documentation);\n        }\n      });\n    }\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9jcmVhdGUuanM/OTM1MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzcGF3biB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5pbXBvcnQgcHJvbXB0IGZyb20gJ3Byb21wdCdcbmltcG9ydCBjaGFsayBmcm9tICdjaGFsaydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IHN0YXRzIGZyb20gJy4uL3N0YXRzJ1xuXG5jb25zdCBNT0RVTEVfTkFNRV9DT05WRU5USU9OX0JFR0lOUyA9ICdib3RwcmVzcy0nXG5jb25zdCBNT0RVTEVfTkFNRV9SRUdFWCA9IG5ldyBSZWdFeHAoL15ib3RwcmVzcy0uKi9nKVxuXG5jb25zdCBpbnRyb2R1Y3Rpb25UZXh0ID0gXCJUaGlzIHByb2dyYW0gd2lsbCBib290c3RyYXAgYSBuZXcgQm90cHJlc3MgbW9kdWxlXCJcbmNvbnN0IGRvbmVUZXh0ID0gXCJZb3UncmUgYWxsIHNldCEgVGhlIG1vZHVsZSBpcyBib29zdHJhcHBlZCBhbmQgcmVhZHkgdG8gYmUgZGV2ZWxvcGVkLlwiXG5jb25zdCBkb2N1bWVudGF0aW9uID0gXCJUaXA6IHdoZW4gY29kaW5nIHlvdXIgYm90LCB1c2UgdGhlIGNvbW1hbmQgYG5wbSBydW4gd2F0Y2hgIHRvIHJlY29tcGlsZVwiICtcbiAgXCIgeW91ciBtb2R1bGUgYXV0b21hdGljYWxseS4gQWxzbywgd2Ugc3Ryb25nbHkgcmVjb21tZW5kIHRoYXQgeW91IGluc3RhbGwgeW91ciBtb2R1bGUgdXNpbmcgXCIgK1xuICBcImBucG0gbGluayAuLi9wYXRoL3RvL2JvdHByZXNzLW1vZHVsZWAgc28gdGhhdCB5b3VyIGJvdCBhbHdheXMgcG9pbnRzIHRvIHRoZSBtb3N0IHJlY2VudCB2ZXJzaW9uLlwiXG5cbmNvbnN0IGdldFRlbXBsYXRlID0gKHRlbXBsYXRlKSA9PiB7XG4gIGNvbnN0IHRlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICdjbGkvdGVtcGxhdGVzL2NyZWF0ZScgLCB0ZW1wbGF0ZSlcbiAgY29uc3QgdGVtcGxhdGVDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKHRlbXBsYXRlUGF0aClcbiAgcmV0dXJuIF8udGVtcGxhdGUodGVtcGxhdGVDb250ZW50KVxufVxuXG5jb25zdCBnZW5lcmF0ZVRlbXBsYXRlID0gKGRpcmVjdG9yeSwgZmlsZW5hbWUsIHZhcmlhYmxlcyA9IHt9KSA9PiB7XG4gIGNvbnN0IHRlbXBsYXRlID0gZ2V0VGVtcGxhdGUoZmlsZW5hbWUpXG4gIGNvbnN0IGNvbXBpbGVkID0gdGVtcGxhdGUodmFyaWFibGVzKVxuICBjb25zdCBkZXN0aW5hdGlvbiA9IHBhdGguam9pbihkaXJlY3RvcnksIGZpbGVuYW1lLnJlcGxhY2UoL19cXC5fLywgJy4nKSlcbiAgZnMud3JpdGVGaWxlU3luYyhkZXN0aW5hdGlvbiwgY29tcGlsZWQpXG59XG5cbmNvbnN0IHByZWZpeE1vZHVsZU5hbWVXaXRoQm90cHJlc3MgPSBuYW1lID0+IHtcblxuICBpZiAoIU1PRFVMRV9OQU1FX1JFR0VYLnRlc3QobmFtZSkpIHtcbiAgICB1dGlsLnByaW50KCd3YXJuJywndGhlIG5hbWUgb2YgeW91ciBtb2R1bGUgbmVlZHMgdG8gYmVnaW4gYnkgXCJib3RwcmVzcy1cIicpXG4gICAgdXRpbC5wcmludCgnd2FybicsJ3dlIHJlbmFtZWQgeW91ciBtb2R1bGUgdG8gJysgY2hhbGsuYm9sZChNT0RVTEVfTkFNRV9DT05WRU5USU9OX0JFR0lOUyArIG5hbWUpKVxuICAgIG5hbWUgPSBNT0RVTEVfTkFNRV9DT05WRU5USU9OX0JFR0lOUyArIG5hbWVcbiAgfVxuXG4gIHJldHVybiBuYW1lXG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgY29uc3QgbW9kdWxlRGlyZWN0b3J5ID0gcGF0aC5yZXNvbHZlKCcuJylcbiAgY29uc3QgZGlybmFtZSA9IHBhdGguYmFzZW5hbWUobW9kdWxlRGlyZWN0b3J5KVxuXG4gIHN0YXRzKHt9KS50cmFjaygnY2xpJywgJ21vZHVsZXMnLCAnY3JlYXRlJylcblxuICB1dGlsLnByaW50KGludHJvZHVjdGlvblRleHQpXG5cbiAgdmFyIHNjaGVtYSA9IHtcbiAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICBuYW1lOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnbW9kdWxlIG5hbWU6JyksXG4gICAgICAgIHBhdHRlcm46IC9eW2EtejAtOV1bYS16MC05LV9cXC5dKyQvLFxuICAgICAgICBtZXNzYWdlOiAnbmFtZSBtdXN0IGJlIG9ubHkgbG93ZXJjYXNlIGxldHRlcnMsICcgK1xuICAgICAgICAgICdkaWdpdHMsIGRhc2hlcywgdW5kZXJzY29yZXMgYW5kIGRvdHMuJyxcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIGRlZmF1bHQ6IGRpcm5hbWVcbiAgICAgIH0sXG4gICAgICBkZXNjcmlwdGlvbjoge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBjaGFsay53aGl0ZSgnZGVzY3JpcHRpb246JylcbiAgICAgIH0sXG4gICAgICBhdXRob3I6IHtcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ2F1dGhvcjonKVxuICAgICAgfSxcbiAgICAgIHZlcnNpb246IHtcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBkZXNjcmlwdGlvbjogY2hhbGsud2hpdGUoJ3ZlcnNpb246JyksXG4gICAgICAgIGRlZmF1bHQ6ICcxLjAuMCdcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcm9tcHQubWVzc2FnZSA9ICcnXG4gIHByb21wdC5kZWxpbWl0ZXIgPSAnJ1xuXG4gIHByb21wdC5zdGFydCgpXG5cbiAgcHJvbXB0LmdldChzY2hlbWEsIGZ1bmN0aW9uIChlcnIsIHJlc3VsdCkge1xuICAgIHJlc3VsdC5uYW1lID0gcHJlZml4TW9kdWxlTmFtZVdpdGhCb3RwcmVzcyhyZXN1bHQubmFtZSlcbiAgICBcbiAgICBcbiAgICBpZiAoZGlybmFtZSAhPT0gcmVzdWx0Lm5hbWUpIHtcbiAgICAgIHV0aWwucHJpbnQoJ3dhcm4nLCAnV2UgdXN1YWxseSByZWNvbW1lbmQgdGhhdCB0aGUgbmFtZSBvZiB0aGUgbW9kdWxlIGRpcmVjdG9yeSdcbiAgICAgICAgKyBgICgke2Rpcm5hbWV9KSBiZSB0aGUgc2FtZSBhcyB0aGUgbW9kdWxlIG5hbWUgKCR7cmVzdWx0Lm5hbWV9KWApXG4gICAgfVxuXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKG1vZHVsZURpcmVjdG9yeSwgJ3BhY2thZ2UuanNvbicpKSkge1xuICAgICAgdXRpbC5wcmludCgnZXJyb3InLCBcIkV4cGVjdGVkIG1vZHVsZSBkaXJlY3RvcnkgdG8gYmUgZW1wdHkgLyB1bmluaXRpYWxpemVkXCIpXG4gICAgICBwcm9jZXNzLmV4aXQoMSlcbiAgICB9IGVsc2Uge1xuICAgICAgZ2VuZXJhdGVUZW1wbGF0ZShtb2R1bGVEaXJlY3RvcnksICdwYWNrYWdlLmpzb24nLCByZXN1bHQpXG4gICAgICBnZW5lcmF0ZVRlbXBsYXRlKG1vZHVsZURpcmVjdG9yeSwgJ0xJQ0VOU0UnKVxuICAgICAgZ2VuZXJhdGVUZW1wbGF0ZShtb2R1bGVEaXJlY3RvcnksICd3ZWJwYWNrLmpzJylcbiAgICAgIGdlbmVyYXRlVGVtcGxhdGUobW9kdWxlRGlyZWN0b3J5LCAnXy5fZ2l0aWdub3JlJylcbiAgICAgIGdlbmVyYXRlVGVtcGxhdGUobW9kdWxlRGlyZWN0b3J5LCAnXy5fbnBtaWdub3JlJylcblxuICAgICAgZnMubWtkaXJTeW5jKG1vZHVsZURpcmVjdG9yeSArICcvc3JjJylcbiAgICAgIGdlbmVyYXRlVGVtcGxhdGUobW9kdWxlRGlyZWN0b3J5LCAnc3JjL2luZGV4LmpzJylcblxuICAgICAgZnMubWtkaXJTeW5jKG1vZHVsZURpcmVjdG9yeSArICcvc3JjL3ZpZXdzJylcbiAgICAgIGdlbmVyYXRlVGVtcGxhdGUobW9kdWxlRGlyZWN0b3J5LCAnc3JjL3ZpZXdzL2luZGV4LmpzeCcpXG4gICAgICBnZW5lcmF0ZVRlbXBsYXRlKG1vZHVsZURpcmVjdG9yeSwgJ3NyYy92aWV3cy9zdHlsZS5zY3NzJylcblxuICAgICAgdXRpbC5wcmludCgnSW5zdGFsbGluZyBkZXBlbmRlbmNpZXMsIHBsZWFzZSB3YWl0Li4uJylcblxuICAgICAgY29uc3QgaW5zdGFsbCA9IHNwYXduKHV0aWwubnBtQ21kLCBbJ2luc3RhbGwnXSlcblxuICAgICAgaW5zdGFsbC5zdGRvdXQub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgICBwcm9jZXNzLnN0ZG91dC53cml0ZShkYXRhLnRvU3RyaW5nKCkpXG4gICAgICB9KVxuXG4gICAgICBpbnN0YWxsLnN0ZGVyci5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgIHByb2Nlc3Muc3Rkb3V0LndyaXRlKGRhdGEudG9TdHJpbmcoKSlcbiAgICAgIH0pXG5cbiAgICAgIGluc3RhbGwub24oJ2Nsb3NlJywgKGNvZGUpID0+IHtcbiAgICAgICAgaWYgKGNvZGUgPiAwKSB7XG4gICAgICAgICAgdXRpbC5wcmludCgnZXJyb3InLCAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHRoZSBkZXBlbmRlbmNpZXMgaW5zdGFsbGF0aW9uIG9mIHlvdXIgbW9kdWxlJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1dGlsLnByaW50KCdzdWNjZXNzJywgJ01vZHVsZSBkZXBlbmRlbmNpZXMgaW5zdGFsbGVkJylcbiAgICAgICAgICB1dGlsLnByaW50KGRvbmVUZXh0KVxuICAgICAgICAgIHV0aWwucHJpbnQoZG9jdW1lbnRhdGlvbilcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH0pXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9jcmVhdGUuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBakJBO0FBREE7QUFDQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///41\n");

/***/ }),
/* 42 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _modules = __webpack_require__(10);\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar waitingText = 'please wait, we are trying to install your new modules...';\n\nmodule.exports = function (module, modules) {\n  (0, _stats2.default)({}).track('cli', 'modules', 'install');\n  _util2.default.print('info', waitingText);\n  var modulesManager = (0, _modules2.default)(null, './', null);\n  modulesManager.install.apply(modulesManager, [module].concat(_toConsumableArray(modules)));\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9pbnN0YWxsLmpzPzZmYTIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcblxuaW1wb3J0IGNyZWF0ZU1vZHVsZXMgZnJvbSAnLi4vbW9kdWxlcydcblxuaW1wb3J0IHN0YXRzIGZyb20gJy4uL3N0YXRzJ1xuXG5jb25zdCB3YWl0aW5nVGV4dCA9ICdwbGVhc2Ugd2FpdCwgd2UgYXJlIHRyeWluZyB0byBpbnN0YWxsIHlvdXIgbmV3IG1vZHVsZXMuLi4nXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlLCBtb2R1bGVzKSB7XG4gIHN0YXRzKHt9KS50cmFjaygnY2xpJywgJ21vZHVsZXMnLCAnaW5zdGFsbCcpXG4gIHV0aWwucHJpbnQoJ2luZm8nLCB3YWl0aW5nVGV4dClcbiAgbGV0IG1vZHVsZXNNYW5hZ2VyID0gY3JlYXRlTW9kdWxlcyhudWxsLCAnLi8nLCBudWxsKVxuICBtb2R1bGVzTWFuYWdlci5pbnN0YWxsKG1vZHVsZSwgLi4ubW9kdWxlcylcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvY2xpL2luc3RhbGwuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///42\n");

/***/ }),
/* 43 */
/***/ (function(module, exports) {

eval("module.exports = require(\"axios\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJheGlvc1wiPzI1MzkiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYXhpb3NcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJheGlvc1wiXG4vLyBtb2R1bGUgaWQgPSA0M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///43\n");

/***/ }),
/* 44 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _jsYaml = __webpack_require__(19);\n\nvar _jsYaml2 = _interopRequireDefault(_jsYaml);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar validations = {\n  'any': function any(value, validation) {\n    return validation(value);\n  },\n  'string': function string(value, validation) {\n    return typeof value === 'string' && validation(value);\n  },\n  'choice': function choice(value, validation) {\n    return _lodash2.default.includes(validation, value);\n  },\n  'bool': function bool(value, validation) {\n    return (value === true || value === false) && validation(value);\n  }\n};\n\nvar defaultValues = {\n  'any': null,\n  'string': '',\n  'bool': false\n};\n\nvar amendOption = function amendOption(option, name) {\n\n  var validTypes = _lodash2.default.keys(validations);\n  if (!option.type || !_lodash2.default.includes(validTypes, option.type)) {\n    throw new Error('Invalid type (' + (option.type || '') + ') for config key (' + name + ')');\n  }\n\n  var validation = option.validation || function () {\n    return true;\n  };\n\n  if (typeof option.default !== 'undefined' && !validations[option.type](option.default, validation)) {\n    throw new Error('Invalid default value (' + option.default + ') for (' + name + ')');\n  }\n\n  if (!option.default && !_lodash2.default.includes(_lodash2.default.keys(defaultValues), option.type)) {\n    throw new Error('Default value is mandatory for type ' + option.type + ' (' + name + ')');\n  }\n\n  return {\n    type: option.type,\n    required: option.required || false,\n    env: option.env || null,\n    default: option.default || defaultValues[option.type],\n    validation: validation\n  };\n};\n\nvar amendOptions = function amendOptions(options) {\n  return _lodash2.default.mapValues(options, amendOption);\n};\n\nvar validateSet = function validateSet(options, name, value) {\n\n  // if name is not in options, throw\n  if (!_lodash2.default.includes(_lodash2.default.keys(options), name)) {\n    throw new Error('Unrecognized configuration key: ' + name);\n  }\n\n  if (!validations[options[name].type](value, options[name].validation)) {\n    throw new Error('Invalid value for key: ' + name);\n  }\n};\n\nvar validateSave = function validateSave(options, object) {\n  var objKeys = _lodash2.default.keys(object);\n  var requiredKeys = _lodash2.default.filter(_lodash2.default.keys(options), function (key) {\n    return options[key].required;\n  });\n\n  _lodash2.default.each(requiredKeys, function (required) {\n    if (!_lodash2.default.includes(objKeys, required)) {\n      throw new Error('Missing required configuration: \\'' + required + '\\'');\n    }\n  });\n\n  _lodash2.default.each(objKeys, function (name) {\n    validateSet(options, name, object[name]);\n  });\n};\n\nvar validateName = function validateName(name) {\n  if (!name || !/^[A-Z0-9._-]+$/i.test(name)) {\n    throw new Error('Invalid configuration name: ' + name + '. The name must only contain letters, _ and -');\n  }\n};\n\nvar overwriteFromDefaultValues = function overwriteFromDefaultValues(options, object) {\n  _lodash2.default.each(_lodash2.default.keys(options), function (name) {\n    if (typeof object[name] === 'undefined') {\n      object[name] = options[name].default;\n    }\n  });\n\n  return object;\n};\n\nvar overwriteFromEnvValues = function overwriteFromEnvValues(options, object) {\n  return _lodash2.default.mapValues(object, function (_v, name) {\n    if (options[name] && options[name].env && process.env[options[name].env]) {\n      return process.env[options[name].env];\n    }\n\n    return _v;\n  });\n};\n\nvar overwriteFromBotfileValues = function overwriteFromBotfileValues(config_name, options, botfile, object) {\n  return _lodash2.default.mapValues(object, function (_v, name) {\n    if (botfile && botfile.config && botfile.config[config_name] && typeof botfile.config[config_name][name] !== 'undefined') {\n      return botfile.config[config_name][name];\n    }\n\n    return _v;\n  });\n};\n\nvar overwriteFromConfigFileValues = function () {\n  var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(config_name, options, projectLocation, object) {\n    var configFilePath, configFromFile;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (projectLocation) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt('return', object);\n\n          case 2:\n            configFilePath = _path2.default.resolve(projectLocation, config_name + '.config.yml');\n\n            if (_fs2.default.existsSync(configFilePath)) {\n              _context.next = 5;\n              break;\n            }\n\n            return _context.abrupt('return', object);\n\n          case 5:\n            _context.next = 7;\n            return _bluebird2.default.fromCallback(function (callback) {\n              _jsYaml2.default.safeLoadAll(_fs2.default.readFileSync(configFilePath), function (value) {\n                return callback(null, value);\n              });\n            });\n\n          case 7:\n            configFromFile = _context.sent;\n            return _context.abrupt('return', _lodash2.default.mapValues(object, function (_v, name) {\n              if (typeof configFromFile[name] !== 'undefined') {\n                return configFromFile[name];\n              }\n              return _v;\n            }));\n\n          case 9:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function overwriteFromConfigFileValues(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar removeUnusedKeys = function removeUnusedKeys(options, object) {\n  var final = {};\n\n  _lodash2.default.each(_lodash2.default.keys(options), function (name) {\n    if (typeof object[name] !== 'undefined') {\n      final[name] = object[name];\n    }\n  });\n\n  return final;\n};\n\nvar createConfig = function createConfig(_ref2) {\n  var kvs = _ref2.kvs,\n      name = _ref2.name,\n      _ref2$botfile = _ref2.botfile,\n      botfile = _ref2$botfile === undefined ? {} : _ref2$botfile,\n      _ref2$options = _ref2.options,\n      options = _ref2$options === undefined ? {} : _ref2$options,\n      _ref2$projectLocation = _ref2.projectLocation,\n      projectLocation = _ref2$projectLocation === undefined ? null : _ref2$projectLocation;\n\n\n  if (!kvs || !kvs.get || !kvs.set) {\n    throw new Error('A valid \\'kvs\\' is mandatory to createConfig');\n  }\n\n  validateName(name);\n  options = amendOptions(options);\n\n  var saveAll = function saveAll(obj) {\n    validateSave(options, obj);\n    return kvs.set('__config', obj, name);\n  };\n\n  var loadAll = function loadAll() {\n    return kvs.get('__config', name).then(function (all) {\n      return overwriteFromDefaultValues(options, all || {});\n    }).then(function (all) {\n      return overwriteFromBotfileValues(name, options, botfile, all);\n    }).then(function (all) {\n      return overwriteFromConfigFileValues(name, options, projectLocation, all);\n    }).then(function (all) {\n      return overwriteFromEnvValues(options, all);\n    }).then(function (all) {\n      return removeUnusedKeys(options, all);\n    });\n  };\n\n  var get = function get(name) {\n    return kvs.get('__config', name + '.' + name).then(function (value) {\n      return overwriteFromDefaultValues(options, _defineProperty({}, name, value));\n    }).then(function (all) {\n      return overwriteFromBotfileValues(name, options, botfile, all);\n    }).then(function (all) {\n      return overwriteFromConfigFileValues(name, options, projectLocation, all);\n    }).then(function (all) {\n      return overwriteFromEnvValues(options, all);\n    }).then(function (obj) {\n      return obj[name];\n    });\n  };\n\n  var set = function set(name, value) {\n    validateSet(options, name, value);\n    return kvs.set('__config', value, name + '.' + name);\n  };\n\n  return { saveAll: saveAll, loadAll: loadAll, get: get, set: set, options: options };\n};\n\nmodule.exports = { createConfig: createConfig };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NvbmZpZ3VyYXRvci5qcz81YWZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgeWFtbCBmcm9tICdqcy15YW1sJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbmNvbnN0IHZhbGlkYXRpb25zID0ge1xuICAnYW55JzogKHZhbHVlLCB2YWxpZGF0aW9uKSA9PiB2YWxpZGF0aW9uKHZhbHVlKSxcbiAgJ3N0cmluZyc6ICh2YWx1ZSwgdmFsaWRhdGlvbikgPT4gdHlwZW9mKHZhbHVlKSA9PT0gJ3N0cmluZycgJiYgdmFsaWRhdGlvbih2YWx1ZSksXG4gICdjaG9pY2UnOiAodmFsdWUsIHZhbGlkYXRpb24pID0+IF8uaW5jbHVkZXModmFsaWRhdGlvbiwgdmFsdWUpLFxuICAnYm9vbCc6ICh2YWx1ZSwgdmFsaWRhdGlvbikgPT4gKHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBmYWxzZSkgJiYgdmFsaWRhdGlvbih2YWx1ZSlcbn1cblxuY29uc3QgZGVmYXVsdFZhbHVlcyA9IHtcbiAgJ2FueSc6IG51bGwsXG4gICdzdHJpbmcnOiAnJyxcbiAgJ2Jvb2wnOiBmYWxzZVxufVxuXG5jb25zdCBhbWVuZE9wdGlvbiA9IChvcHRpb24sIG5hbWUpID0+IHtcblxuICBjb25zdCB2YWxpZFR5cGVzID0gXy5rZXlzKHZhbGlkYXRpb25zKVxuICBpZiAoIW9wdGlvbi50eXBlIHx8ICFfLmluY2x1ZGVzKHZhbGlkVHlwZXMsIG9wdGlvbi50eXBlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB0eXBlICgke29wdGlvbi50eXBlIHx8ICcnfSkgZm9yIGNvbmZpZyBrZXkgKCR7bmFtZX0pYClcbiAgfVxuXG4gIGNvbnN0IHZhbGlkYXRpb24gPSBvcHRpb24udmFsaWRhdGlvbiB8fCAoKCkgPT4gdHJ1ZSlcblxuICBpZiAodHlwZW9mKG9wdGlvbi5kZWZhdWx0KSAhPT0gJ3VuZGVmaW5lZCcgJiYgIXZhbGlkYXRpb25zW29wdGlvbi50eXBlXShvcHRpb24uZGVmYXVsdCwgdmFsaWRhdGlvbikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZGVmYXVsdCB2YWx1ZSAoJHtvcHRpb24uZGVmYXVsdH0pIGZvciAoJHtuYW1lfSlgKVxuICB9XG5cbiAgaWYgKCFvcHRpb24uZGVmYXVsdCAmJiAhXy5pbmNsdWRlcyhfLmtleXMoZGVmYXVsdFZhbHVlcyksIG9wdGlvbi50eXBlKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgRGVmYXVsdCB2YWx1ZSBpcyBtYW5kYXRvcnkgZm9yIHR5cGUgJHtvcHRpb24udHlwZX0gKCR7bmFtZX0pYClcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogb3B0aW9uLnR5cGUsXG4gICAgcmVxdWlyZWQ6IG9wdGlvbi5yZXF1aXJlZCB8fCBmYWxzZSxcbiAgICBlbnY6IG9wdGlvbi5lbnYgfHwgbnVsbCxcbiAgICBkZWZhdWx0OiBvcHRpb24uZGVmYXVsdCB8fCBkZWZhdWx0VmFsdWVzW29wdGlvbi50eXBlXSxcbiAgICB2YWxpZGF0aW9uOiB2YWxpZGF0aW9uXG4gIH1cbn1cblxuY29uc3QgYW1lbmRPcHRpb25zID0gb3B0aW9ucyA9PiB7XG4gIHJldHVybiBfLm1hcFZhbHVlcyhvcHRpb25zLCBhbWVuZE9wdGlvbilcbn1cblxuY29uc3QgdmFsaWRhdGVTZXQgPSAob3B0aW9ucywgbmFtZSwgdmFsdWUpID0+IHtcblxuICAvLyBpZiBuYW1lIGlzIG5vdCBpbiBvcHRpb25zLCB0aHJvd1xuICBpZiAoIV8uaW5jbHVkZXMoXy5rZXlzKG9wdGlvbnMpLCBuYW1lKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVW5yZWNvZ25pemVkIGNvbmZpZ3VyYXRpb24ga2V5OiAke25hbWV9YClcbiAgfVxuXG4gIGlmICghdmFsaWRhdGlvbnNbb3B0aW9uc1tuYW1lXS50eXBlXSh2YWx1ZSwgb3B0aW9uc1tuYW1lXS52YWxpZGF0aW9uKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCB2YWx1ZSBmb3Iga2V5OiAke25hbWV9YClcbiAgfVxufVxuXG5jb25zdCB2YWxpZGF0ZVNhdmUgPSAob3B0aW9ucywgb2JqZWN0KSA9PiB7XG4gIGNvbnN0IG9iaktleXMgPSBfLmtleXMob2JqZWN0KVxuICBjb25zdCByZXF1aXJlZEtleXMgPSBfLmZpbHRlcihfLmtleXMob3B0aW9ucyksIGtleSA9PiBvcHRpb25zW2tleV0ucmVxdWlyZWQpXG5cbiAgXy5lYWNoKHJlcXVpcmVkS2V5cywgcmVxdWlyZWQgPT4ge1xuICAgIGlmICghXy5pbmNsdWRlcyhvYmpLZXlzLCByZXF1aXJlZCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyByZXF1aXJlZCBjb25maWd1cmF0aW9uOiAnJHtyZXF1aXJlZH0nYClcbiAgICB9XG4gIH0pXG5cbiAgXy5lYWNoKG9iaktleXMsIG5hbWUgPT4ge1xuICAgIHZhbGlkYXRlU2V0KG9wdGlvbnMsIG5hbWUsIG9iamVjdFtuYW1lXSlcbiAgfSlcbn1cblxuY29uc3QgdmFsaWRhdGVOYW1lID0gbmFtZSA9PiB7XG4gIGlmICghbmFtZSB8fCAhL15bQS1aMC05Ll8tXSskL2kudGVzdChuYW1lKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBjb25maWd1cmF0aW9uIG5hbWU6ICR7bmFtZX0uIFRoZSBuYW1lIG11c3Qgb25seSBjb250YWluIGxldHRlcnMsIF8gYW5kIC1gKVxuICB9XG59XG5cbmNvbnN0IG92ZXJ3cml0ZUZyb21EZWZhdWx0VmFsdWVzID0gKG9wdGlvbnMsIG9iamVjdCkgPT4ge1xuICBfLmVhY2goXy5rZXlzKG9wdGlvbnMpLCBuYW1lID0+IHtcbiAgICBpZiAodHlwZW9mIG9iamVjdFtuYW1lXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIG9iamVjdFtuYW1lXSA9IG9wdGlvbnNbbmFtZV0uZGVmYXVsdFxuICAgIH1cbiAgfSlcblxuICByZXR1cm4gb2JqZWN0XG59XG5cbmNvbnN0IG92ZXJ3cml0ZUZyb21FbnZWYWx1ZXMgPSAob3B0aW9ucywgb2JqZWN0KSA9PiB7XG4gIHJldHVybiBfLm1hcFZhbHVlcyhvYmplY3QsIChfdiwgbmFtZSkgPT4ge1xuICAgIGlmIChvcHRpb25zW25hbWVdICYmIG9wdGlvbnNbbmFtZV0uZW52ICYmIHByb2Nlc3MuZW52W29wdGlvbnNbbmFtZV0uZW52XSkge1xuICAgICAgcmV0dXJuIHByb2Nlc3MuZW52W29wdGlvbnNbbmFtZV0uZW52XVxuICAgIH1cblxuICAgIHJldHVybiBfdlxuICB9KVxufVxuXG5jb25zdCBvdmVyd3JpdGVGcm9tQm90ZmlsZVZhbHVlcyA9IChjb25maWdfbmFtZSwgb3B0aW9ucywgYm90ZmlsZSwgb2JqZWN0KSA9PiB7XG4gIHJldHVybiBfLm1hcFZhbHVlcyhvYmplY3QsIChfdiwgbmFtZSkgPT4ge1xuICAgIGlmIChib3RmaWxlIFxuICAgICAgJiYgYm90ZmlsZS5jb25maWcgXG4gICAgICAmJiBib3RmaWxlLmNvbmZpZ1tjb25maWdfbmFtZV0gXG4gICAgICAmJiB0eXBlb2YgYm90ZmlsZS5jb25maWdbY29uZmlnX25hbWVdW25hbWVdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuIGJvdGZpbGUuY29uZmlnW2NvbmZpZ19uYW1lXVtuYW1lXVxuICAgIH1cblxuICAgIHJldHVybiBfdlxuICB9KVxufVxuXG5jb25zdCBvdmVyd3JpdGVGcm9tQ29uZmlnRmlsZVZhbHVlcyA9IGFzeW5jIChjb25maWdfbmFtZSwgb3B0aW9ucywgcHJvamVjdExvY2F0aW9uLCBvYmplY3QpID0+IHtcbiAgaWYgKCFwcm9qZWN0TG9jYXRpb24pIHtcbiAgICByZXR1cm4gb2JqZWN0XG4gIH1cblxuICBjb25zdCBjb25maWdGaWxlUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9qZWN0TG9jYXRpb24sIGAke2NvbmZpZ19uYW1lfS5jb25maWcueW1sYClcblxuICBpZiAoIWZzLmV4aXN0c1N5bmMoY29uZmlnRmlsZVBhdGgpKSB7XG4gICAgcmV0dXJuIG9iamVjdFxuICB9XG5cbiAgY29uc3QgY29uZmlnRnJvbUZpbGUgPSBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYWxsYmFjayA9PiB7XG4gICAgeWFtbC5zYWZlTG9hZEFsbChmcy5yZWFkRmlsZVN5bmMoY29uZmlnRmlsZVBhdGgpLCB2YWx1ZSA9PiBjYWxsYmFjayhudWxsLCB2YWx1ZSkpXG4gIH0pXG5cbiAgcmV0dXJuIF8ubWFwVmFsdWVzKG9iamVjdCwgKF92LCBuYW1lKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBjb25maWdGcm9tRmlsZVtuYW1lXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiBjb25maWdGcm9tRmlsZVtuYW1lXVxuICAgIH1cbiAgICByZXR1cm4gX3ZcbiAgfSlcbn1cblxuY29uc3QgcmVtb3ZlVW51c2VkS2V5cyA9IChvcHRpb25zLCBvYmplY3QpID0+IHtcbiAgY29uc3QgZmluYWwgPSB7fVxuXG4gIF8uZWFjaChfLmtleXMob3B0aW9ucyksIG5hbWUgPT4ge1xuICAgIGlmICh0eXBlb2Ygb2JqZWN0W25hbWVdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgZmluYWxbbmFtZV0gPSBvYmplY3RbbmFtZV1cbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIGZpbmFsXG59XG5cbmNvbnN0IGNyZWF0ZUNvbmZpZyA9ICh7IGt2cywgbmFtZSwgYm90ZmlsZSA9IHt9LCBvcHRpb25zID0ge30sIHByb2plY3RMb2NhdGlvbiA9IG51bGwgfSkgPT4ge1xuXG4gIGlmICgha3ZzIHx8ICFrdnMuZ2V0IHx8ICFrdnMuc2V0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBIHZhbGlkIFxcJ2t2c1xcJyBpcyBtYW5kYXRvcnkgdG8gY3JlYXRlQ29uZmlnJylcbiAgfVxuXG4gIHZhbGlkYXRlTmFtZShuYW1lKVxuICBvcHRpb25zID0gYW1lbmRPcHRpb25zKG9wdGlvbnMpXG5cbiAgY29uc3Qgc2F2ZUFsbCA9IG9iaiA9PiB7XG4gICAgdmFsaWRhdGVTYXZlKG9wdGlvbnMsIG9iailcbiAgICByZXR1cm4ga3ZzLnNldCgnX19jb25maWcnLCBvYmosIG5hbWUpXG4gIH1cblxuICBjb25zdCBsb2FkQWxsID0gKCkgPT4ge1xuICAgIHJldHVybiBrdnMuZ2V0KCdfX2NvbmZpZycsIG5hbWUpXG4gICAgICAudGhlbihhbGwgPT4gb3ZlcndyaXRlRnJvbURlZmF1bHRWYWx1ZXMob3B0aW9ucywgYWxsIHx8IHt9KSlcbiAgICAgIC50aGVuKGFsbCA9PiBvdmVyd3JpdGVGcm9tQm90ZmlsZVZhbHVlcyhuYW1lLCBvcHRpb25zLCBib3RmaWxlLCBhbGwpKVxuICAgICAgLnRoZW4oYWxsID0+IG92ZXJ3cml0ZUZyb21Db25maWdGaWxlVmFsdWVzKG5hbWUsIG9wdGlvbnMsIHByb2plY3RMb2NhdGlvbiwgYWxsKSlcbiAgICAgIC50aGVuKGFsbCA9PiBvdmVyd3JpdGVGcm9tRW52VmFsdWVzKG9wdGlvbnMsIGFsbCkpXG4gICAgICAudGhlbihhbGwgPT4gcmVtb3ZlVW51c2VkS2V5cyhvcHRpb25zLCBhbGwpKVxuICB9XG5cbiAgY29uc3QgZ2V0ID0gbmFtZSA9PiB7XG4gICAgcmV0dXJuIGt2cy5nZXQoJ19fY29uZmlnJywgbmFtZSArICcuJyArIG5hbWUpXG4gICAgICAudGhlbih2YWx1ZSA9PiBvdmVyd3JpdGVGcm9tRGVmYXVsdFZhbHVlcyhvcHRpb25zLCB7IFtuYW1lXTogdmFsdWUgfSkpXG4gICAgICAudGhlbihhbGwgPT4gb3ZlcndyaXRlRnJvbUJvdGZpbGVWYWx1ZXMobmFtZSwgb3B0aW9ucywgYm90ZmlsZSwgYWxsKSlcbiAgICAgIC50aGVuKGFsbCA9PiBvdmVyd3JpdGVGcm9tQ29uZmlnRmlsZVZhbHVlcyhuYW1lLCBvcHRpb25zLCBwcm9qZWN0TG9jYXRpb24sIGFsbCkpXG4gICAgICAudGhlbihhbGwgPT4gb3ZlcndyaXRlRnJvbUVudlZhbHVlcyhvcHRpb25zLCBhbGwpKVxuICAgICAgLnRoZW4ob2JqID0+IG9ialtuYW1lXSlcbiAgfVxuXG4gIGNvbnN0IHNldCA9IChuYW1lLCB2YWx1ZSkgPT4ge1xuICAgIHZhbGlkYXRlU2V0KG9wdGlvbnMsIG5hbWUsIHZhbHVlKVxuICAgIHJldHVybiBrdnMuc2V0KCdfX2NvbmZpZycsIHZhbHVlLCBuYW1lICsgJy4nICsgbmFtZSlcbiAgfVxuICBcbiAgcmV0dXJuIHsgc2F2ZUFsbCwgbG9hZEFsbCwgZ2V0LCBzZXQsIG9wdGlvbnMgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgY3JlYXRlQ29uZmlnIH1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvY29uZmlndXJhdG9yLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBS0E7QUFDQTtBQU5BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBWUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQWRBO0FBV0E7QUFYQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///44\n");

/***/ }),
/* 45 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _modules = __webpack_require__(10);\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar waitingText = 'please wait, we are trying to uninstall the modules...';\n\nmodule.exports = function (module, modules) {\n  (0, _stats2.default)({}).track('cli', 'modules', 'install');\n  _util2.default.print('info', waitingText);\n  var modulesManager = (0, _modules2.default)(null, './', null);\n  modulesManager.uninstall.apply(modulesManager, [module].concat(_toConsumableArray(modules)));\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS91bmluc3RhbGwuanM/ZmYyNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuXG5pbXBvcnQgY3JlYXRlTW9kdWxlcyBmcm9tICcuLi9tb2R1bGVzJ1xuXG5pbXBvcnQgc3RhdHMgZnJvbSAnLi4vc3RhdHMnXG5cbmNvbnN0IHdhaXRpbmdUZXh0ID0gJ3BsZWFzZSB3YWl0LCB3ZSBhcmUgdHJ5aW5nIHRvIHVuaW5zdGFsbCB0aGUgbW9kdWxlcy4uLidcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUsIG1vZHVsZXMpIHtcbiAgc3RhdHMoe30pLnRyYWNrKCdjbGknLCAnbW9kdWxlcycsICdpbnN0YWxsJylcbiAgdXRpbC5wcmludCgnaW5mbycsIHdhaXRpbmdUZXh0KVxuICBsZXQgbW9kdWxlc01hbmFnZXIgPSBjcmVhdGVNb2R1bGVzKG51bGwsICcuLycsIG51bGwpXG4gIG1vZHVsZXNNYW5hZ2VyLnVuaW5zdGFsbChtb2R1bGUsIC4uLm1vZHVsZXMpXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS91bmluc3RhbGwuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///45\n");

/***/ }),
/* 46 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (fromVersion) {\n  (0, _stats2.default)({}).track('cli', 'migration', fromVersion);\n\n  if (!_fs2.default.existsSync('./botfile.js')) {\n    throw new Error('You must be inside a bot directory to run a migration');\n  }\n\n  var files = _lodash2.default.sortBy(__webpack_require__(20).keys(), function (x) {\n    return x;\n  });\n\n  var toApply = _lodash2.default.filter(files, function (f) {\n    if (!/.js$/i.test(f)) {\n      return false;\n    }\n\n    return parseFloat(fromVersion) < parseFloat(f.replace(/\\.js/i, ''));\n  });\n\n  return _bluebird2.default.mapSeries(toApply, function (file) {\n    var migration = __webpack_require__(20)(\"./\" + file);\n    return migration(_path2.default.resolve('.')).then(function () {\n      _util2.default.print('success', 'Migration ' + file.replace('.js', '') + ' applied successfully');\n    });\n  }).finally(function () {\n    _util2.default.print('success', 'Migration completed.');\n    process.exit(0);\n  });\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9taWdyYXRlLmpzPzYyYTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcbmltcG9ydCBzdGF0cyBmcm9tICcuLi9zdGF0cydcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmcm9tVmVyc2lvbikge1xuICBzdGF0cyh7fSkudHJhY2soJ2NsaScsICdtaWdyYXRpb24nLCBmcm9tVmVyc2lvbilcblxuICBpZiAoIWZzLmV4aXN0c1N5bmMoJy4vYm90ZmlsZS5qcycpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBiZSBpbnNpZGUgYSBib3QgZGlyZWN0b3J5IHRvIHJ1biBhIG1pZ3JhdGlvbicpXG4gIH1cblxuICBsZXQgZmlsZXMgPSBfLnNvcnRCeShyZXF1aXJlLmNvbnRleHQoJy4vbWlncmF0aW9ucy8nKS5rZXlzKCksIHggPT4geClcblxuICBjb25zdCB0b0FwcGx5ID0gXy5maWx0ZXIoZmlsZXMsIGYgPT4ge1xuICAgIGlmICghLy5qcyQvaS50ZXN0KGYpKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gcGFyc2VGbG9hdChmcm9tVmVyc2lvbikgPCBwYXJzZUZsb2F0KGYucmVwbGFjZSgvXFwuanMvaSwgJycpKVxuICB9KVxuXG4gIHJldHVybiBQcm9taXNlLm1hcFNlcmllcyh0b0FwcGx5LCBmaWxlID0+IHtcbiAgICBjb25zdCBtaWdyYXRpb24gPSByZXF1aXJlKCcuL21pZ3JhdGlvbnMvJyArIGZpbGUpXG4gICAgcmV0dXJuIG1pZ3JhdGlvbihwYXRoLnJlc29sdmUoJy4nKSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdXRpbC5wcmludCgnc3VjY2VzcycsIGBNaWdyYXRpb24gJHtmaWxlLnJlcGxhY2UoJy5qcycsICcnKX0gYXBwbGllZCBzdWNjZXNzZnVsbHlgKVxuICAgICAgfSlcbiAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICB1dGlsLnByaW50KCdzdWNjZXNzJywgJ01pZ3JhdGlvbiBjb21wbGV0ZWQuJylcbiAgICAgIHByb2Nlc3MuZXhpdCgwKVxuICAgIH0pXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9taWdyYXRlLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///46\n");

/***/ }),
/* 47 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(3);\n\nvar _modules = __webpack_require__(10);\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function () {\n  var modulesManager = (0, _modules2.default)(null, './', null);\n  var modules = modulesManager.listInstalled();\n\n  if (!modules || modules.length === 0) {\n    (0, _util.print)('info', \"There are no module installed.\");\n    (0, _util.print)('------------------');\n    (0, _util.print)('info', \"To install modules, use `botpress install <module-name>`\");\n    (0, _util.print)('info', \"You can discover modules in the Modules section of your bot UI\" + \". You can also search npm with the botpress keyword.\");\n  } else {\n    (0, _util.print)('info', \"There are \" + modules.length + \" modules installed:\");\n    modules.forEach(function (mod) {\n      return (0, _util.print)('>> ' + mod);\n    });\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NsaS9saXN0LmpzPzJlY2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpbnQgfSBmcm9tICcuLi91dGlsJ1xuXG5pbXBvcnQgY3JlYXRlTW9kdWxlcyBmcm9tICcuLi9tb2R1bGVzJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICBsZXQgbW9kdWxlc01hbmFnZXIgPSBjcmVhdGVNb2R1bGVzKG51bGwsICcuLycsIG51bGwpXG4gIGxldCBtb2R1bGVzID0gbW9kdWxlc01hbmFnZXIubGlzdEluc3RhbGxlZCgpXG5cbiAgaWYgKCFtb2R1bGVzIHx8IG1vZHVsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcHJpbnQoJ2luZm8nLCBcIlRoZXJlIGFyZSBubyBtb2R1bGUgaW5zdGFsbGVkLlwiKVxuICAgIHByaW50KCctLS0tLS0tLS0tLS0tLS0tLS0nKVxuICAgIHByaW50KCdpbmZvJywgXCJUbyBpbnN0YWxsIG1vZHVsZXMsIHVzZSBgYm90cHJlc3MgaW5zdGFsbCA8bW9kdWxlLW5hbWU+YFwiKVxuICAgIHByaW50KCdpbmZvJywgXCJZb3UgY2FuIGRpc2NvdmVyIG1vZHVsZXMgaW4gdGhlIE1vZHVsZXMgc2VjdGlvbiBvZiB5b3VyIGJvdCBVSVwiICtcbiAgICAgIFwiLiBZb3UgY2FuIGFsc28gc2VhcmNoIG5wbSB3aXRoIHRoZSBib3RwcmVzcyBrZXl3b3JkLlwiKVxuICB9IGVsc2Uge1xuICAgIHByaW50KCdpbmZvJywgXCJUaGVyZSBhcmUgXCIgKyBtb2R1bGVzLmxlbmd0aCArIFwiIG1vZHVsZXMgaW5zdGFsbGVkOlwiKVxuICAgIG1vZHVsZXMuZm9yRWFjaChtb2QgPT4gcHJpbnQoJz4+ICcgKyBtb2QpKVxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NsaS9saXN0LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///47\n");

/***/ }),
/* 48 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\n__webpack_require__(49);\n\nvar _chalk = __webpack_require__(7);\n\nvar _chalk2 = _interopRequireDefault(_chalk);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _cluster = __webpack_require__(50);\n\nvar _cluster2 = _interopRequireDefault(_cluster);\n\nvar _dotenv = __webpack_require__(51);\n\nvar _dotenv2 = _interopRequireDefault(_dotenv);\n\nvar _ServiceLocator = __webpack_require__(23);\n\nvar _ServiceLocator2 = _interopRequireDefault(_ServiceLocator);\n\nvar _bus = __webpack_require__(53);\n\nvar _bus2 = _interopRequireDefault(_bus);\n\nvar _middlewares = __webpack_require__(54);\n\nvar _middlewares2 = _interopRequireDefault(_middlewares);\n\nvar _logger = __webpack_require__(56);\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _security = __webpack_require__(58);\n\nvar _security2 = _interopRequireDefault(_security);\n\nvar _notifications = __webpack_require__(61);\n\nvar _notifications2 = _interopRequireDefault(_notifications);\n\nvar _hear = __webpack_require__(62);\n\nvar _hear2 = _interopRequireDefault(_hear);\n\nvar _fallback = __webpack_require__(63);\n\nvar _fallback2 = _interopRequireDefault(_fallback);\n\nvar _database = __webpack_require__(64);\n\nvar _database2 = _interopRequireDefault(_database);\n\nvar _licensing = __webpack_require__(26);\n\nvar _licensing2 = _interopRequireDefault(_licensing);\n\nvar _about = __webpack_require__(71);\n\nvar _about2 = _interopRequireDefault(_about);\n\nvar _modules = __webpack_require__(10);\n\nvar _modules2 = _interopRequireDefault(_modules);\n\nvar _umm = __webpack_require__(72);\n\nvar _umm2 = _interopRequireDefault(_umm);\n\nvar _users = __webpack_require__(76);\n\nvar _users2 = _interopRequireDefault(_users);\n\nvar _service = __webpack_require__(77);\n\nvar _service2 = _interopRequireDefault(_service);\n\nvar _conversations = __webpack_require__(79);\n\nvar _conversations2 = _interopRequireDefault(_conversations);\n\nvar _stats = __webpack_require__(6);\n\nvar _stats2 = _interopRequireDefault(_stats);\n\nvar _package = __webpack_require__(80);\n\nvar _package2 = _interopRequireDefault(_package);\n\nvar _emails = __webpack_require__(81);\n\nvar _emails2 = _interopRequireDefault(_emails);\n\nvar _mediator = __webpack_require__(82);\n\nvar _mediator2 = _interopRequireDefault(_mediator);\n\nvar _server = __webpack_require__(83);\n\nvar _server2 = _interopRequireDefault(_server);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RESTART_EXIT_CODE = 107;\n\nvar mkdirIfNeeded = function mkdirIfNeeded(path, logger) {\n  if (!_fs2.default.existsSync(path)) {\n    logger.info('Creating data directory: ' + path);\n\n    try {\n      _fs2.default.mkdirSync(path);\n    } catch (err) {\n      logger.error('[FATAL] Error creating directory: ' + err.message);\n      process.exit(1);\n    }\n  }\n};\n\n/**\n * Global context botpress\n*/\n\nvar botpress = function () {\n  /**\n   * Create botpress\n   *\n   * @param {string} obj.botfile - the config path\n   */\n  function botpress(_ref) {\n    var botfile = _ref.botfile;\n\n    _classCallCheck(this, botpress);\n\n    this.version = (0, _util.getBotpressVersion)();\n    /**\n     * The project location, which is the folder where botfile.js located\n     */\n    this.projectLocation = _path2.default.dirname(botfile);\n\n    /**\n     * Setup env with dotenv *before* requiring the botfile config\n     */\n    this._setupEnv();\n\n    /**\n     * The botfile config object\n     */\n    // eslint-disable-next-line no-eval\n    this.botfile = eval('require')(botfile);\n\n    this.stats = (0, _stats2.default)(this.botfile);\n\n    this.interval = null;\n  }\n\n  /**\n   * Start the bot instance\n   *\n   * It will do the following initiation steps:\n   *\n   * 1. setup logger\n   * 2. resolve paths (dataLocation)\n   * 3. inject security functions\n   * 4. load modules\n   */\n\n\n  _createClass(botpress, [{\n    key: '_start',\n    value: function () {\n      var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var projectLocation, botfile, isFirstRun, dataLocation, modulesConfigDir, dbLocation, version, logger, db, security, modules, moduleDefinitions, events, notifications, about, licensing, middlewares, _createHearMiddleware, hear, hearMiddleware, _createFallbackMiddle, fallbackMiddleware, emails, mediator, convo, users, contentManager, umm, loadedModules, server, middlewareAutoLoading, projectEntry;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.stats.track('bot', 'started');\n\n                if (!this.interval) {\n                  this.interval = setInterval(function () {\n                    _this.stats.track('bot', 'running');\n                  }, 30 * 1000);\n                }\n\n                // change the current working directory to botpress's installation path\n                // the bot's location is kept in this.projectLocation\n                process.chdir(_path2.default.join(__dirname, '../'));\n\n                projectLocation = this.projectLocation, botfile = this.botfile;\n                isFirstRun = _fs2.default.existsSync(_path2.default.join(projectLocation, '.welcome'));\n                dataLocation = (0, _util.getDataLocation)(botfile.dataDir, projectLocation);\n                modulesConfigDir = (0, _util.getDataLocation)(botfile.modulesConfigDir, projectLocation);\n                dbLocation = _path2.default.join(dataLocation, 'db.sqlite');\n                version = _package2.default.version;\n                logger = (0, _logger2.default)(dataLocation, botfile.log);\n\n                mkdirIfNeeded(dataLocation, logger);\n                mkdirIfNeeded(modulesConfigDir, logger);\n\n                logger.info('Starting botpress version ' + version);\n\n                db = (0, _database2.default)({\n                  sqlite: { location: dbLocation },\n                  postgres: botfile.postgres\n                });\n                security = (0, _security2.default)({\n                  dataLocation: dataLocation,\n                  securityConfig: botfile.login,\n                  db: db\n                });\n                modules = (0, _modules2.default)(logger, projectLocation, dataLocation, db.kvs);\n                moduleDefinitions = modules._scan();\n                events = new _bus2.default();\n                _context.t0 = _notifications2.default;\n                _context.next = 21;\n                return db.get();\n\n              case 21:\n                _context.t1 = _context.sent;\n                _context.t2 = moduleDefinitions;\n                _context.t3 = logger;\n                _context.t4 = events;\n                _context.t5 = {\n                  knex: _context.t1,\n                  modules: _context.t2,\n                  logger: _context.t3,\n                  events: _context.t4\n                };\n                notifications = (0, _context.t0)(_context.t5);\n                about = (0, _about2.default)(projectLocation);\n                licensing = (0, _licensing2.default)({ logger: logger, projectLocation: projectLocation, version: version, db: db, botfile: botfile });\n                middlewares = (0, _middlewares2.default)(this, dataLocation, projectLocation, logger);\n                _createHearMiddleware = (0, _hear2.default)(), hear = _createHearMiddleware.hear, hearMiddleware = _createHearMiddleware.middleware;\n                _createFallbackMiddle = (0, _fallback2.default)(this), fallbackMiddleware = _createFallbackMiddle.middleware;\n                emails = (0, _emails2.default)({ emailConfig: botfile.emails });\n                mediator = (0, _mediator2.default)(this);\n                convo = (0, _conversations2.default)({ logger: logger, middleware: middlewares });\n                users = (0, _users2.default)({ db: db });\n                contentManager = (0, _service2.default)({ db: db, logger: logger, projectLocation: projectLocation, botfile: botfile });\n                umm = (0, _umm2.default)({ logger: logger, middlewares: middlewares, projectLocation: projectLocation, botfile: botfile, db: db, contentManager: contentManager });\n\n\n                middlewares.register(umm.incomingMiddleware);\n                middlewares.register(hearMiddleware);\n                middlewares.register(fallbackMiddleware);\n\n                _lodash2.default.assign(this, {\n                  dataLocation: dataLocation,\n                  isFirstRun: isFirstRun,\n                  version: version,\n                  logger: logger,\n                  security: security, // login, authenticate, getSecret\n                  events: events,\n                  notifications: notifications, // load, save, send\n                  about: about,\n                  middlewares: middlewares,\n                  hear: hear,\n                  licensing: licensing,\n                  modules: modules,\n                  db: db,\n                  emails: emails,\n                  mediator: mediator,\n                  convo: convo,\n                  umm: umm,\n                  users: users,\n                  contentManager: contentManager\n                });\n\n                _ServiceLocator2.default.init({ bp: this });\n\n                loadedModules = modules._load(moduleDefinitions, this);\n\n\n                this.stats.track('bot', 'modules', 'loaded', loadedModules.length);\n\n                _lodash2.default.assign(this, {\n                  _loadedModules: loadedModules\n                });\n\n                contentManager.scanAndRegisterCategories();\n\n                mediator.install();\n                notifications._bindEvents();\n\n                server = (0, _server2.default)(this);\n\n                server.start().then(function () {\n                  events.emit('ready');\n                  var _iteratorNormalCompletion = true;\n                  var _didIteratorError = false;\n                  var _iteratorError = undefined;\n\n                  try {\n                    for (var _iterator = _lodash2.default.values(loadedModules)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                      var mod = _step.value;\n\n                      mod.handlers.ready && mod.handlers.ready(_this, mod.configuration);\n                    }\n                  } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                      }\n                    } finally {\n                      if (_didIteratorError) {\n                        throw _iteratorError;\n                      }\n                    }\n                  }\n\n                  var port = botfile.port;\n\n                  logger.info(_chalk2.default.green.bold('Bot launched. Visit: http://localhost:' + port));\n                });\n\n                middlewareAutoLoading = _lodash2.default.get(botfile, 'middleware.autoLoading');\n\n                if (!_lodash2.default.isNil(middlewareAutoLoading) && middlewareAutoLoading === false) {\n                  logger.debug('Middleware Auto Loading was disabled. Call bp.middlewares.load() manually.');\n                } else {\n                  middlewares.load();\n                }\n\n                // eslint-disable-next-line no-eval\n                projectEntry = eval('require')(projectLocation);\n\n                if (typeof projectEntry === 'function') {\n                  projectEntry.call(projectEntry, this);\n                } else {\n                  logger.error('[FATAL] The bot entry point must be a function that takes an instance of bp');\n                  process.exit(1);\n                }\n\n                process.on('uncaughtException', function (err) {\n                  logger.error('[FATAL] An unhandled exception occurred in your bot', err);\n                  if (_util.isDeveloping) {\n                    logger.error(err.stack);\n                  }\n\n                  _this.stats.trackException(err.message);\n                  process.exit(1);\n                });\n\n                process.on('unhandledRejection', function (reason, p) {\n                  logger.error('Unhandled Rejection in Promise: ', p, 'Reason:', reason);\n\n                  _this.stats.trackException(reason);\n                  if (_util.isDeveloping && reason && reason.stack) {\n                    logger.error(reason.stack);\n                  }\n                });\n\n              case 57:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _start() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return _start;\n    }()\n  }, {\n    key: 'start',\n    value: function start() {\n      var _this2 = this;\n\n      if (_cluster2.default.isMaster) {\n        (function () {\n          var firstWorkerHasStartedAlready = false;\n          var receiveMessageFromWorker = function receiveMessageFromWorker(message) {\n            if (message && message.workerStatus === 'starting') {\n              if (!firstWorkerHasStartedAlready) {\n                firstWorkerHasStartedAlready = true;\n              } else {\n                (0, _util.print)('info', '*** restarted worker process ***');\n                _this2.stats.track('bot', 'restarted');\n              }\n            }\n          };\n\n          _cluster2.default.on('exit', function (worker, code /* , signal */) {\n            if (code === RESTART_EXIT_CODE) {\n              _cluster2.default.fork().on('message', receiveMessageFromWorker);\n            } else {\n              process.exit(code);\n            }\n          });\n\n          _cluster2.default.fork().on('message', receiveMessageFromWorker);\n        })();\n      }\n\n      if (_cluster2.default.isWorker) {\n        process.send({ workerStatus: 'starting' });\n        this._start();\n      }\n    }\n  }, {\n    key: 'restart',\n    value: function restart() {\n      var interval = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n      setTimeout(function () {\n        process.exit(RESTART_EXIT_CODE);\n      }, interval);\n    }\n  }, {\n    key: '_setupEnv',\n    value: function _setupEnv() {\n      var envPath = _path2.default.resolve(this.projectLocation, '.env');\n      if (_fs2.default.existsSync(envPath)) {\n        var envConfig = _dotenv2.default.parse(_fs2.default.readFileSync(envPath));\n        for (var k in envConfig) {\n          if (_lodash2.default.isNil(process.env[k]) || process.env.ENV_OVERLOAD) {\n            process.env[k] = envConfig[k];\n          }\n        }\n      }\n    }\n  }]);\n\n  return botpress;\n}();\n\nmodule.exports = botpress;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2JvdHByZXNzLmpzPzdkNGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXInXG5cbmltcG9ydCBjaGFsayBmcm9tICdjaGFsaydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgY2x1c3RlciBmcm9tICdjbHVzdGVyJ1xuaW1wb3J0IGRvdGVudiBmcm9tICdkb3RlbnYnXG5cbmltcG9ydCBTZXJ2aWNlTG9jYXRvciBmcm9tICcrL1NlcnZpY2VMb2NhdG9yJ1xuaW1wb3J0IEV2ZW50QnVzIGZyb20gJy4vYnVzJ1xuXG5pbXBvcnQgY3JlYXRlTWlkZGxld2FyZXMgZnJvbSAnLi9taWRkbGV3YXJlcydcbmltcG9ydCBjcmVhdGVMb2dnZXIgZnJvbSAnLi9sb2dnZXInXG5pbXBvcnQgY3JlYXRlU2VjdXJpdHkgZnJvbSAnLi9zZWN1cml0eSdcbmltcG9ydCBjcmVhdGVOb3RpZmljYXRpb25zIGZyb20gJy4vbm90aWZpY2F0aW9ucydcbmltcG9ydCBjcmVhdGVIZWFyTWlkZGxld2FyZSBmcm9tICcuL2hlYXInXG5pbXBvcnQgY3JlYXRlRmFsbGJhY2tNaWRkbGV3YXJlIGZyb20gJy4vZmFsbGJhY2snXG5pbXBvcnQgY3JlYXRlRGF0YWJhc2UgZnJvbSAnLi9kYXRhYmFzZSdcbmltcG9ydCBjcmVhdGVMaWNlbnNpbmcgZnJvbSAnLi9saWNlbnNpbmcnXG5pbXBvcnQgY3JlYXRlQWJvdXQgZnJvbSAnLi9hYm91dCdcbmltcG9ydCBjcmVhdGVNb2R1bGVzIGZyb20gJy4vbW9kdWxlcydcbmltcG9ydCBjcmVhdGVVTU0gZnJvbSAnLi91bW0nXG5pbXBvcnQgY3JlYXRlVXNlcnMgZnJvbSAnLi91c2VycydcbmltcG9ydCBjcmVhdGVDb250ZW50TWFuYWdlciBmcm9tICcuL2NvbnRlbnQvc2VydmljZSdcbmltcG9ydCBjcmVhdGVDb252ZXJzYXRpb25zIGZyb20gJy4vY29udmVyc2F0aW9ucydcbmltcG9ydCBzdGF0cyBmcm9tICcuL3N0YXRzJ1xuaW1wb3J0IHBhY2thZ2VKc29uIGZyb20gJy4uL3BhY2thZ2UuanNvbidcbmltcG9ydCBjcmVhdGVFbWFpbHMgZnJvbSAnKy9lbWFpbHMnXG5pbXBvcnQgY3JlYXRlTWVkaWF0b3IgZnJvbSAnKy9tZWRpYXRvcidcblxuaW1wb3J0IGNyZWF0ZVNlcnZlciBmcm9tICcuL3NlcnZlcidcblxuaW1wb3J0IHsgZ2V0RGF0YUxvY2F0aW9uLCBnZXRCb3RwcmVzc1ZlcnNpb24gfSBmcm9tICcuL3V0aWwnXG5cbmltcG9ydCB7IGlzRGV2ZWxvcGluZywgcHJpbnQgfSBmcm9tICcuL3V0aWwnXG5cbmNvbnN0IFJFU1RBUlRfRVhJVF9DT0RFID0gMTA3XG5cbmNvbnN0IG1rZGlySWZOZWVkZWQgPSAocGF0aCwgbG9nZ2VyKSA9PiB7XG4gIGlmICghZnMuZXhpc3RzU3luYyhwYXRoKSkge1xuICAgIGxvZ2dlci5pbmZvKGBDcmVhdGluZyBkYXRhIGRpcmVjdG9yeTogJHtwYXRofWApXG5cbiAgICB0cnkge1xuICAgICAgZnMubWtkaXJTeW5jKHBhdGgpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoYFtGQVRBTF0gRXJyb3IgY3JlYXRpbmcgZGlyZWN0b3J5OiAke2Vyci5tZXNzYWdlfWApXG4gICAgICBwcm9jZXNzLmV4aXQoMSlcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBHbG9iYWwgY29udGV4dCBib3RwcmVzc1xuKi9cbmNsYXNzIGJvdHByZXNzIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBib3RwcmVzc1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gb2JqLmJvdGZpbGUgLSB0aGUgY29uZmlnIHBhdGhcbiAgICovXG4gIGNvbnN0cnVjdG9yKHsgYm90ZmlsZSB9KSB7XG4gICAgdGhpcy52ZXJzaW9uID0gZ2V0Qm90cHJlc3NWZXJzaW9uKClcbiAgICAvKipcbiAgICAgKiBUaGUgcHJvamVjdCBsb2NhdGlvbiwgd2hpY2ggaXMgdGhlIGZvbGRlciB3aGVyZSBib3RmaWxlLmpzIGxvY2F0ZWRcbiAgICAgKi9cbiAgICB0aGlzLnByb2plY3RMb2NhdGlvbiA9IHBhdGguZGlybmFtZShib3RmaWxlKVxuXG4gICAgLyoqXG4gICAgICogU2V0dXAgZW52IHdpdGggZG90ZW52ICpiZWZvcmUqIHJlcXVpcmluZyB0aGUgYm90ZmlsZSBjb25maWdcbiAgICAgKi9cbiAgICB0aGlzLl9zZXR1cEVudigpXG5cbiAgICAvKipcbiAgICAgKiBUaGUgYm90ZmlsZSBjb25maWcgb2JqZWN0XG4gICAgICovXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICB0aGlzLmJvdGZpbGUgPSBldmFsKCdyZXF1aXJlJykoYm90ZmlsZSlcblxuICAgIHRoaXMuc3RhdHMgPSBzdGF0cyh0aGlzLmJvdGZpbGUpXG5cbiAgICB0aGlzLmludGVydmFsID0gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHRoZSBib3QgaW5zdGFuY2VcbiAgICpcbiAgICogSXQgd2lsbCBkbyB0aGUgZm9sbG93aW5nIGluaXRpYXRpb24gc3RlcHM6XG4gICAqXG4gICAqIDEuIHNldHVwIGxvZ2dlclxuICAgKiAyLiByZXNvbHZlIHBhdGhzIChkYXRhTG9jYXRpb24pXG4gICAqIDMuIGluamVjdCBzZWN1cml0eSBmdW5jdGlvbnNcbiAgICogNC4gbG9hZCBtb2R1bGVzXG4gICAqL1xuICBhc3luYyBfc3RhcnQoKSB7XG4gICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ3N0YXJ0ZWQnKVxuXG4gICAgaWYgKCF0aGlzLmludGVydmFsKSB7XG4gICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICB0aGlzLnN0YXRzLnRyYWNrKCdib3QnLCAncnVubmluZycpXG4gICAgICB9LCAzMCAqIDEwMDApXG4gICAgfVxuXG4gICAgLy8gY2hhbmdlIHRoZSBjdXJyZW50IHdvcmtpbmcgZGlyZWN0b3J5IHRvIGJvdHByZXNzJ3MgaW5zdGFsbGF0aW9uIHBhdGhcbiAgICAvLyB0aGUgYm90J3MgbG9jYXRpb24gaXMga2VwdCBpbiB0aGlzLnByb2plY3RMb2NhdGlvblxuICAgIHByb2Nlc3MuY2hkaXIocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLycpKVxuXG4gICAgY29uc3QgeyBwcm9qZWN0TG9jYXRpb24sIGJvdGZpbGUgfSA9IHRoaXNcblxuICAgIGNvbnN0IGlzRmlyc3RSdW4gPSBmcy5leGlzdHNTeW5jKHBhdGguam9pbihwcm9qZWN0TG9jYXRpb24sICcud2VsY29tZScpKVxuICAgIGNvbnN0IGRhdGFMb2NhdGlvbiA9IGdldERhdGFMb2NhdGlvbihib3RmaWxlLmRhdGFEaXIsIHByb2plY3RMb2NhdGlvbilcbiAgICBjb25zdCBtb2R1bGVzQ29uZmlnRGlyID0gZ2V0RGF0YUxvY2F0aW9uKGJvdGZpbGUubW9kdWxlc0NvbmZpZ0RpciwgcHJvamVjdExvY2F0aW9uKVxuICAgIGNvbnN0IGRiTG9jYXRpb24gPSBwYXRoLmpvaW4oZGF0YUxvY2F0aW9uLCAnZGIuc3FsaXRlJylcbiAgICBjb25zdCB2ZXJzaW9uID0gcGFja2FnZUpzb24udmVyc2lvblxuXG4gICAgY29uc3QgbG9nZ2VyID0gY3JlYXRlTG9nZ2VyKGRhdGFMb2NhdGlvbiwgYm90ZmlsZS5sb2cpXG4gICAgbWtkaXJJZk5lZWRlZChkYXRhTG9jYXRpb24sIGxvZ2dlcilcbiAgICBta2RpcklmTmVlZGVkKG1vZHVsZXNDb25maWdEaXIsIGxvZ2dlcilcblxuICAgIGxvZ2dlci5pbmZvKGBTdGFydGluZyBib3RwcmVzcyB2ZXJzaW9uICR7dmVyc2lvbn1gKVxuXG4gICAgY29uc3QgZGIgPSBjcmVhdGVEYXRhYmFzZSh7XG4gICAgICBzcWxpdGU6IHsgbG9jYXRpb246IGRiTG9jYXRpb24gfSxcbiAgICAgIHBvc3RncmVzOiBib3RmaWxlLnBvc3RncmVzXG4gICAgfSlcblxuICAgIGNvbnN0IHNlY3VyaXR5ID0gY3JlYXRlU2VjdXJpdHkoe1xuICAgICAgZGF0YUxvY2F0aW9uLFxuICAgICAgc2VjdXJpdHlDb25maWc6IGJvdGZpbGUubG9naW4sXG4gICAgICBkYlxuICAgIH0pXG5cbiAgICBjb25zdCBtb2R1bGVzID0gY3JlYXRlTW9kdWxlcyhsb2dnZXIsIHByb2plY3RMb2NhdGlvbiwgZGF0YUxvY2F0aW9uLCBkYi5rdnMpXG5cbiAgICBjb25zdCBtb2R1bGVEZWZpbml0aW9ucyA9IG1vZHVsZXMuX3NjYW4oKVxuXG4gICAgY29uc3QgZXZlbnRzID0gbmV3IEV2ZW50QnVzKClcblxuICAgIGNvbnN0IG5vdGlmaWNhdGlvbnMgPSBjcmVhdGVOb3RpZmljYXRpb25zKHsga25leDogYXdhaXQgZGIuZ2V0KCksIG1vZHVsZXM6IG1vZHVsZURlZmluaXRpb25zLCBsb2dnZXIsIGV2ZW50cyB9KVxuICAgIGNvbnN0IGFib3V0ID0gY3JlYXRlQWJvdXQocHJvamVjdExvY2F0aW9uKVxuICAgIGNvbnN0IGxpY2Vuc2luZyA9IGNyZWF0ZUxpY2Vuc2luZyh7IGxvZ2dlciwgcHJvamVjdExvY2F0aW9uLCB2ZXJzaW9uLCBkYiwgYm90ZmlsZSB9KVxuICAgIGNvbnN0IG1pZGRsZXdhcmVzID0gY3JlYXRlTWlkZGxld2FyZXModGhpcywgZGF0YUxvY2F0aW9uLCBwcm9qZWN0TG9jYXRpb24sIGxvZ2dlcilcbiAgICBjb25zdCB7IGhlYXIsIG1pZGRsZXdhcmU6IGhlYXJNaWRkbGV3YXJlIH0gPSBjcmVhdGVIZWFyTWlkZGxld2FyZSgpXG4gICAgY29uc3QgeyBtaWRkbGV3YXJlOiBmYWxsYmFja01pZGRsZXdhcmUgfSA9IGNyZWF0ZUZhbGxiYWNrTWlkZGxld2FyZSh0aGlzKVxuICAgIGNvbnN0IGVtYWlscyA9IGNyZWF0ZUVtYWlscyh7IGVtYWlsQ29uZmlnOiBib3RmaWxlLmVtYWlscyB9KVxuICAgIGNvbnN0IG1lZGlhdG9yID0gY3JlYXRlTWVkaWF0b3IodGhpcylcbiAgICBjb25zdCBjb252byA9IGNyZWF0ZUNvbnZlcnNhdGlvbnMoeyBsb2dnZXIsIG1pZGRsZXdhcmU6IG1pZGRsZXdhcmVzIH0pXG4gICAgY29uc3QgdXNlcnMgPSBjcmVhdGVVc2Vycyh7IGRiIH0pXG4gICAgY29uc3QgY29udGVudE1hbmFnZXIgPSBjcmVhdGVDb250ZW50TWFuYWdlcih7IGRiLCBsb2dnZXIsIHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSB9KVxuICAgIGNvbnN0IHVtbSA9IGNyZWF0ZVVNTSh7IGxvZ2dlciwgbWlkZGxld2FyZXMsIHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZSwgZGIsIGNvbnRlbnRNYW5hZ2VyIH0pXG5cbiAgICBtaWRkbGV3YXJlcy5yZWdpc3Rlcih1bW0uaW5jb21pbmdNaWRkbGV3YXJlKVxuICAgIG1pZGRsZXdhcmVzLnJlZ2lzdGVyKGhlYXJNaWRkbGV3YXJlKVxuICAgIG1pZGRsZXdhcmVzLnJlZ2lzdGVyKGZhbGxiYWNrTWlkZGxld2FyZSlcblxuICAgIF8uYXNzaWduKHRoaXMsIHtcbiAgICAgIGRhdGFMb2NhdGlvbixcbiAgICAgIGlzRmlyc3RSdW4sXG4gICAgICB2ZXJzaW9uLFxuICAgICAgbG9nZ2VyLFxuICAgICAgc2VjdXJpdHksIC8vIGxvZ2luLCBhdXRoZW50aWNhdGUsIGdldFNlY3JldFxuICAgICAgZXZlbnRzLFxuICAgICAgbm90aWZpY2F0aW9ucywgLy8gbG9hZCwgc2F2ZSwgc2VuZFxuICAgICAgYWJvdXQsXG4gICAgICBtaWRkbGV3YXJlcyxcbiAgICAgIGhlYXIsXG4gICAgICBsaWNlbnNpbmcsXG4gICAgICBtb2R1bGVzLFxuICAgICAgZGIsXG4gICAgICBlbWFpbHMsXG4gICAgICBtZWRpYXRvcixcbiAgICAgIGNvbnZvLFxuICAgICAgdW1tLFxuICAgICAgdXNlcnMsXG4gICAgICBjb250ZW50TWFuYWdlclxuICAgIH0pXG5cbiAgICBTZXJ2aWNlTG9jYXRvci5pbml0KHsgYnA6IHRoaXMgfSlcblxuICAgIGNvbnN0IGxvYWRlZE1vZHVsZXMgPSBtb2R1bGVzLl9sb2FkKG1vZHVsZURlZmluaXRpb25zLCB0aGlzKVxuXG4gICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ21vZHVsZXMnLCAnbG9hZGVkJywgbG9hZGVkTW9kdWxlcy5sZW5ndGgpXG5cbiAgICBfLmFzc2lnbih0aGlzLCB7XG4gICAgICBfbG9hZGVkTW9kdWxlczogbG9hZGVkTW9kdWxlc1xuICAgIH0pXG5cbiAgICBjb250ZW50TWFuYWdlci5zY2FuQW5kUmVnaXN0ZXJDYXRlZ29yaWVzKClcblxuICAgIG1lZGlhdG9yLmluc3RhbGwoKVxuICAgIG5vdGlmaWNhdGlvbnMuX2JpbmRFdmVudHMoKVxuXG4gICAgY29uc3Qgc2VydmVyID0gY3JlYXRlU2VydmVyKHRoaXMpXG4gICAgc2VydmVyLnN0YXJ0KCkudGhlbigoKSA9PiB7XG4gICAgICBldmVudHMuZW1pdCgncmVhZHknKVxuICAgICAgZm9yIChsZXQgbW9kIG9mIF8udmFsdWVzKGxvYWRlZE1vZHVsZXMpKSB7XG4gICAgICAgIG1vZC5oYW5kbGVycy5yZWFkeSAmJiBtb2QuaGFuZGxlcnMucmVhZHkodGhpcywgbW9kLmNvbmZpZ3VyYXRpb24pXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgcG9ydCB9ID0gYm90ZmlsZVxuICAgICAgbG9nZ2VyLmluZm8oY2hhbGsuZ3JlZW4uYm9sZCgnQm90IGxhdW5jaGVkLiBWaXNpdDogaHR0cDovL2xvY2FsaG9zdDonICsgcG9ydCkpXG4gICAgfSlcblxuICAgIGNvbnN0IG1pZGRsZXdhcmVBdXRvTG9hZGluZyA9IF8uZ2V0KGJvdGZpbGUsICdtaWRkbGV3YXJlLmF1dG9Mb2FkaW5nJylcbiAgICBpZiAoIV8uaXNOaWwobWlkZGxld2FyZUF1dG9Mb2FkaW5nKSAmJiBtaWRkbGV3YXJlQXV0b0xvYWRpbmcgPT09IGZhbHNlKSB7XG4gICAgICBsb2dnZXIuZGVidWcoJ01pZGRsZXdhcmUgQXV0byBMb2FkaW5nIHdhcyBkaXNhYmxlZC4gQ2FsbCBicC5taWRkbGV3YXJlcy5sb2FkKCkgbWFudWFsbHkuJylcbiAgICB9IGVsc2Uge1xuICAgICAgbWlkZGxld2FyZXMubG9hZCgpXG4gICAgfVxuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWV2YWxcbiAgICBjb25zdCBwcm9qZWN0RW50cnkgPSBldmFsKCdyZXF1aXJlJykocHJvamVjdExvY2F0aW9uKVxuICAgIGlmICh0eXBlb2YgcHJvamVjdEVudHJ5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBwcm9qZWN0RW50cnkuY2FsbChwcm9qZWN0RW50cnksIHRoaXMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZ2dlci5lcnJvcignW0ZBVEFMXSBUaGUgYm90IGVudHJ5IHBvaW50IG11c3QgYmUgYSBmdW5jdGlvbiB0aGF0IHRha2VzIGFuIGluc3RhbmNlIG9mIGJwJylcbiAgICAgIHByb2Nlc3MuZXhpdCgxKVxuICAgIH1cblxuICAgIHByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgZXJyID0+IHtcbiAgICAgIGxvZ2dlci5lcnJvcignW0ZBVEFMXSBBbiB1bmhhbmRsZWQgZXhjZXB0aW9uIG9jY3VycmVkIGluIHlvdXIgYm90JywgZXJyKVxuICAgICAgaWYgKGlzRGV2ZWxvcGluZykge1xuICAgICAgICBsb2dnZXIuZXJyb3IoZXJyLnN0YWNrKVxuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YXRzLnRyYWNrRXhjZXB0aW9uKGVyci5tZXNzYWdlKVxuICAgICAgcHJvY2Vzcy5leGl0KDEpXG4gICAgfSlcblxuICAgIHByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHApID0+IHtcbiAgICAgIGxvZ2dlci5lcnJvcignVW5oYW5kbGVkIFJlamVjdGlvbiBpbiBQcm9taXNlOiAnLCBwLCAnUmVhc29uOicsIHJlYXNvbilcblxuICAgICAgdGhpcy5zdGF0cy50cmFja0V4Y2VwdGlvbihyZWFzb24pXG4gICAgICBpZiAoaXNEZXZlbG9waW5nICYmIHJlYXNvbiAmJiByZWFzb24uc3RhY2spIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKHJlYXNvbi5zdGFjaylcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgc3RhcnQoKSB7XG4gICAgaWYgKGNsdXN0ZXIuaXNNYXN0ZXIpIHtcbiAgICAgIGxldCBmaXJzdFdvcmtlckhhc1N0YXJ0ZWRBbHJlYWR5ID0gZmFsc2VcbiAgICAgIGNvbnN0IHJlY2VpdmVNZXNzYWdlRnJvbVdvcmtlciA9IG1lc3NhZ2UgPT4ge1xuICAgICAgICBpZiAobWVzc2FnZSAmJiBtZXNzYWdlLndvcmtlclN0YXR1cyA9PT0gJ3N0YXJ0aW5nJykge1xuICAgICAgICAgIGlmICghZmlyc3RXb3JrZXJIYXNTdGFydGVkQWxyZWFkeSkge1xuICAgICAgICAgICAgZmlyc3RXb3JrZXJIYXNTdGFydGVkQWxyZWFkeSA9IHRydWVcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcHJpbnQoJ2luZm8nLCAnKioqIHJlc3RhcnRlZCB3b3JrZXIgcHJvY2VzcyAqKionKVxuICAgICAgICAgICAgdGhpcy5zdGF0cy50cmFjaygnYm90JywgJ3Jlc3RhcnRlZCcpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNsdXN0ZXIub24oJ2V4aXQnLCAod29ya2VyLCBjb2RlIC8qICwgc2lnbmFsICovKSA9PiB7XG4gICAgICAgIGlmIChjb2RlID09PSBSRVNUQVJUX0VYSVRfQ09ERSkge1xuICAgICAgICAgIGNsdXN0ZXIuZm9yaygpLm9uKCdtZXNzYWdlJywgcmVjZWl2ZU1lc3NhZ2VGcm9tV29ya2VyKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHByb2Nlc3MuZXhpdChjb2RlKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBjbHVzdGVyLmZvcmsoKS5vbignbWVzc2FnZScsIHJlY2VpdmVNZXNzYWdlRnJvbVdvcmtlcilcbiAgICB9XG5cbiAgICBpZiAoY2x1c3Rlci5pc1dvcmtlcikge1xuICAgICAgcHJvY2Vzcy5zZW5kKHsgd29ya2VyU3RhdHVzOiAnc3RhcnRpbmcnIH0pXG4gICAgICB0aGlzLl9zdGFydCgpXG4gICAgfVxuICB9XG5cbiAgcmVzdGFydChpbnRlcnZhbCA9IDApIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHByb2Nlc3MuZXhpdChSRVNUQVJUX0VYSVRfQ09ERSlcbiAgICB9LCBpbnRlcnZhbClcbiAgfVxuXG4gIF9zZXR1cEVudigpIHtcbiAgICBjb25zdCBlbnZQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMucHJvamVjdExvY2F0aW9uLCAnLmVudicpXG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoZW52UGF0aCkpIHtcbiAgICAgIGNvbnN0IGVudkNvbmZpZyA9IGRvdGVudi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoZW52UGF0aCkpXG4gICAgICBmb3IgKHZhciBrIGluIGVudkNvbmZpZykge1xuICAgICAgICBpZiAoXy5pc05pbChwcm9jZXNzLmVudltrXSkgfHwgcHJvY2Vzcy5lbnYuRU5WX09WRVJMT0FEKSB7XG4gICAgICAgICAgcHJvY2Vzcy5lbnZba10gPSBlbnZDb25maWdba11cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGJvdHByZXNzXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2JvdHByZXNzLmpzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7OztBQUNBO0FBQ0E7Ozs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUdBO0FBQ0E7Ozs7O0FBS0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFFQTtBQUVBOzs7QUFFQTtBQUNBOzs7QUFEQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQW5CQTtBQUNBO0FBcUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBckJBO0FBc0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///48\n");

/***/ }),
/* 49 */
/***/ (function(module, exports) {

eval("module.exports = require(\"source-map-support/register\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb3VyY2UtbWFwLXN1cHBvcnQvcmVnaXN0ZXJcIj9mODBiIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3RlclwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInNvdXJjZS1tYXAtc3VwcG9ydC9yZWdpc3RlclwiXG4vLyBtb2R1bGUgaWQgPSA0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///49\n");

/***/ }),
/* 50 */
/***/ (function(module, exports) {

eval("module.exports = require(\"cluster\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjbHVzdGVyXCI/YzAzYyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJjbHVzdGVyXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiY2x1c3RlclwiXG4vLyBtb2R1bGUgaWQgPSA1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///50\n");

/***/ }),
/* 51 */
/***/ (function(module, exports) {

eval("module.exports = require(\"dotenv\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJkb3RlbnZcIj8zODgwIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImRvdGVudlwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImRvdGVudlwiXG4vLyBtb2R1bGUgaWQgPSA1MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///51\n");

/***/ }),
/* 52 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function () {\n  var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref2) {\n    var bp = _ref2.bp;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL3NlcnZpY2VzLmpzPzcxYzEiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBhc3luYyAoeyBicCB9KSA9PiB7fVxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBleHRlbnNpb25zL2xpdGUvc2VydmljZXMuanMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///52\n");

/***/ }),
/* 53 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _eventemitter = __webpack_require__(24);\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar EventBus = function (_EventEmitter) {\n  _inherits(EventBus, _EventEmitter);\n\n  function EventBus() {\n    _classCallCheck(this, EventBus);\n\n    return _possibleConstructorReturn(this, (EventBus.__proto__ || Object.getPrototypeOf(EventBus)).call(this, {\n      wildcard: true,\n      maxListeners: 100\n    }));\n  }\n\n  return EventBus;\n}(_eventemitter2.default);\n\nmodule.exports = EventBus;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2J1cy5qcz9lYjI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFdmVudEVtaXR0ZXIyIGZyb20gJ2V2ZW50ZW1pdHRlcjInXG5cbmNsYXNzIEV2ZW50QnVzIGV4dGVuZHMgRXZlbnRFbWl0dGVyMiB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHtcbiAgICAgIHdpbGRjYXJkOiB0cnVlLFxuICAgICAgbWF4TGlzdGVuZXJzOiAxMDBcbiAgICB9KVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRCdXNcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvYnVzLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7Ozs7Ozs7Ozs7O0FBQ0E7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUZBO0FBSUE7QUFDQTs7OztBQUVBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///53\n");

/***/ }),
/* 54 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _mware = __webpack_require__(25);\n\nvar _mware2 = _interopRequireDefault(_mware);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _licensing = __webpack_require__(26);\n\nvar _licensing2 = _interopRequireDefault(_licensing);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar createMiddleware = function createMiddleware(bp, middlewareName) {\n  var _use = (0, _mware2.default)();\n  var _error = (0, _mware2.default)();\n\n  var use = function use(middleware) {\n    if (typeof middleware !== 'function') {\n      throw new TypeError('Expected all middleware arguments to be functions');\n    }\n\n    if (middleware.length === 2) {\n      _use(middleware);\n    } else if (middleware.length === 3) {\n      _error(middleware);\n    }\n  };\n\n  var dispatch = function dispatch(event) {\n    if (!_lodash2.default.isPlainObject(event)) {\n      throw new TypeError('Expected all dispatch arguments to be plain event objects');\n    }\n\n    var conformity = {\n      type: function type(value) {\n        return typeof value === 'string';\n      },\n      platform: function platform(value) {\n        return typeof value === 'string';\n      },\n      text: function text(value) {\n        return typeof value === 'string';\n      },\n      raw: function raw() {\n        return true;\n      }\n    };\n\n    if (!_lodash2.default.conformsTo(event, conformity)) {\n      throw new TypeError('Expected event to contain (type: string), ' + '(platform: string), (text: string), (raw: any)');\n    }\n\n    // Provide botpress to the event handlers\n    event.bp = bp;\n\n    _use.run(event, function (err) {\n      if (err) {\n        _error.run(err, event, function () {\n          bp.logger.error('[BOTPRESS] Unhandled error in middleware (' + middlewareName + '). Error: ' + err.message);\n        });\n      }\n    });\n\n    return event._promise || _bluebird2.default.resolve();\n  };\n\n  return { use: use, dispatch: dispatch };\n};\n\nmodule.exports = function (bp, dataLocation, projectLocation, logger) {\n  var middlewaresFilePath = _path2.default.join(dataLocation, 'middlewares.json');\n  var incoming = void 0,\n      outgoing = void 0,\n      middlewares = void 0,\n      customizations = void 0;\n\n  var noopChain = function noopChain() {\n    var message = 'Middleware called before middlewares have been loaded. This is a no-op.' + ' Have you forgotten to call `bp.loadMiddlewares()` in your bot?';\n\n    if (arguments && _typeof(arguments[0]) === 'object') {\n      message += '\\nCalled with: ' + JSON.stringify(arguments[0], null, 2);\n    }\n\n    logger.warn(message);\n  };\n\n  var readCustomizations = function readCustomizations() {\n    if (!_fs2.default.existsSync(middlewaresFilePath)) {\n      _fs2.default.writeFileSync(middlewaresFilePath, '{}');\n    }\n    return JSON.parse(_fs2.default.readFileSync(middlewaresFilePath));\n  };\n\n  var writeCustomizations = function writeCustomizations() {\n    _fs2.default.writeFileSync(middlewaresFilePath, JSON.stringify(customizations));\n  };\n\n  var setCustomizations = function setCustomizations(middlewares) {\n    _lodash2.default.each(middlewares, function (middleware) {\n      var name = middleware.name,\n          order = middleware.order,\n          enabled = middleware.enabled;\n\n      customizations[name] = { order: order, enabled: enabled };\n    });\n    writeCustomizations();\n  };\n\n  var resetCustomizations = function resetCustomizations() {\n    customizations = {};\n    writeCustomizations();\n  };\n\n  var register = function register(middleware) {\n    if (!middleware || !middleware.name) {\n      logger.error('A unique middleware name is mandatory');\n      return false;\n    }\n\n    if (!middleware.handler) {\n      logger.error('A middleware handler is mandatory');\n      return false;\n    }\n\n    if (!middleware.type || middleware.type !== 'incoming' && middleware.type !== 'outgoing') {\n      logger.error('A middleware type (incoming or outgoing) is required');\n      return false;\n    }\n\n    middleware.order = middleware.order || 0;\n    middleware.enabled = typeof middleware.enabled === 'undefined' ? true : !!middleware.enabled;\n\n    if (_lodash2.default.some(middlewares, function (m) {\n      return m.name === middleware.name;\n    })) {\n      logger.error('Another middleware with the same name has already been registered');\n      return false;\n    }\n\n    middlewares.push(middleware);\n  };\n\n  var list = function list() {\n    return _lodash2.default.orderBy(middlewares.map(function (middleware) {\n      var customization = customizations[middleware.name];\n      if (customization) {\n        return Object.assign({}, middleware, customization);\n      }\n      return middleware;\n    }), 'order');\n  };\n\n  var load = function load() {\n    incoming = createMiddleware(bp, 'incoming');\n    outgoing = createMiddleware(bp, 'outgoing');\n\n    var licenseMiddleware = bp.licensing.middleware;\n\n    incoming.use(licenseMiddleware);\n\n    _lodash2.default.each(list(), function (m) {\n      if (!m.enabled) {\n        return logger.debug('SKIPPING middleware:', m.name, ' [Reason=disabled]');\n      }\n\n      logger.debug('Loading middleware:', m.name);\n\n      if (m.type === 'incoming') {\n        incoming.use(m.handler);\n      } else {\n        outgoing.use(m.handler);\n      }\n    });\n  };\n\n  var sendToMiddleware = function sendToMiddleware(type) {\n    return function (event) {\n      var mw = type === 'incoming' ? incoming : outgoing;\n      return mw.dispatch ? mw.dispatch(event) : mw(event);\n    };\n  };\n\n  var sendIncoming = sendToMiddleware('incoming');\n  var sendOutgoing = sendToMiddleware('outgoing');\n\n  incoming = outgoing = noopChain;\n  middlewares = [];\n  customizations = readCustomizations();\n\n  return {\n    load: load,\n    list: list,\n    register: register,\n    sendIncoming: sendIncoming,\n    sendOutgoing: sendOutgoing,\n    getCustomizations: function getCustomizations() {\n      return customizations;\n    },\n    setCustomizations: setCustomizations,\n    resetCustomizations: resetCustomizations\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL21pZGRsZXdhcmVzLmpzP2E2M2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IG13YXJlIGZyb20gJ213YXJlJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuXG5pbXBvcnQgbGljZW5zaW5nIGZyb20gJy4vbGljZW5zaW5nJ1xuXG5jb25zdCBjcmVhdGVNaWRkbGV3YXJlID0gZnVuY3Rpb24oYnAsIG1pZGRsZXdhcmVOYW1lKSB7XG4gIGNvbnN0IF91c2UgPSBtd2FyZSgpXG4gIGNvbnN0IF9lcnJvciA9IG13YXJlKClcblxuICBjb25zdCB1c2UgPSBmdW5jdGlvbihtaWRkbGV3YXJlKSB7XG4gICAgaWYgKHR5cGVvZihtaWRkbGV3YXJlKSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgYWxsIG1pZGRsZXdhcmUgYXJndW1lbnRzIHRvIGJlIGZ1bmN0aW9ucycpXG4gICAgfVxuXG4gICAgaWYgKG1pZGRsZXdhcmUubGVuZ3RoID09PSAyKSB7XG4gICAgICBfdXNlKG1pZGRsZXdhcmUpXG4gICAgfSBlbHNlIGlmIChtaWRkbGV3YXJlLmxlbmd0aCA9PT0gMykge1xuICAgICAgX2Vycm9yKG1pZGRsZXdhcmUpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgZGlzcGF0Y2ggPSBmdW5jdGlvbihldmVudCkge1xuICAgIGlmICghXy5pc1BsYWluT2JqZWN0KGV2ZW50KSkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRXhwZWN0ZWQgYWxsIGRpc3BhdGNoIGFyZ3VtZW50cyB0byBiZSBwbGFpbiBldmVudCBvYmplY3RzJylcbiAgICB9XG5cbiAgICBjb25zdCBjb25mb3JtaXR5ID0ge1xuICAgICAgdHlwZTogZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHR5cGVvZih2YWx1ZSkgPT09ICdzdHJpbmcnIH0sXG4gICAgICBwbGF0Zm9ybTogZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIHR5cGVvZih2YWx1ZSkgPT09ICdzdHJpbmcnIH0sXG4gICAgICB0ZXh0OiBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdHlwZW9mKHZhbHVlKSA9PT0gJ3N0cmluZycgfSxcbiAgICAgIHJhdzogZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlIH1cbiAgICB9XG5cbiAgICBpZiAoIV8uY29uZm9ybXNUbyhldmVudCwgY29uZm9ybWl0eSkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGV2ZW50IHRvIGNvbnRhaW4gKHR5cGU6IHN0cmluZyksICcgK1xuICAgICAgICAnKHBsYXRmb3JtOiBzdHJpbmcpLCAodGV4dDogc3RyaW5nKSwgKHJhdzogYW55KScpXG4gICAgfVxuXG4gICAgLy8gUHJvdmlkZSBib3RwcmVzcyB0byB0aGUgZXZlbnQgaGFuZGxlcnNcbiAgICBldmVudC5icCA9IGJwXG5cbiAgICBfdXNlLnJ1bihldmVudCwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIF9lcnJvci5ydW4oZXJyLCBldmVudCwgKCkgPT4ge1xuICAgICAgICAgIGJwLmxvZ2dlci5lcnJvcihgW0JPVFBSRVNTXSBVbmhhbmRsZWQgZXJyb3IgaW4gbWlkZGxld2FyZSAoJHttaWRkbGV3YXJlTmFtZX0pLiBFcnJvcjogJHtlcnIubWVzc2FnZX1gKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gZXZlbnQuX3Byb21pc2UgfHwgUHJvbWlzZS5yZXNvbHZlKClcbiAgfVxuXG4gIHJldHVybiB7IHVzZSwgZGlzcGF0Y2ggfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJwLCBkYXRhTG9jYXRpb24sIHByb2plY3RMb2NhdGlvbiwgbG9nZ2VyKSB7XG4gIGNvbnN0IG1pZGRsZXdhcmVzRmlsZVBhdGggPSBwYXRoLmpvaW4oZGF0YUxvY2F0aW9uLCAnbWlkZGxld2FyZXMuanNvbicpXG4gIGxldCBpbmNvbWluZywgb3V0Z29pbmcsIG1pZGRsZXdhcmVzLCBjdXN0b21pemF0aW9uc1xuXG4gIGNvbnN0IG5vb3BDaGFpbiA9IGZ1bmN0aW9uKCkge1xuICAgIGxldCBtZXNzYWdlID0gJ01pZGRsZXdhcmUgY2FsbGVkIGJlZm9yZSBtaWRkbGV3YXJlcyBoYXZlIGJlZW4gbG9hZGVkLiBUaGlzIGlzIGEgbm8tb3AuJ1xuICAgICArICcgSGF2ZSB5b3UgZm9yZ290dGVuIHRvIGNhbGwgYGJwLmxvYWRNaWRkbGV3YXJlcygpYCBpbiB5b3VyIGJvdD8nXG5cbiAgICBpZiAoYXJndW1lbnRzICYmIHR5cGVvZihhcmd1bWVudHNbMF0pID09PSAnb2JqZWN0Jykge1xuICAgICAgbWVzc2FnZSArPSAnXFxuQ2FsbGVkIHdpdGg6ICcgKyBKU09OLnN0cmluZ2lmeShhcmd1bWVudHNbMF0sIG51bGwsIDIpXG4gICAgfVxuXG4gICAgbG9nZ2VyLndhcm4obWVzc2FnZSlcbiAgfVxuXG4gIGNvbnN0IHJlYWRDdXN0b21pemF0aW9ucyA9ICgpID0+IHtcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMobWlkZGxld2FyZXNGaWxlUGF0aCkpIHtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMobWlkZGxld2FyZXNGaWxlUGF0aCwgJ3t9JylcbiAgICB9XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKG1pZGRsZXdhcmVzRmlsZVBhdGgpKVxuICB9XG5cbiAgY29uc3Qgd3JpdGVDdXN0b21pemF0aW9ucyA9ICgpID0+IHtcbiAgICBmcy53cml0ZUZpbGVTeW5jKG1pZGRsZXdhcmVzRmlsZVBhdGgsIEpTT04uc3RyaW5naWZ5KGN1c3RvbWl6YXRpb25zKSlcbiAgfVxuXG4gIGNvbnN0IHNldEN1c3RvbWl6YXRpb25zID0gbWlkZGxld2FyZXMgPT4ge1xuICAgIF8uZWFjaChtaWRkbGV3YXJlcywgKG1pZGRsZXdhcmUgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lLCBvcmRlciwgZW5hYmxlZCB9ID0gbWlkZGxld2FyZVxuICAgICAgY3VzdG9taXphdGlvbnNbbmFtZV0gPSB7IG9yZGVyLCBlbmFibGVkIH1cbiAgICB9KSlcbiAgICB3cml0ZUN1c3RvbWl6YXRpb25zKClcbiAgfVxuXG4gIGNvbnN0IHJlc2V0Q3VzdG9taXphdGlvbnMgPSAoKSA9PiB7XG4gICAgY3VzdG9taXphdGlvbnMgPSB7fVxuICAgIHdyaXRlQ3VzdG9taXphdGlvbnMoKVxuICB9XG5cbiAgY29uc3QgcmVnaXN0ZXIgPSAobWlkZGxld2FyZSkgPT4ge1xuICAgIGlmICghbWlkZGxld2FyZSB8fCAhbWlkZGxld2FyZS5uYW1lKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0EgdW5pcXVlIG1pZGRsZXdhcmUgbmFtZSBpcyBtYW5kYXRvcnknKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgaWYgKCFtaWRkbGV3YXJlLmhhbmRsZXIpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignQSBtaWRkbGV3YXJlIGhhbmRsZXIgaXMgbWFuZGF0b3J5JylcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGlmICghbWlkZGxld2FyZS50eXBlIHx8IChtaWRkbGV3YXJlLnR5cGUgIT09ICdpbmNvbWluZycgJiYgbWlkZGxld2FyZS50eXBlICE9PSAnb3V0Z29pbmcnKSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdBIG1pZGRsZXdhcmUgdHlwZSAoaW5jb21pbmcgb3Igb3V0Z29pbmcpIGlzIHJlcXVpcmVkJylcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIG1pZGRsZXdhcmUub3JkZXIgPSBtaWRkbGV3YXJlLm9yZGVyIHx8IDBcbiAgICBtaWRkbGV3YXJlLmVuYWJsZWQgPSB0eXBlb2YgbWlkZGxld2FyZS5lbmFibGVkID09PSAndW5kZWZpbmVkJyA/IHRydWU6ICEhbWlkZGxld2FyZS5lbmFibGVkXG5cbiAgICBpZiAoXy5zb21lKG1pZGRsZXdhcmVzLCBtID0+IG0ubmFtZSA9PT0gbWlkZGxld2FyZS5uYW1lKSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdBbm90aGVyIG1pZGRsZXdhcmUgd2l0aCB0aGUgc2FtZSBuYW1lIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZCcpXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBtaWRkbGV3YXJlcy5wdXNoKG1pZGRsZXdhcmUpXG4gIH1cblxuICBjb25zdCBsaXN0ID0gKCkgPT4ge1xuICAgIHJldHVybiBfLm9yZGVyQnkobWlkZGxld2FyZXMubWFwKG1pZGRsZXdhcmUgPT4ge1xuICAgICAgY29uc3QgY3VzdG9taXphdGlvbiA9IGN1c3RvbWl6YXRpb25zW21pZGRsZXdhcmUubmFtZV1cbiAgICAgIGlmIChjdXN0b21pemF0aW9uKSB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBtaWRkbGV3YXJlLCBjdXN0b21pemF0aW9uKVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1pZGRsZXdhcmVcbiAgICB9KSwgJ29yZGVyJylcbiAgfVxuXG4gIGNvbnN0IGxvYWQgPSAoKSA9PiB7XG4gICAgaW5jb21pbmcgPSBjcmVhdGVNaWRkbGV3YXJlKGJwLCAnaW5jb21pbmcnKVxuICAgIG91dGdvaW5nID0gY3JlYXRlTWlkZGxld2FyZShicCwgJ291dGdvaW5nJylcblxuICAgIGNvbnN0IHsgbWlkZGxld2FyZTogbGljZW5zZU1pZGRsZXdhcmUgfSA9IGJwLmxpY2Vuc2luZ1xuICAgIGluY29taW5nLnVzZShsaWNlbnNlTWlkZGxld2FyZSlcblxuICAgIF8uZWFjaChsaXN0KCksIChtID0+IHtcbiAgICAgIGlmICghbS5lbmFibGVkKSB7XG4gICAgICAgIHJldHVybiBsb2dnZXIuZGVidWcoJ1NLSVBQSU5HIG1pZGRsZXdhcmU6JywgbS5uYW1lLCAnIFtSZWFzb249ZGlzYWJsZWRdJylcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmRlYnVnKCdMb2FkaW5nIG1pZGRsZXdhcmU6JywgbS5uYW1lKVxuXG4gICAgICBpZiAobS50eXBlID09PSAnaW5jb21pbmcnKSB7XG4gICAgICAgIGluY29taW5nLnVzZShtLmhhbmRsZXIpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvdXRnb2luZy51c2UobS5oYW5kbGVyKVxuICAgICAgfVxuICAgIH0pKVxuICB9XG5cbiAgY29uc3Qgc2VuZFRvTWlkZGxld2FyZSA9IHR5cGUgPT4gZXZlbnQgPT4ge1xuICAgIGxldCBtdyA9IHR5cGUgPT09ICdpbmNvbWluZycgPyBpbmNvbWluZyA6IG91dGdvaW5nXG4gICAgcmV0dXJuIG13LmRpc3BhdGNoID8gbXcuZGlzcGF0Y2goZXZlbnQpIDogbXcoZXZlbnQpXG4gIH1cblxuICBjb25zdCBzZW5kSW5jb21pbmcgPSBzZW5kVG9NaWRkbGV3YXJlKCdpbmNvbWluZycpXG4gIGNvbnN0IHNlbmRPdXRnb2luZyA9IHNlbmRUb01pZGRsZXdhcmUoJ291dGdvaW5nJylcblxuICBpbmNvbWluZyA9IG91dGdvaW5nID0gbm9vcENoYWluXG4gIG1pZGRsZXdhcmVzID0gW11cbiAgY3VzdG9taXphdGlvbnMgPSByZWFkQ3VzdG9taXphdGlvbnMoKVxuXG4gIHJldHVybiB7XG4gICAgbG9hZCxcbiAgICBsaXN0LFxuICAgIHJlZ2lzdGVyLFxuICAgIHNlbmRJbmNvbWluZyxcbiAgICBzZW5kT3V0Z29pbmcsXG4gICAgZ2V0Q3VzdG9taXphdGlvbnM6ICgpID0+IGN1c3RvbWl6YXRpb25zLFxuICAgIHNldEN1c3RvbWl6YXRpb25zLFxuICAgIHJlc2V0Q3VzdG9taXphdGlvbnNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9taWRkbGV3YXJlcy5qcyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFKQTtBQUNBO0FBTUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQVJBO0FBVUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///54\n");

/***/ }),
/* 55 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (logger, db, botfile) {\n  return {\n    // There is no License Guard in the Open-Source / Free version\n    start: function start() {},\n    getStatus: function () {\n      var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt('return', {\n                  licensed: true,\n                  name: 'Botpress Community',\n                  text: null,\n                  status: 'Active'\n                });\n\n              case 1:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function getStatus() {\n        return _ref.apply(this, arguments);\n      };\n    }(),\n    getFeatures: function getFeatures() {\n      return {};\n    }\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2xpY2Vuc2UvaW5kZXguanM/ZmRiOSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IChsb2dnZXIsIGRiLCBib3RmaWxlKSA9PiAoe1xuICAvLyBUaGVyZSBpcyBubyBMaWNlbnNlIEd1YXJkIGluIHRoZSBPcGVuLVNvdXJjZSAvIEZyZWUgdmVyc2lvblxuICBzdGFydDogKCkgPT4ge30sXG4gIGdldFN0YXR1czogYXN5bmMgKCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBsaWNlbnNlZDogdHJ1ZSxcbiAgICAgIG5hbWU6ICdCb3RwcmVzcyBDb21tdW5pdHknLFxuICAgICAgdGV4dDogbnVsbCxcbiAgICAgIHN0YXR1czogJ0FjdGl2ZSdcbiAgICB9XG4gIH0sXG4gIGdldEZlYXR1cmVzOiAoKSA9PiAoe30pXG59KVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGV4dGVuc2lvbnMvbGl0ZS9saWNlbnNlL2luZGV4LmpzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQVFBO0FBQUE7QUFBQTtBQVhBO0FBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///55\n");

/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _winston = __webpack_require__(57);\n\nvar _winston2 = _interopRequireDefault(_winston);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _moment = __webpack_require__(8);\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (dataLocation, logConfig) {\n  var logger = new _winston2.default.Logger({\n    level: _util.isDeveloping ? 'debug' : 'info',\n    transports: [new _winston2.default.transports.Console({\n      prettyPrint: true,\n      colorize: true,\n      timestamp: function timestamp() {\n        return (0, _moment2.default)().format('HH:mm:ss');\n      }\n    })]\n  });\n\n  logger.enableFileTransport = function () {\n    var logFile = _path2.default.join(dataLocation, logConfig.file);\n    logger.add(_winston2.default.transports.File, {\n      filename: logFile,\n      maxsize: logConfig.maxSize\n    });\n  };\n\n  logger.archiveToFile = function () {\n    var logFile = _path2.default.join(dataLocation, logConfig.file);\n\n    return _bluebird2.default.resolve(logFile);\n  };\n\n  if (!logConfig.disableFileLogs) {\n    logger.enableFileTransport();\n  }\n\n  return logger;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2xvZ2dlci5qcz81Njc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB3aW5zdG9uIGZyb20gJ3dpbnN0b24nXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCdcblxuaW1wb3J0IHsgaXNEZXZlbG9waW5nIH0gZnJvbSAnLi91dGlsJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IChkYXRhTG9jYXRpb24sIGxvZ0NvbmZpZykgPT4ge1xuICBjb25zdCBsb2dnZXIgPSBuZXcgd2luc3Rvbi5Mb2dnZXIoe1xuICAgIGxldmVsOiBpc0RldmVsb3BpbmcgPyAnZGVidWcnIDogJ2luZm8nLFxuICAgIHRyYW5zcG9ydHM6IFtcbiAgICAgIG5ldyAod2luc3Rvbi50cmFuc3BvcnRzLkNvbnNvbGUpKHtcbiAgICAgICAgcHJldHR5UHJpbnQ6IHRydWUsXG4gICAgICAgIGNvbG9yaXplOiB0cnVlLFxuICAgICAgICB0aW1lc3RhbXA6ICgpID0+IG1vbWVudCgpLmZvcm1hdCgnSEg6bW06c3MnKVxuICAgICAgfSlcbiAgICBdXG4gIH0pXG5cbiAgbG9nZ2VyLmVuYWJsZUZpbGVUcmFuc3BvcnQgPSAoKSA9PiB7XG4gICAgY29uc3QgbG9nRmlsZSA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sIGxvZ0NvbmZpZy5maWxlKVxuICAgIGxvZ2dlci5hZGQod2luc3Rvbi50cmFuc3BvcnRzLkZpbGUsIHtcbiAgICAgIGZpbGVuYW1lOiBsb2dGaWxlLFxuICAgICAgbWF4c2l6ZTogbG9nQ29uZmlnLm1heFNpemVcbiAgICB9KVxuICB9XG5cbiAgbG9nZ2VyLmFyY2hpdmVUb0ZpbGUgPSAoKSA9PiB7XG4gICAgY29uc3QgbG9nRmlsZSA9IHBhdGguam9pbihkYXRhTG9jYXRpb24sIGxvZ0NvbmZpZy5maWxlKVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsb2dGaWxlKVxuICB9XG5cbiAgaWYgKCFsb2dDb25maWcuZGlzYWJsZUZpbGVMb2dzKSB7XG4gICAgbG9nZ2VyLmVuYWJsZUZpbGVUcmFuc3BvcnQoKVxuICB9XG5cbiAgcmV0dXJuIGxvZ2dlclxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9sb2dnZXIuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBSEE7QUFIQTtBQUNBO0FBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///56\n");

/***/ }),
/* 57 */
/***/ (function(module, exports) {

eval("module.exports = require(\"winston\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ3aW5zdG9uXCI/MDI1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJ3aW5zdG9uXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwid2luc3RvblwiXG4vLyBtb2R1bGUgaWQgPSA1N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///57\n");

/***/ }),
/* 58 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _jsonwebtoken = __webpack_require__(59);\n\nvar _jsonwebtoken2 = _interopRequireDefault(_jsonwebtoken);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _authentication = __webpack_require__(60);\n\nvar _authentication2 = _interopRequireDefault(_authentication);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\n/**\n * Security helper for botpress\n *\n * Constructor of following functions\n *\n *   - login(user, password, ip)\n *   - authenticate(token)\n *   - getSecret()\n *\n * It will find or create a secret.key in `dataLocation`, then setup the adminPassword for user login.\n *\n */\n\nmodule.exports = function (_ref) {\n  var dataLocation = _ref.dataLocation,\n      securityConfig = _ref.securityConfig,\n      db = _ref.db;\n\n\n  var authentication = (0, _authentication2.default)({ dataLocation: dataLocation, securityConfig: securityConfig, db: db });\n  var tokenExpiry = securityConfig.tokenExpiry;\n\n  // login function that returns a {success, reason, token} object\n  // accounts for number of bad attempts\n\n  var login = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee(user, password) {\n      var ip = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'all';\n      var canAttempt, loginUser, secret;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return authentication.attempt(ip);\n\n            case 2:\n              canAttempt = _context.sent;\n\n              if (canAttempt) {\n                _context.next = 5;\n                break;\n              }\n\n              return _context.abrupt('return', { success: false, reason: 'Too many login attempts. Try again later.' });\n\n            case 5:\n              _context.next = 7;\n              return authentication.authenticate(user, password, ip);\n\n            case 7:\n              loginUser = _context.sent;\n\n              if (!loginUser) {\n                _context.next = 15;\n                break;\n              }\n\n              _context.next = 11;\n              return authentication.getSecret();\n\n            case 11:\n              secret = _context.sent;\n              return _context.abrupt('return', {\n                success: true,\n                token: _jsonwebtoken2.default.sign({ user: loginUser }, secret, { expiresIn: tokenExpiry })\n              });\n\n            case 15:\n              return _context.abrupt('return', {\n                success: false,\n                reason: 'Bad username / password'\n              });\n\n            case 16:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function login(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * @param {string} token\n   * @return {boolean} whether the token is valid\n   */\n  var authenticate = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(token) {\n      var secret, decoded, verified;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return authentication.getSecret();\n\n            case 3:\n              secret = _context2.sent;\n              decoded = _jsonwebtoken2.default.verify(token, secret);\n\n              if (!authentication.verifyUser) {\n                _context2.next = 11;\n                break;\n              }\n\n              _context2.next = 8;\n              return authentication.verifyUser(decoded);\n\n            case 8:\n              _context2.t0 = _context2.sent;\n              _context2.next = 12;\n              break;\n\n            case 11:\n              _context2.t0 = true;\n\n            case 12:\n              verified = _context2.t0;\n              return _context2.abrupt('return', verified && decoded.user);\n\n            case 16:\n              _context2.prev = 16;\n              _context2.t1 = _context2['catch'](0);\n              return _context2.abrupt('return', false);\n\n            case 19:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this, [[0, 16]]);\n    }));\n\n    return function authenticate(_x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return {\n    login: login,\n    authenticate: authenticate,\n    getSecret: authentication.getSecret,\n    _authentication: authentication\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlY3VyaXR5L2luZGV4LmpzP2I0MzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5cbmltcG9ydCBBdXRoZW50aWNhdGlvbiBmcm9tICcrL2F1dGhlbnRpY2F0aW9uJ1xuXG4vKipcbiAqIFNlY3VyaXR5IGhlbHBlciBmb3IgYm90cHJlc3NcbiAqXG4gKiBDb25zdHJ1Y3RvciBvZiBmb2xsb3dpbmcgZnVuY3Rpb25zXG4gKlxuICogICAtIGxvZ2luKHVzZXIsIHBhc3N3b3JkLCBpcClcbiAqICAgLSBhdXRoZW50aWNhdGUodG9rZW4pXG4gKiAgIC0gZ2V0U2VjcmV0KClcbiAqXG4gKiBJdCB3aWxsIGZpbmQgb3IgY3JlYXRlIGEgc2VjcmV0LmtleSBpbiBgZGF0YUxvY2F0aW9uYCwgdGhlbiBzZXR1cCB0aGUgYWRtaW5QYXNzd29yZCBmb3IgdXNlciBsb2dpbi5cbiAqXG4gKi9cblxubW9kdWxlLmV4cG9ydHMgPSAoeyBkYXRhTG9jYXRpb24sIHNlY3VyaXR5Q29uZmlnLCBkYiB9KSA9PiB7XG5cbiAgY29uc3QgYXV0aGVudGljYXRpb24gPSBBdXRoZW50aWNhdGlvbih7IGRhdGFMb2NhdGlvbiwgc2VjdXJpdHlDb25maWcsIGRiIH0pXG4gIGNvbnN0IHsgdG9rZW5FeHBpcnkgfSA9IHNlY3VyaXR5Q29uZmlnXG5cbiAgLy8gbG9naW4gZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEge3N1Y2Nlc3MsIHJlYXNvbiwgdG9rZW59IG9iamVjdFxuICAvLyBhY2NvdW50cyBmb3IgbnVtYmVyIG9mIGJhZCBhdHRlbXB0c1xuICBjb25zdCBsb2dpbiA9IGFzeW5jIGZ1bmN0aW9uKHVzZXIsIHBhc3N3b3JkLCBpcCA9ICdhbGwnKSB7XG4gICAgY29uc3QgY2FuQXR0ZW1wdCA9IGF3YWl0IGF1dGhlbnRpY2F0aW9uLmF0dGVtcHQoaXApXG4gICAgaWYgKCFjYW5BdHRlbXB0KSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgcmVhc29uOiAnVG9vIG1hbnkgbG9naW4gYXR0ZW1wdHMuIFRyeSBhZ2FpbiBsYXRlci4nIH1cbiAgICB9XG5cbiAgICBjb25zdCBsb2dpblVzZXIgPSBhd2FpdCBhdXRoZW50aWNhdGlvbi5hdXRoZW50aWNhdGUodXNlciwgcGFzc3dvcmQsIGlwKVxuXG4gICAgaWYgKGxvZ2luVXNlcikge1xuICAgICAgY29uc3Qgc2VjcmV0ID0gYXdhaXQgYXV0aGVudGljYXRpb24uZ2V0U2VjcmV0KClcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgdG9rZW46IGp3dC5zaWduKHsgdXNlcjogbG9naW5Vc2VyIH0sIHNlY3JldCwgeyBleHBpcmVzSW46IHRva2VuRXhwaXJ5IH0pXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICByZWFzb246ICdCYWQgdXNlcm5hbWUgLyBwYXNzd29yZCdcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRva2VuXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59IHdoZXRoZXIgdGhlIHRva2VuIGlzIHZhbGlkXG4gICAqL1xuICBjb25zdCBhdXRoZW50aWNhdGUgPSBhc3luYyBmdW5jdGlvbih0b2tlbikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWNyZXQgPSBhd2FpdCBhdXRoZW50aWNhdGlvbi5nZXRTZWNyZXQoKVxuICAgICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHNlY3JldClcbiAgICAgIGNvbnN0IHZlcmlmaWVkID0gYXV0aGVudGljYXRpb24udmVyaWZ5VXNlclxuICAgICAgICA/IGF3YWl0IGF1dGhlbnRpY2F0aW9uLnZlcmlmeVVzZXIoZGVjb2RlZClcbiAgICAgICAgOiB0cnVlXG4gICAgICByZXR1cm4gdmVyaWZpZWQgJiYgZGVjb2RlZC51c2VyXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGxvZ2luLFxuICAgIGF1dGhlbnRpY2F0ZSxcbiAgICBnZXRTZWNyZXQ6IGF1dGhlbnRpY2F0aW9uLmdldFNlY3JldCxcbiAgICBfYXV0aGVudGljYXRpb246IGF1dGhlbnRpY2F0aW9uXG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvc2VjdXJpdHkvaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7Ozs7OztBQUNBOzs7Ozs7Ozs7Ozs7O0FBYUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFGQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQU1BO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFTQTtBQVRBO0FBWUE7QUFDQTtBQUZBO0FBQ0E7QUFaQTtBQUFBO0FBaUJBO0FBQ0E7QUFGQTtBQUNBO0FBakJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBc0JBOzs7O0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBRUE7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUlBO0FBSkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///58\n");

/***/ }),
/* 59 */
/***/ (function(module, exports) {

eval("module.exports = require(\"jsonwebtoken\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNTkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJqc29ud2VidG9rZW5cIj82N2ZhIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImpzb253ZWJ0b2tlblwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcImpzb253ZWJ0b2tlblwiXG4vLyBtb2R1bGUgaWQgPSA1OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///59\n");

/***/ }),
/* 60 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _crypto = __webpack_require__(18);\n\nvar _crypto2 = _interopRequireDefault(_crypto);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (_ref) {\n  var dataLocation = _ref.dataLocation,\n      securityConfig = _ref.securityConfig;\n\n\n  // reading secret from data or creating new secret\n  var secret = '';\n  var secretPath = _path2.default.join(dataLocation, 'secret.key');\n\n  var createNewSecret = function createNewSecret() {\n    secret = _crypto2.default.randomBytes(256).toString();\n    _fs2.default.writeFileSync(secretPath, secret);\n    return secret;\n  };\n\n  if (_fs2.default.existsSync(secretPath)) {\n    secret = _fs2.default.readFileSync(secretPath);\n  }\n\n  if (!secret || secret.length < 15) {\n    secret = createNewSecret();\n  }\n\n  var adminPassword = process.env.BOTPRESS_ADMIN_PASSWORD || securityConfig.password;\n\n  // a per-ip cache that logs login attempts\n  var attempts = {};\n  var lastCleanTimestamp = new Date();\n  var maxAttempts = securityConfig.maxAttempts,\n      resetAfter = securityConfig.resetAfter;\n\n\n  function attempt(ip) {\n    // reset the cache if time elapsed\n    if (new Date() - lastCleanTimestamp >= resetAfter) {\n      attempts = {};\n      lastCleanTimestamp = new Date();\n    }\n\n    return (attempts[ip] || 0) < maxAttempts;\n  }\n\n  function authenticate(user, password, ip) {\n    if (typeof user === 'string' && user.toLowerCase() === 'admin' && typeof password === 'string' && password === adminPassword) {\n      attempts[ip] = 0;\n      return {\n        id: 0,\n        email: 'admin@botpress.io',\n        first_name: 'Admin',\n        last_name: 'Admin',\n        avatar_url: null,\n        roles: ['admin']\n      };\n    } else {\n      attempts[ip] = (attempts[ip] || 0) + 1;\n      return null;\n    }\n  }\n\n  function getSecret() {\n    return secret;\n  }\n\n  function resetSecret() {\n    return createNewSecret();\n  }\n\n  // Public API\n  return {\n    attempt: _bluebird2.default.method(attempt),\n    authenticate: _bluebird2.default.method(authenticate),\n    getSecret: _bluebird2.default.method(getSecret),\n    resetSecret: _bluebird2.default.method(resetSecret)\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2F1dGhlbnRpY2F0aW9uL2luZGV4LmpzP2RjNzAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJ1xuaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5cbm1vZHVsZS5leHBvcnRzID0gKHsgZGF0YUxvY2F0aW9uLCBzZWN1cml0eUNvbmZpZyB9KSA9PiB7XG5cbiAgLy8gcmVhZGluZyBzZWNyZXQgZnJvbSBkYXRhIG9yIGNyZWF0aW5nIG5ldyBzZWNyZXRcbiAgbGV0IHNlY3JldCA9ICcnXG4gIGNvbnN0IHNlY3JldFBhdGggPSBwYXRoLmpvaW4oZGF0YUxvY2F0aW9uLCAnc2VjcmV0LmtleScpXG5cbiAgY29uc3QgY3JlYXRlTmV3U2VjcmV0ID0gKCkgPT4ge1xuICAgIHNlY3JldCA9IGNyeXB0by5yYW5kb21CeXRlcygyNTYpLnRvU3RyaW5nKClcbiAgICBmcy53cml0ZUZpbGVTeW5jKHNlY3JldFBhdGgsIHNlY3JldClcbiAgICByZXR1cm4gc2VjcmV0XG4gIH1cblxuICBpZiAoZnMuZXhpc3RzU3luYyhzZWNyZXRQYXRoKSkge1xuICAgIHNlY3JldCA9IGZzLnJlYWRGaWxlU3luYyhzZWNyZXRQYXRoKVxuICB9XG5cbiAgaWYgKCFzZWNyZXQgfHwgc2VjcmV0Lmxlbmd0aCA8IDE1KSB7XG4gICAgc2VjcmV0ID0gY3JlYXRlTmV3U2VjcmV0KClcbiAgfVxuXG4gIGNvbnN0IGFkbWluUGFzc3dvcmQgPSBwcm9jZXNzLmVudi5CT1RQUkVTU19BRE1JTl9QQVNTV09SRCB8fCBzZWN1cml0eUNvbmZpZy5wYXNzd29yZFxuXG4gIC8vIGEgcGVyLWlwIGNhY2hlIHRoYXQgbG9ncyBsb2dpbiBhdHRlbXB0c1xuICBsZXQgYXR0ZW1wdHMgPSB7fVxuICBsZXQgbGFzdENsZWFuVGltZXN0YW1wID0gbmV3IERhdGUoKVxuICBjb25zdCB7IG1heEF0dGVtcHRzLCByZXNldEFmdGVyIH0gPSBzZWN1cml0eUNvbmZpZ1xuXG4gIGZ1bmN0aW9uIGF0dGVtcHQoaXApIHtcbiAgICAvLyByZXNldCB0aGUgY2FjaGUgaWYgdGltZSBlbGFwc2VkXG4gICAgaWYgKG5ldyBEYXRlKCkgLSBsYXN0Q2xlYW5UaW1lc3RhbXAgPj0gcmVzZXRBZnRlcikge1xuICAgICAgYXR0ZW1wdHMgPSB7fVxuICAgICAgbGFzdENsZWFuVGltZXN0YW1wID0gbmV3IERhdGUoKVxuICAgIH1cblxuICAgIHJldHVybiAoYXR0ZW1wdHNbaXBdIHx8IDApIDwgbWF4QXR0ZW1wdHNcbiAgfVxuXG4gIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZSh1c2VyLCBwYXNzd29yZCwgaXApIHtcbiAgICBpZiAodHlwZW9mKHVzZXIpID09PSAnc3RyaW5nJyAmJiB1c2VyLnRvTG93ZXJDYXNlKCkgPT09ICdhZG1pbicgJiZcbiAgICAgIHR5cGVvZihwYXNzd29yZCkgPT09ICdzdHJpbmcnICYmIHBhc3N3b3JkID09PSBhZG1pblBhc3N3b3JkKSB7XG4gICAgICBhdHRlbXB0c1tpcF0gPSAwXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogMCxcbiAgICAgICAgZW1haWw6ICdhZG1pbkBib3RwcmVzcy5pbycsXG4gICAgICAgIGZpcnN0X25hbWU6ICdBZG1pbicsXG4gICAgICAgIGxhc3RfbmFtZTogJ0FkbWluJyxcbiAgICAgICAgYXZhdGFyX3VybDogbnVsbCxcbiAgICAgICAgcm9sZXM6IFsnYWRtaW4nXVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhdHRlbXB0c1tpcF0gPSAoYXR0ZW1wdHNbaXBdIHx8IDApICsgMVxuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRTZWNyZXQoKSB7XG4gICAgcmV0dXJuIHNlY3JldFxuICB9XG5cbiAgZnVuY3Rpb24gcmVzZXRTZWNyZXQoKSB7XG4gICAgcmV0dXJuIGNyZWF0ZU5ld1NlY3JldCgpXG4gIH1cblxuICAvLyBQdWJsaWMgQVBJXG4gIHJldHVybiB7XG4gICAgYXR0ZW1wdDogUHJvbWlzZS5tZXRob2QoYXR0ZW1wdCksXG4gICAgYXV0aGVudGljYXRlOiBQcm9taXNlLm1ldGhvZChhdXRoZW50aWNhdGUpLFxuICAgIGdldFNlY3JldDogUHJvbWlzZS5tZXRob2QoZ2V0U2VjcmV0KSxcbiAgICByZXNldFNlY3JldDogUHJvbWlzZS5tZXRob2QocmVzZXRTZWNyZXQpXG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBleHRlbnNpb25zL2xpdGUvYXV0aGVudGljYXRpb24vaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXhCQTtBQUFBO0FBQ0E7QUFDQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///60\n");

/***/ }),
/* 61 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _uuid = __webpack_require__(13);\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar notifications = function notifications(_ref) {\n\n  /**\n   * Create and append a new Notification in the Hub. Emits a `notifications.new` event.\n   * @param  {string} options.message     (required) The body message of the notification\n   * @param  {string} options.redirectUrl (optional) The URL the users will be redirected to \n   *                                      when clicking on the notification\n   * @param  {string} options.level       (optional) The level (info, success, error, warning). Defaults to `info`.\n   * @param  {bool} options.enableSound (optional) Whether the notification will trigger a buzzing sound \n   *                                    if a user is currently logged on the dashboard. (defaults to `false`)\n   * @return {Promise}\n   */\n  var create = function () {\n    var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(_ref7) {\n      var message = _ref7.message,\n          redirectUrl = _ref7.redirectUrl,\n          level = _ref7.level,\n          enableSound = _ref7.enableSound;\n      var callingFile, callingModuleRoot, module, options, notification, logMessage, loggerLevel;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!(!message || typeof message !== 'string')) {\n                _context5.next = 2;\n                break;\n              }\n\n              throw new Error(\"'message' is mandatory and should be a string\");\n\n            case 2:\n\n              if (!level || typeof level !== 'string' || !_lodash2.default.includes(['info', 'error', 'success'], level.toLowerCase())) {\n                level = 'info';\n              } else {\n                level = level.toLowerCase();\n              }\n\n              callingFile = getOriginatingModule();\n              callingModuleRoot = callingFile && (0, _util.resolveModuleRootPath)(callingFile);\n              module = _lodash2.default.find(modules, function (mod) {\n                return mod.root === callingModuleRoot;\n              });\n              options = {\n                moduleId: 'botpress',\n                icon: 'view_module',\n                name: 'botpress',\n                url: _lodash2.default.isString(redirectUrl) ? redirectUrl : '/'\n              };\n\n\n              if (module) {\n                // because the bot itself can send notifications\n                options = {\n                  moduleId: module.name,\n                  icon: module.settings.menuIcon,\n                  name: module.settings.menuText,\n                  url: redirectUrl\n                };\n\n                if (!redirectUrl || typeof url !== 'string') {\n                  options.url = '/modules/' + module.name;\n                }\n              }\n\n              notification = {\n                id: _uuid2.default.v4(),\n                message: message,\n                level: level,\n                moduleId: options.moduleId,\n                icon: options.icon,\n                name: options.name,\n                url: options.url,\n                date: new Date(),\n                sound: enableSound || false,\n                read: false\n              };\n              _context5.next = 11;\n              return knex('notifications').insert(toDatabase(knex, notification)).then();\n\n            case 11:\n\n              if (logger) {\n                logMessage = '[notification::' + notification.moduleId + '] ' + notification.message;\n                loggerLevel = logger[level] || logger.info;\n\n                loggerLevel(logMessage);\n              }\n\n              if (events) {\n                events.emit('notifications.new', notification);\n              }\n\n            case 13:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    return function create(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Returns all archived notifications\n   * @return {Promise<Array<Notification>>} The list of all archived notifications\n   */\n\n\n  var getArchived = function () {\n    var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6() {\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              return _context6.abrupt('return', knex('notifications').where({ archived: (0, _helpers2.default)(knex).bool.true() }).orderBy('created_on', 'DESC').limit(100).then(function (rows) {\n                return rows.map(function (row) {\n                  return fromDatabase(knex, row);\n                });\n              }));\n\n            case 1:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    return function getArchived() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Get the top 100 (unseen) notifications\n   * @return {Promise<Array<Notification>>} The list of all unseen notifications\n   */\n\n\n  var getInbox = function () {\n    var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7() {\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              return _context7.abrupt('return', knex('notifications').where({ archived: (0, _helpers2.default)(knex).bool.false() }).orderBy('created_on', 'DESC').limit(100).then(function (rows) {\n                return rows.map(function (row) {\n                  return fromDatabase(knex, row);\n                });\n              }));\n\n            case 1:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    return function getInbox() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Archives a single notification\n   * @param  {string} notificationId The id of the notification to archive\n   * @return {Promise}\n   */\n\n\n  var archive = function () {\n    var _ref10 = _asyncToGenerator(regeneratorRuntime.mark(function _callee8(notificationId) {\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              return _context8.abrupt('return', knex('notifications').where({ id: notificationId }).update({ archived: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    return function archive(_x3) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Archives all notifications\n   * @return {Promise}\n   */\n\n\n  var archiveAll = function () {\n    var _ref11 = _asyncToGenerator(regeneratorRuntime.mark(function _callee9() {\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              return _context9.abrupt('return', knex('notifications').update({ archived: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    return function archiveAll() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Marks a single notification as read (but doesn't archive it)\n   * @param  {string} notificationId The id of the notification to mark as read\n   * @return {Promise}\n   */\n\n\n  var markAsRead = function () {\n    var _ref12 = _asyncToGenerator(regeneratorRuntime.mark(function _callee10(notificationId) {\n      return regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              return _context10.abrupt('return', knex('notifications').where({ id: notificationId }).update({ read: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context10.stop();\n          }\n        }\n      }, _callee10, this);\n    }));\n\n    return function markAsRead(_x4) {\n      return _ref12.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Marks all notifications as read (but doesn't archive them)\n   * @return {Promise}\n   */\n\n\n  var markAllAsRead = function () {\n    var _ref13 = _asyncToGenerator(regeneratorRuntime.mark(function _callee11() {\n      return regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              return _context11.abrupt('return', knex('notifications').update({ read: (0, _helpers2.default)(knex).bool.true() }).then());\n\n            case 1:\n            case 'end':\n              return _context11.stop();\n          }\n        }\n      }, _callee11, this);\n    }));\n\n    return function markAllAsRead() {\n      return _ref13.apply(this, arguments);\n    };\n  }();\n\n  var knex = _ref.knex,\n      modules = _ref.modules,\n      logger = _ref.logger,\n      events = _ref.events;\n\n  // Internal use only\n  // Binds events to actions\n  function _bindEvents() {\n    var _this = this;\n\n    events.on('notifications.getAll', _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = events;\n              _context.next = 3;\n              return getInbox();\n\n            case 3:\n              _context.t1 = _context.sent;\n\n              _context.t0.emit.call(_context.t0, 'notifications.all', _context.t1);\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, _this);\n    })));\n\n    events.on('notifications.read', function () {\n      var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(id) {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return markAsRead(id);\n\n              case 2:\n                _context2.t0 = events;\n                _context2.next = 5;\n                return getInbox();\n\n              case 5:\n                _context2.t1 = _context2.sent;\n\n                _context2.t0.emit.call(_context2.t0, 'notifications.all', _context2.t1);\n\n              case 7:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, _this);\n      }));\n\n      return function (_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    events.on('notifications.allRead', _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return markAllAsRead();\n\n            case 2:\n              _context3.t0 = events;\n              _context3.next = 5;\n              return getInbox();\n\n            case 5:\n              _context3.t1 = _context3.sent;\n\n              _context3.t0.emit.call(_context3.t0, 'notifications.all', _context3.t1);\n\n            case 7:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, _this);\n    })));\n\n    events.on('notifications.trashAll', _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return archiveAll();\n\n            case 2:\n              _context4.t0 = events;\n              _context4.next = 5;\n              return getInbox();\n\n            case 5:\n              _context4.t1 = _context4.sent;\n\n              _context4.t0.emit.call(_context4.t0, 'notifications.all', _context4.t1);\n\n            case 7:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, _this);\n    })));\n  }\n\n  return {\n    // ----> Start of legacy API (DEPRECATED as of Botpress 1.1)\n    load: getInbox,\n    send: function send(_ref14) {\n      var message = _ref14.message,\n          url = _ref14.url,\n          level = _ref14.level,\n          sound = _ref14.sound;\n\n      return create({ message: message, redirectUrl: url, level: level, enableSound: sound });\n    },\n    // End of legacy API <---\n    markAsRead: markAsRead,\n    markAllAsRead: markAllAsRead,\n    archiveAll: archiveAll,\n    archive: archive,\n    getInbox: getInbox,\n    getArchived: getArchived,\n    create: create,\n    // internal API\n    _bindEvents: _bindEvents\n  };\n};\n\nmodule.exports = notifications;\n\nfunction getOriginatingModule() {\n  var origPrepareStackTrace = Error.prepareStackTrace;\n  Error.prepareStackTrace = function (_, stack) {\n    return stack;\n  };\n  var err = new Error();\n  var stack = err.stack;\n  Error.prepareStackTrace = origPrepareStackTrace;\n  stack.shift();\n\n  return stack[1].getFileName();\n}\n\nfunction toDatabase(knex, notification) {\n  return {\n    id: notification.id,\n    message: notification.message,\n    level: notification.level,\n    module_id: notification.moduleId,\n    module_icon: notification.icon,\n    module_name: notification.name,\n    redirect_url: notification.url,\n    created_on: (0, _helpers2.default)(knex).date.now(),\n    read: (0, _helpers2.default)(knex).bool.false(),\n    archived: (0, _helpers2.default)(knex).bool.false()\n  };\n}\n\nfunction fromDatabase(knex, row) {\n  return {\n    id: row.id,\n    message: row.message,\n    level: row.level,\n    moduleId: row.module_id,\n    icon: row.module_icon,\n    name: row.module_name,\n    url: row.redirect_url,\n    date: new Date(row.created_on),\n    sound: false,\n    read: (0, _helpers2.default)(knex).bool.parse(row.read)\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL25vdGlmaWNhdGlvbnMuanM/M2U5NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgdXVpZCBmcm9tICd1dWlkJ1xuXG5pbXBvcnQgaGVscGVycyBmcm9tICcuL2RhdGFiYXNlL2hlbHBlcnMnXG5cbmltcG9ydCB7IHJlc29sdmVNb2R1bGVSb290UGF0aCB9IGZyb20gJy4vdXRpbCdcblxuY29uc3Qgbm90aWZpY2F0aW9ucyA9ICh7IGtuZXgsIG1vZHVsZXMsIGxvZ2dlciwgZXZlbnRzIH0pID0+IHtcbiAgLy8gSW50ZXJuYWwgdXNlIG9ubHlcbiAgLy8gQmluZHMgZXZlbnRzIHRvIGFjdGlvbnNcbiAgZnVuY3Rpb24gX2JpbmRFdmVudHMoKSB7XG4gICAgZXZlbnRzLm9uKCdub3RpZmljYXRpb25zLmdldEFsbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGV2ZW50cy5lbWl0KCdub3RpZmljYXRpb25zLmFsbCcsIGF3YWl0IGdldEluYm94KCkpXG4gICAgfSlcblxuICAgIGV2ZW50cy5vbignbm90aWZpY2F0aW9ucy5yZWFkJywgYXN5bmMgaWQgPT4ge1xuICAgICAgYXdhaXQgbWFya0FzUmVhZChpZClcbiAgICAgIGV2ZW50cy5lbWl0KCdub3RpZmljYXRpb25zLmFsbCcsIGF3YWl0IGdldEluYm94KCkpXG4gICAgfSlcblxuICAgIGV2ZW50cy5vbignbm90aWZpY2F0aW9ucy5hbGxSZWFkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgbWFya0FsbEFzUmVhZCgpXG4gICAgICBldmVudHMuZW1pdCgnbm90aWZpY2F0aW9ucy5hbGwnLCBhd2FpdCBnZXRJbmJveCgpKVxuICAgIH0pXG5cbiAgICBldmVudHMub24oJ25vdGlmaWNhdGlvbnMudHJhc2hBbGwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBhcmNoaXZlQWxsKClcbiAgICAgIGV2ZW50cy5lbWl0KCdub3RpZmljYXRpb25zLmFsbCcsIGF3YWl0IGdldEluYm94KCkpXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYW5kIGFwcGVuZCBhIG5ldyBOb3RpZmljYXRpb24gaW4gdGhlIEh1Yi4gRW1pdHMgYSBgbm90aWZpY2F0aW9ucy5uZXdgIGV2ZW50LlxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IG9wdGlvbnMubWVzc2FnZSAgICAgKHJlcXVpcmVkKSBUaGUgYm9keSBtZXNzYWdlIG9mIHRoZSBub3RpZmljYXRpb25cbiAgICogQHBhcmFtICB7c3RyaW5nfSBvcHRpb25zLnJlZGlyZWN0VXJsIChvcHRpb25hbCkgVGhlIFVSTCB0aGUgdXNlcnMgd2lsbCBiZSByZWRpcmVjdGVkIHRvIFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiBjbGlja2luZyBvbiB0aGUgbm90aWZpY2F0aW9uXG4gICAqIEBwYXJhbSAge3N0cmluZ30gb3B0aW9ucy5sZXZlbCAgICAgICAob3B0aW9uYWwpIFRoZSBsZXZlbCAoaW5mbywgc3VjY2VzcywgZXJyb3IsIHdhcm5pbmcpLiBEZWZhdWx0cyB0byBgaW5mb2AuXG4gICAqIEBwYXJhbSAge2Jvb2x9IG9wdGlvbnMuZW5hYmxlU291bmQgKG9wdGlvbmFsKSBXaGV0aGVyIHRoZSBub3RpZmljYXRpb24gd2lsbCB0cmlnZ2VyIGEgYnV6emluZyBzb3VuZCBcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhIHVzZXIgaXMgY3VycmVudGx5IGxvZ2dlZCBvbiB0aGUgZGFzaGJvYXJkLiAoZGVmYXVsdHMgdG8gYGZhbHNlYClcbiAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICovXG4gIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZSh7IG1lc3NhZ2UsIHJlZGlyZWN0VXJsLCBsZXZlbCwgZW5hYmxlU291bmQgfSkge1xuICAgIGlmICghbWVzc2FnZSB8fCB0eXBlb2YgbWVzc2FnZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIidtZXNzYWdlJyBpcyBtYW5kYXRvcnkgYW5kIHNob3VsZCBiZSBhIHN0cmluZ1wiKVxuICAgIH1cblxuICAgIGlmICghbGV2ZWwgfHwgdHlwZW9mIGxldmVsICE9PSAnc3RyaW5nJyB8fCAhXy5pbmNsdWRlcyhbJ2luZm8nLCAnZXJyb3InLCAnc3VjY2VzcyddLCBsZXZlbC50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgbGV2ZWwgPSAnaW5mbydcbiAgICB9IGVsc2Uge1xuICAgICAgbGV2ZWwgPSBsZXZlbC50b0xvd2VyQ2FzZSgpXG4gICAgfVxuXG4gICAgY29uc3QgY2FsbGluZ0ZpbGUgPSBnZXRPcmlnaW5hdGluZ01vZHVsZSgpXG4gICAgY29uc3QgY2FsbGluZ01vZHVsZVJvb3QgPSBjYWxsaW5nRmlsZSAmJiByZXNvbHZlTW9kdWxlUm9vdFBhdGgoY2FsbGluZ0ZpbGUpXG5cbiAgICBjb25zdCBtb2R1bGUgPSBfLmZpbmQobW9kdWxlcywgbW9kID0+IHtcbiAgICAgIHJldHVybiBtb2Qucm9vdCA9PT0gY2FsbGluZ01vZHVsZVJvb3RcbiAgICB9KVxuXG4gICAgbGV0IG9wdGlvbnMgPSB7XG4gICAgICBtb2R1bGVJZDogJ2JvdHByZXNzJyxcbiAgICAgIGljb246ICd2aWV3X21vZHVsZScsXG4gICAgICBuYW1lOiAnYm90cHJlc3MnLFxuICAgICAgdXJsOiBfLmlzU3RyaW5nKHJlZGlyZWN0VXJsKSA/IHJlZGlyZWN0VXJsIDogJy8nXG4gICAgfVxuXG4gICAgaWYgKG1vZHVsZSkge1xuICAgICAgLy8gYmVjYXVzZSB0aGUgYm90IGl0c2VsZiBjYW4gc2VuZCBub3RpZmljYXRpb25zXG4gICAgICBvcHRpb25zID0ge1xuICAgICAgICBtb2R1bGVJZDogbW9kdWxlLm5hbWUsXG4gICAgICAgIGljb246IG1vZHVsZS5zZXR0aW5ncy5tZW51SWNvbixcbiAgICAgICAgbmFtZTogbW9kdWxlLnNldHRpbmdzLm1lbnVUZXh0LFxuICAgICAgICB1cmw6IHJlZGlyZWN0VXJsXG4gICAgICB9XG5cbiAgICAgIGlmICghcmVkaXJlY3RVcmwgfHwgdHlwZW9mIHVybCAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgb3B0aW9ucy51cmwgPSBgL21vZHVsZXMvJHttb2R1bGUubmFtZX1gXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3Qgbm90aWZpY2F0aW9uID0ge1xuICAgICAgaWQ6IHV1aWQudjQoKSxcbiAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICBsZXZlbDogbGV2ZWwsXG4gICAgICBtb2R1bGVJZDogb3B0aW9ucy5tb2R1bGVJZCxcbiAgICAgIGljb246IG9wdGlvbnMuaWNvbixcbiAgICAgIG5hbWU6IG9wdGlvbnMubmFtZSxcbiAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICBkYXRlOiBuZXcgRGF0ZSgpLFxuICAgICAgc291bmQ6IGVuYWJsZVNvdW5kIHx8IGZhbHNlLFxuICAgICAgcmVhZDogZmFsc2VcbiAgICB9XG5cbiAgICBhd2FpdCBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC5pbnNlcnQodG9EYXRhYmFzZShrbmV4LCBub3RpZmljYXRpb24pKVxuICAgICAgLnRoZW4oKVxuXG4gICAgaWYgKGxvZ2dlcikge1xuICAgICAgY29uc3QgbG9nTWVzc2FnZSA9IGBbbm90aWZpY2F0aW9uOjoke25vdGlmaWNhdGlvbi5tb2R1bGVJZH1dICR7bm90aWZpY2F0aW9uLm1lc3NhZ2V9YFxuICAgICAgY29uc3QgbG9nZ2VyTGV2ZWwgPSBsb2dnZXJbbGV2ZWxdIHx8IGxvZ2dlci5pbmZvXG4gICAgICBsb2dnZXJMZXZlbChsb2dNZXNzYWdlKVxuICAgIH1cblxuICAgIGlmIChldmVudHMpIHtcbiAgICAgIGV2ZW50cy5lbWl0KCdub3RpZmljYXRpb25zLm5ldycsIG5vdGlmaWNhdGlvbilcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhbGwgYXJjaGl2ZWQgbm90aWZpY2F0aW9uc1xuICAgKiBAcmV0dXJuIHtQcm9taXNlPEFycmF5PE5vdGlmaWNhdGlvbj4+fSBUaGUgbGlzdCBvZiBhbGwgYXJjaGl2ZWQgbm90aWZpY2F0aW9uc1xuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gZ2V0QXJjaGl2ZWQoKSB7XG4gICAgcmV0dXJuIGtuZXgoJ25vdGlmaWNhdGlvbnMnKVxuICAgICAgLndoZXJlKHsgYXJjaGl2ZWQ6IGhlbHBlcnMoa25leCkuYm9vbC50cnVlKCkgfSlcbiAgICAgIC5vcmRlckJ5KCdjcmVhdGVkX29uJywgJ0RFU0MnKVxuICAgICAgLmxpbWl0KDEwMClcbiAgICAgIC50aGVuKHJvd3MgPT4gcm93cy5tYXAocm93ID0+IGZyb21EYXRhYmFzZShrbmV4LCByb3cpKSlcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHRvcCAxMDAgKHVuc2Vlbikgbm90aWZpY2F0aW9uc1xuICAgKiBAcmV0dXJuIHtQcm9taXNlPEFycmF5PE5vdGlmaWNhdGlvbj4+fSBUaGUgbGlzdCBvZiBhbGwgdW5zZWVuIG5vdGlmaWNhdGlvbnNcbiAgICovXG4gIGFzeW5jIGZ1bmN0aW9uIGdldEluYm94KCkge1xuICAgIHJldHVybiBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC53aGVyZSh7IGFyY2hpdmVkOiBoZWxwZXJzKGtuZXgpLmJvb2wuZmFsc2UoKSB9KVxuICAgICAgLm9yZGVyQnkoJ2NyZWF0ZWRfb24nLCAnREVTQycpXG4gICAgICAubGltaXQoMTAwKVxuICAgICAgLnRoZW4ocm93cyA9PiByb3dzLm1hcChyb3cgPT4gZnJvbURhdGFiYXNlKGtuZXgsIHJvdykpKVxuICB9XG5cbiAgLyoqXG4gICAqIEFyY2hpdmVzIGEgc2luZ2xlIG5vdGlmaWNhdGlvblxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IG5vdGlmaWNhdGlvbklkIFRoZSBpZCBvZiB0aGUgbm90aWZpY2F0aW9uIHRvIGFyY2hpdmVcbiAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICovXG4gIGFzeW5jIGZ1bmN0aW9uIGFyY2hpdmUobm90aWZpY2F0aW9uSWQpIHtcbiAgICByZXR1cm4ga25leCgnbm90aWZpY2F0aW9ucycpXG4gICAgICAud2hlcmUoeyBpZDogbm90aWZpY2F0aW9uSWQgfSlcbiAgICAgIC51cGRhdGUoeyBhcmNoaXZlZDogaGVscGVycyhrbmV4KS5ib29sLnRydWUoKSB9KVxuICAgICAgLnRoZW4oKVxuICB9XG5cbiAgLyoqXG4gICAqIEFyY2hpdmVzIGFsbCBub3RpZmljYXRpb25zXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAqL1xuICBhc3luYyBmdW5jdGlvbiBhcmNoaXZlQWxsKCkge1xuICAgIHJldHVybiBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC51cGRhdGUoeyBhcmNoaXZlZDogaGVscGVycyhrbmV4KS5ib29sLnRydWUoKSB9KVxuICAgICAgLnRoZW4oKVxuICB9XG5cbiAgLyoqXG4gICAqIE1hcmtzIGEgc2luZ2xlIG5vdGlmaWNhdGlvbiBhcyByZWFkIChidXQgZG9lc24ndCBhcmNoaXZlIGl0KVxuICAgKiBAcGFyYW0gIHtzdHJpbmd9IG5vdGlmaWNhdGlvbklkIFRoZSBpZCBvZiB0aGUgbm90aWZpY2F0aW9uIHRvIG1hcmsgYXMgcmVhZFxuICAgKiBAcmV0dXJuIHtQcm9taXNlfVxuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gbWFya0FzUmVhZChub3RpZmljYXRpb25JZCkge1xuICAgIHJldHVybiBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC53aGVyZSh7IGlkOiBub3RpZmljYXRpb25JZCB9KVxuICAgICAgLnVwZGF0ZSh7IHJlYWQ6IGhlbHBlcnMoa25leCkuYm9vbC50cnVlKCkgfSlcbiAgICAgIC50aGVuKClcbiAgfVxuXG4gIC8qKlxuICAgKiBNYXJrcyBhbGwgbm90aWZpY2F0aW9ucyBhcyByZWFkIChidXQgZG9lc24ndCBhcmNoaXZlIHRoZW0pXG4gICAqIEByZXR1cm4ge1Byb21pc2V9XG4gICAqL1xuICBhc3luYyBmdW5jdGlvbiBtYXJrQWxsQXNSZWFkKCkge1xuICAgIHJldHVybiBrbmV4KCdub3RpZmljYXRpb25zJylcbiAgICAgIC51cGRhdGUoeyByZWFkOiBoZWxwZXJzKGtuZXgpLmJvb2wudHJ1ZSgpIH0pXG4gICAgICAudGhlbigpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIC8vIC0tLS0+IFN0YXJ0IG9mIGxlZ2FjeSBBUEkgKERFUFJFQ0FURUQgYXMgb2YgQm90cHJlc3MgMS4xKVxuICAgIGxvYWQ6IGdldEluYm94LFxuICAgIHNlbmQ6ICh7IG1lc3NhZ2UsIHVybCwgbGV2ZWwsIHNvdW5kIH0pID0+IHtcbiAgICAgIHJldHVybiBjcmVhdGUoeyBtZXNzYWdlLCByZWRpcmVjdFVybDogdXJsLCBsZXZlbCwgZW5hYmxlU291bmQ6IHNvdW5kIH0pXG4gICAgfSxcbiAgICAvLyBFbmQgb2YgbGVnYWN5IEFQSSA8LS0tXG4gICAgbWFya0FzUmVhZCxcbiAgICBtYXJrQWxsQXNSZWFkLFxuICAgIGFyY2hpdmVBbGwsXG4gICAgYXJjaGl2ZSxcbiAgICBnZXRJbmJveCxcbiAgICBnZXRBcmNoaXZlZCxcbiAgICBjcmVhdGUsXG4gICAgLy8gaW50ZXJuYWwgQVBJXG4gICAgX2JpbmRFdmVudHNcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IG5vdGlmaWNhdGlvbnNcblxuZnVuY3Rpb24gZ2V0T3JpZ2luYXRpbmdNb2R1bGUoKSB7XG4gIHZhciBvcmlnUHJlcGFyZVN0YWNrVHJhY2UgPSBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZVxuICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IGZ1bmN0aW9uKF8sIHN0YWNrKSB7XG4gICAgcmV0dXJuIHN0YWNrXG4gIH1cbiAgdmFyIGVyciA9IG5ldyBFcnJvcigpXG4gIHZhciBzdGFjayA9IGVyci5zdGFja1xuICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IG9yaWdQcmVwYXJlU3RhY2tUcmFjZVxuICBzdGFjay5zaGlmdCgpXG5cbiAgcmV0dXJuIHN0YWNrWzFdLmdldEZpbGVOYW1lKClcbn1cblxuZnVuY3Rpb24gdG9EYXRhYmFzZShrbmV4LCBub3RpZmljYXRpb24pIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogbm90aWZpY2F0aW9uLmlkLFxuICAgIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbi5tZXNzYWdlLFxuICAgIGxldmVsOiBub3RpZmljYXRpb24ubGV2ZWwsXG4gICAgbW9kdWxlX2lkOiBub3RpZmljYXRpb24ubW9kdWxlSWQsXG4gICAgbW9kdWxlX2ljb246IG5vdGlmaWNhdGlvbi5pY29uLFxuICAgIG1vZHVsZV9uYW1lOiBub3RpZmljYXRpb24ubmFtZSxcbiAgICByZWRpcmVjdF91cmw6IG5vdGlmaWNhdGlvbi51cmwsXG4gICAgY3JlYXRlZF9vbjogaGVscGVycyhrbmV4KS5kYXRlLm5vdygpLFxuICAgIHJlYWQ6IGhlbHBlcnMoa25leCkuYm9vbC5mYWxzZSgpLFxuICAgIGFyY2hpdmVkOiBoZWxwZXJzKGtuZXgpLmJvb2wuZmFsc2UoKVxuICB9XG59XG5cbmZ1bmN0aW9uIGZyb21EYXRhYmFzZShrbmV4LCByb3cpIHtcbiAgcmV0dXJuIHtcbiAgICBpZDogcm93LmlkLFxuICAgIG1lc3NhZ2U6IHJvdy5tZXNzYWdlLFxuICAgIGxldmVsOiByb3cubGV2ZWwsXG4gICAgbW9kdWxlSWQ6IHJvdy5tb2R1bGVfaWQsXG4gICAgaWNvbjogcm93Lm1vZHVsZV9pY29uLFxuICAgIG5hbWU6IHJvdy5tb2R1bGVfbmFtZSxcbiAgICB1cmw6IHJvdy5yZWRpcmVjdF91cmwsXG4gICAgZGF0ZTogbmV3IERhdGUocm93LmNyZWF0ZWRfb24pLFxuICAgIHNvdW5kOiBmYWxzZSxcbiAgICByZWFkOiBoZWxwZXJzKGtuZXgpLmJvb2wucGFyc2Uocm93LnJlYWQpXG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvbm90aWZpY2F0aW9ucy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFDQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUF1QkE7Ozs7Ozs7Ozs7QUF4QkE7QUFBQTtBQWtDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUF2Q0E7QUFBQTtBQUNBO0FBREE7QUFDQTtBQXVEQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBakVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFuQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQW9HQTs7Ozs7O0FBckdBO0FBQUE7QUF5R0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBMUdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFnSEE7Ozs7OztBQWpIQTtBQUFBO0FBcUhBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBTkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXRIQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBNEhBOzs7Ozs7O0FBN0hBO0FBQUE7QUFrSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQW5JQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBd0lBOzs7Ozs7QUF6SUE7QUFBQTtBQTZJQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBOUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFrSkE7Ozs7Ozs7QUFuSkE7QUFBQTtBQXdKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBekpBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUE4SkE7Ozs7OztBQS9KQTtBQUFBO0FBbUtBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFwS0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQWtKQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFZQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///61\n");

/***/ }),
/* 62 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _mware = __webpack_require__(25);\n\nvar _mware2 = _interopRequireDefault(_mware);\n\nvar _listeners = __webpack_require__(12);\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function () {\n\n  var chain = (0, _mware2.default)();\n  var handler = function handler(event, next) {\n    chain.run(event, function () {\n      next.apply(this, arguments);\n    });\n  };\n\n  var middleware = {\n    name: 'hear',\n    type: 'incoming',\n    order: 20,\n    module: 'botpress',\n    description: 'The built-in hear convenience middleware',\n    handler: handler\n  };\n\n  var hear = function hear(condition, callback) {\n    chain(_listeners2.default.hear(condition, callback));\n  };\n\n  return { hear: hear, middleware: middleware };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2hlYXIuanM/NjE2MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXdhcmUgZnJvbSAnbXdhcmUnXG5pbXBvcnQgbGlzdGVuZXJzIGZyb20gJy4vbGlzdGVuZXJzJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICgpID0+IHtcblxuICBjb25zdCBjaGFpbiA9IG13YXJlKClcbiAgY29uc3QgaGFuZGxlciA9IChldmVudCwgbmV4dCkgPT4ge1xuICAgIGNoYWluLnJ1bihldmVudCwgZnVuY3Rpb24oKSB7XG4gICAgICBuZXh0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgbWlkZGxld2FyZSA9IHtcbiAgICBuYW1lOiAnaGVhcicsXG4gICAgdHlwZTogJ2luY29taW5nJyxcbiAgICBvcmRlcjogMjAsXG4gICAgbW9kdWxlOiAnYm90cHJlc3MnLFxuICAgIGRlc2NyaXB0aW9uOiAnVGhlIGJ1aWx0LWluIGhlYXIgY29udmVuaWVuY2UgbWlkZGxld2FyZScsXG4gICAgaGFuZGxlcjogaGFuZGxlclxuICB9XG5cbiAgY29uc3QgaGVhciA9IChjb25kaXRpb24sIGNhbGxiYWNrKSA9PiB7XG4gICAgY2hhaW4obGlzdGVuZXJzLmhlYXIoY29uZGl0aW9uLCBjYWxsYmFjaykpXG4gIH1cblxuICByZXR1cm4geyBoZWFyLCBtaWRkbGV3YXJlIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvaGVhci5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///62\n");

/***/ }),
/* 63 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _listeners = __webpack_require__(12);\n\nvar _listeners2 = _interopRequireDefault(_listeners);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (bp) {\n\n  var middleware = {\n    name: 'fallback',\n    type: 'incoming',\n    order: 200,\n    module: 'botpress',\n    description: 'The built-in fallback handler. You may override this by implementing bp.fallbackHandler',\n    handler: function handler(event, next) {\n      if (_lodash2.default.isFunction(bp.fallbackHandler)) {\n        bp.fallbackHandler(event, next);\n      }\n    }\n  };\n\n  return { middleware: middleware };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2ZhbGxiYWNrLmpzPzNlODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IGxpc3RlbmVycyBmcm9tICcuL2xpc3RlbmVycydcblxubW9kdWxlLmV4cG9ydHMgPSBicCA9PiB7XG5cbiAgY29uc3QgbWlkZGxld2FyZSA9IHtcbiAgICBuYW1lOiAnZmFsbGJhY2snLFxuICAgIHR5cGU6ICdpbmNvbWluZycsXG4gICAgb3JkZXI6IDIwMCxcbiAgICBtb2R1bGU6ICdib3RwcmVzcycsXG4gICAgZGVzY3JpcHRpb246ICdUaGUgYnVpbHQtaW4gZmFsbGJhY2sgaGFuZGxlci4gWW91IG1heSBvdmVycmlkZSB0aGlzIGJ5IGltcGxlbWVudGluZyBicC5mYWxsYmFja0hhbmRsZXInLFxuICAgIGhhbmRsZXI6IChldmVudCwgbmV4dCkgPT4ge1xuICAgICAgaWYgKF8uaXNGdW5jdGlvbihicC5mYWxsYmFja0hhbmRsZXIpKSB7XG4gICAgICAgIGJwLmZhbGxiYWNrSGFuZGxlcihldmVudCwgbmV4dClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBtaWRkbGV3YXJlIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZmFsbGJhY2suanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVZBO0FBQ0E7QUFZQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///63\n");

/***/ }),
/* 64 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _moment = __webpack_require__(8);\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nvar _tables = __webpack_require__(65);\n\nvar _tables2 = _interopRequireDefault(_tables);\n\nvar _kvs2 = __webpack_require__(22);\n\nvar _kvs3 = _interopRequireDefault(_kvs2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar initializeCoreDatabase = function initializeCoreDatabase(knex) {\n  if (!knex) {\n    throw new Error('You must initialize the database before');\n  }\n\n  return _bluebird2.default.mapSeries(_tables2.default, function (fn) {\n    return fn(knex);\n  });\n};\n\nvar createKnex = function () {\n  var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref2) {\n    var sqlite = _ref2.sqlite,\n        postgres = _ref2.postgres;\n\n    var _knex;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _knex = null;\n\n\n            if (postgres.enabled) {\n\n              // If we're passing in a postgres connection string, \n              // use that instead of the other params\n              if (postgres.connection) {\n                _knex = __webpack_require__(11)({\n                  client: 'pg',\n                  connection: postgres.connection,\n                  useNullAsDefault: true\n                });\n              } else {\n                _knex = __webpack_require__(11)({\n                  client: 'pg',\n                  connection: {\n                    host: postgres.host,\n                    port: postgres.port,\n                    user: postgres.user,\n                    password: postgres.password,\n                    database: postgres.database,\n                    ssl: postgres.ssl\n                  },\n                  useNullAsDefault: true\n                });\n              }\n            } else {\n              _knex = __webpack_require__(11)({\n                client: 'sqlite3',\n                connection: { filename: sqlite.location },\n                useNullAsDefault: true,\n                pool: {\n                  afterCreate: function afterCreate(conn, cb) {\n                    conn.run('PRAGMA foreign_keys = ON', cb);\n                  }\n                }\n              });\n            }\n\n            _context.next = 4;\n            return initializeCoreDatabase(_knex);\n\n          case 4:\n            return _context.abrupt('return', _knex);\n\n          case 5:\n          case 'end':\n            return _context.stop();\n        }\n      }\n    }, _callee, undefined);\n  }));\n\n  return function createKnex(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nmodule.exports = function (_ref3) {\n  var sqlite = _ref3.sqlite,\n      postgres = _ref3.postgres;\n\n\n  var knex = null;\n\n  var getDb = function () {\n    var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!knex) {\n                knex = createKnex({ sqlite: sqlite, postgres: postgres });\n              }\n\n              _context2.next = 3;\n              return knex;\n\n            case 3:\n              return _context2.abrupt('return', _context2.sent);\n\n            case 4:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function getDb() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var saveUser = function saveUser(_ref5) {\n    var id = _ref5.id,\n        platform = _ref5.platform,\n        gender = _ref5.gender,\n        timezone = _ref5.timezone,\n        locale = _ref5.locale,\n        picture_url = _ref5.picture_url,\n        first_name = _ref5.first_name,\n        last_name = _ref5.last_name;\n\n    var userId = platform + ':' + id;\n    var userRow = {\n      id: userId,\n      userId: id,\n      platform: platform,\n      gender: gender || 'unknown',\n      timezone: timezone || null,\n      locale: locale || null,\n      created_on: (0, _moment2.default)(new Date()).toISOString(),\n      picture_url: picture_url,\n      last_name: last_name,\n      first_name: first_name\n    };\n\n    return getDb().then(function (knex) {\n      var query = knex('users').insert(userRow).where(function () {\n        return this.select(knex.raw(1)).from('users').where('id', '=', userId);\n      });\n\n      if (postgres.enabled) {\n        query = query + ' on conflict (id) do nothing';\n      } else {\n        // SQLite\n        query = query.toString().replace(/^insert/i, 'insert or ignore');\n      }\n\n      return knex.raw(query);\n    });\n  };\n\n  var kvs_instance = null;\n\n  var createKvs = function () {\n    var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n      var knex, _kvs;\n\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return getDb();\n\n            case 2:\n              knex = _context3.sent;\n              _kvs = new _kvs3.default(knex);\n              _context3.next = 6;\n              return _kvs.bootstrap();\n\n            case 6:\n              return _context3.abrupt('return', _kvs);\n\n            case 7:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function createKvs() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var getKvs = function () {\n    var _ref7 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!kvs_instance) {\n                kvs_instance = createKvs();\n              }\n\n              _context4.next = 3;\n              return kvs_instance;\n\n            case 3:\n              return _context4.abrupt('return', _context4.sent);\n\n            case 4:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function getKvs() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var kvsGet = function kvsGet() {\n    var args = arguments;\n    return getKvs().then(function (instance) {\n      return instance.get.apply(null, args);\n    });\n  };\n\n  var kvsSet = function kvsSet() {\n    var args = arguments;\n    return getKvs().then(function (instance) {\n      return instance.set.apply(null, args);\n    });\n  };\n\n  return {\n    get: getDb,\n    saveUser: saveUser,\n    location: postgres.enabled ? 'postgres' : sqlite.location,\n    kvs: { get: kvsGet, set: kvsSet }\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL2luZGV4LmpzPzkwMGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFByb21pc2UgZnJvbSAnYmx1ZWJpcmQnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCdcblxuaW1wb3J0IHRhYmxlcyBmcm9tICcuL3RhYmxlcydcbmltcG9ydCBrdnMgZnJvbSAnLi9rdnMnXG5cbmNvbnN0IGluaXRpYWxpemVDb3JlRGF0YWJhc2UgPSBrbmV4ID0+IHtcbiAgaWYgKCFrbmV4KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBpbml0aWFsaXplIHRoZSBkYXRhYmFzZSBiZWZvcmUnKVxuICB9XG5cbiAgcmV0dXJuIFByb21pc2UubWFwU2VyaWVzKHRhYmxlcywgZm4gPT4gZm4oa25leCkpXG59XG5cbmNvbnN0IGNyZWF0ZUtuZXggPSBhc3luYyAoeyBzcWxpdGUsIHBvc3RncmVzIH0pID0+IHtcbiAgbGV0IF9rbmV4ID0gbnVsbFxuXG4gIGlmIChwb3N0Z3Jlcy5lbmFibGVkKSB7XG5cbiAgICAvLyBJZiB3ZSdyZSBwYXNzaW5nIGluIGEgcG9zdGdyZXMgY29ubmVjdGlvbiBzdHJpbmcsIFxuICAgIC8vIHVzZSB0aGF0IGluc3RlYWQgb2YgdGhlIG90aGVyIHBhcmFtc1xuICAgIGlmIChwb3N0Z3Jlcy5jb25uZWN0aW9uKSB7XG4gICAgICBfa25leCA9IHJlcXVpcmUoJ2tuZXgnKSh7XG4gICAgICAgIGNsaWVudDogJ3BnJyxcbiAgICAgICAgY29ubmVjdGlvbjogcG9zdGdyZXMuY29ubmVjdGlvbixcbiAgICAgICAgdXNlTnVsbEFzRGVmYXVsdDogdHJ1ZVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgX2tuZXggPSByZXF1aXJlKCdrbmV4Jykoe1xuICAgICAgICBjbGllbnQ6ICdwZycsXG4gICAgICAgIGNvbm5lY3Rpb246IHtcbiAgICAgICAgICBob3N0OiBwb3N0Z3Jlcy5ob3N0LFxuICAgICAgICAgIHBvcnQ6IHBvc3RncmVzLnBvcnQsXG4gICAgICAgICAgdXNlcjogcG9zdGdyZXMudXNlcixcbiAgICAgICAgICBwYXNzd29yZDogcG9zdGdyZXMucGFzc3dvcmQsXG4gICAgICAgICAgZGF0YWJhc2U6IHBvc3RncmVzLmRhdGFiYXNlLFxuICAgICAgICAgIHNzbDogcG9zdGdyZXMuc3NsXG4gICAgICAgIH0sXG4gICAgICAgIHVzZU51bGxBc0RlZmF1bHQ6IHRydWVcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICB9IGVsc2Uge1xuICAgIF9rbmV4ID0gcmVxdWlyZSgna25leCcpKHtcbiAgICAgIGNsaWVudDogJ3NxbGl0ZTMnLFxuICAgICAgY29ubmVjdGlvbjogeyBmaWxlbmFtZTogc3FsaXRlLmxvY2F0aW9uIH0sXG4gICAgICB1c2VOdWxsQXNEZWZhdWx0OiB0cnVlLFxuICAgICAgcG9vbDogeyBcbiAgICAgICAgYWZ0ZXJDcmVhdGU6IChjb25uLCBjYikgPT4ge1xuICAgICAgICAgIGNvbm4ucnVuKCdQUkFHTUEgZm9yZWlnbl9rZXlzID0gT04nLCBjYilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBhd2FpdCBpbml0aWFsaXplQ29yZURhdGFiYXNlKF9rbmV4KVxuICByZXR1cm4gX2tuZXhcbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoeyBzcWxpdGUsIHBvc3RncmVzIH0pID0+IHtcblxuICBsZXQga25leCA9IG51bGxcblxuICBjb25zdCBnZXREYiA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWtuZXgpIHtcbiAgICAgIGtuZXggPSBjcmVhdGVLbmV4KHsgc3FsaXRlLCBwb3N0Z3JlcyB9KVxuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCBrbmV4XG4gIH1cblxuICBjb25zdCBzYXZlVXNlciA9ICh7IGlkLCBwbGF0Zm9ybSwgZ2VuZGVyLCB0aW1lem9uZSwgbG9jYWxlLCBwaWN0dXJlX3VybCwgZmlyc3RfbmFtZSwgbGFzdF9uYW1lIH0pID0+IHtcbiAgICBjb25zdCB1c2VySWQgPSBwbGF0Zm9ybSArICc6JyArIGlkXG4gICAgY29uc3QgdXNlclJvdyA9IHtcbiAgICAgIGlkOiB1c2VySWQsXG4gICAgICB1c2VySWQ6IGlkLFxuICAgICAgcGxhdGZvcm06IHBsYXRmb3JtLFxuICAgICAgZ2VuZGVyOiBnZW5kZXIgfHwgJ3Vua25vd24nLFxuICAgICAgdGltZXpvbmU6IHRpbWV6b25lIHx8IG51bGwsXG4gICAgICBsb2NhbGU6IGxvY2FsZSB8fCBudWxsLFxuICAgICAgY3JlYXRlZF9vbjogbW9tZW50KG5ldyBEYXRlKCkpLnRvSVNPU3RyaW5nKCksXG4gICAgICBwaWN0dXJlX3VybDogcGljdHVyZV91cmwsXG4gICAgICBsYXN0X25hbWU6IGxhc3RfbmFtZSxcbiAgICAgIGZpcnN0X25hbWU6IGZpcnN0X25hbWVcbiAgICB9XG5cbiAgICByZXR1cm4gZ2V0RGIoKVxuICAgICAgLnRoZW4oa25leCA9PiB7XG4gICAgICAgIHZhciBxdWVyeSA9IGtuZXgoJ3VzZXJzJykuaW5zZXJ0KHVzZXJSb3cpXG4gICAgICAgICAgLndoZXJlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNcbiAgICAgICAgICAgICAgLnNlbGVjdChrbmV4LnJhdygxKSlcbiAgICAgICAgICAgICAgLmZyb20oJ3VzZXJzJylcbiAgICAgICAgICAgICAgLndoZXJlKCdpZCcsICc9JywgdXNlcklkKVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgaWYgKHBvc3RncmVzLmVuYWJsZWQpIHtcbiAgICAgICAgICBxdWVyeSA9IGAke3F1ZXJ5fSBvbiBjb25mbGljdCAoaWQpIGRvIG5vdGhpbmdgXG4gICAgICAgIH0gZWxzZSB7IC8vIFNRTGl0ZVxuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkudG9TdHJpbmcoKS5yZXBsYWNlKC9eaW5zZXJ0L2ksICdpbnNlcnQgb3IgaWdub3JlJylcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBrbmV4LnJhdyhxdWVyeSlcbiAgICAgIH0pXG4gIH1cblxuICBsZXQga3ZzX2luc3RhbmNlID0gbnVsbFxuXG4gIGNvbnN0IGNyZWF0ZUt2cyA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZ2V0RGIoKVxuICAgIGxldCBfa3ZzID0gbmV3IGt2cyhrbmV4KVxuICAgIGF3YWl0IF9rdnMuYm9vdHN0cmFwKClcbiAgICByZXR1cm4gX2t2c1xuICB9XG5cbiAgY29uc3QgZ2V0S3ZzID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICgha3ZzX2luc3RhbmNlKSB7XG4gICAgICBrdnNfaW5zdGFuY2UgPSBjcmVhdGVLdnMoKVxuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCBrdnNfaW5zdGFuY2VcbiAgfVxuXG4gIGNvbnN0IGt2c0dldCA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHNcbiAgICByZXR1cm4gZ2V0S3ZzKClcbiAgICAgIC50aGVuKGluc3RhbmNlID0+IGluc3RhbmNlLmdldC5hcHBseShudWxsLCBhcmdzKSlcbiAgfVxuXG4gIGNvbnN0IGt2c1NldCA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHNcbiAgICByZXR1cm4gZ2V0S3ZzKClcbiAgICAgIC50aGVuKGluc3RhbmNlID0+IGluc3RhbmNlLnNldC5hcHBseShudWxsLCBhcmdzKSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZ2V0OiBnZXREYixcbiAgICBzYXZlVXNlcixcbiAgICBsb2NhdGlvbjogcG9zdGdyZXMuZW5hYmxlZCA/ICdwb3N0Z3JlcycgOiBzcWxpdGUubG9jYXRpb24sXG4gICAga3ZzOiB7IGdldDoga3ZzR2V0LCBzZXQ6IGt2c1NldCB9XG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZGF0YWJhc2UvaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBVkE7QUFZQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBSkE7QUFVQTtBQUNBO0FBeENBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBNENBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU9BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFDQTtBQVlBO0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFGQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///64\n");

/***/ }),
/* 65 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _database = __webpack_require__(66);\n\nmodule.exports = [__webpack_require__(67), __webpack_require__(68), __webpack_require__(69), __webpack_require__(70)].concat(_database.table_factories);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL3RhYmxlcy5qcz84ZTQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRhYmxlX2ZhY3RvcmllcyB9IGZyb20gJysvZGF0YWJhc2UnXG5cbm1vZHVsZS5leHBvcnRzID0gW1xuICByZXF1aXJlKCcuL3VzZXJzLmpzJyksXG4gIHJlcXVpcmUoJy4vdGFncy5qcycpLFxuICByZXF1aXJlKCcuL25vdGlmaWNhdGlvbnMuanMnKSxcbiAgcmVxdWlyZSgnLi9jb250ZW50LmpzJylcbl0uY29uY2F0KHRhYmxlX2ZhY3RvcmllcylcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZGF0YWJhc2UvdGFibGVzLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///65\n");

/***/ }),
/* 66 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = {\n  table_factories: []\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2RhdGFiYXNlL2luZGV4LmpzPzA1ZDQiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7XG4gIHRhYmxlX2ZhY3RvcmllczogW11cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBleHRlbnNpb25zL2xpdGUvZGF0YWJhc2UvaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQURBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///66\n");

/***/ }),
/* 67 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('users', function (table) {\n    table.string('id').primary();\n    table.string('userId');\n    table.string('platform');\n    table.enu('gender', ['unknown', 'male', 'female']);\n    table.integer('timezone');\n    table.string('picture_url');\n    table.string('first_name');\n    table.string('last_name');\n    table.string('locale');\n    table.timestamp('created_on');\n  });\n}; /*\n     A table storing all the interlocutors (users) and their information\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL3VzZXJzLmpzPzA0ZjMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAgQSB0YWJsZSBzdG9yaW5nIGFsbCB0aGUgaW50ZXJsb2N1dG9ycyAodXNlcnMpIGFuZCB0aGVpciBpbmZvcm1hdGlvblxuKi9cblxuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi9oZWxwZXJzJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IGtuZXggPT4ge1xuICByZXR1cm4gaGVscGVycyhrbmV4KS5jcmVhdGVUYWJsZUlmTm90RXhpc3RzKCd1c2VycycsIGZ1bmN0aW9uICh0YWJsZSkge1xuICAgIHRhYmxlLnN0cmluZygnaWQnKS5wcmltYXJ5KClcbiAgICB0YWJsZS5zdHJpbmcoJ3VzZXJJZCcpXG4gICAgdGFibGUuc3RyaW5nKCdwbGF0Zm9ybScpXG4gICAgdGFibGUuZW51KCdnZW5kZXInLCBbJ3Vua25vd24nLCAnbWFsZScsICdmZW1hbGUnXSlcbiAgICB0YWJsZS5pbnRlZ2VyKCd0aW1lem9uZScpXG4gICAgdGFibGUuc3RyaW5nKCdwaWN0dXJlX3VybCcpXG4gICAgdGFibGUuc3RyaW5nKCdmaXJzdF9uYW1lJylcbiAgICB0YWJsZS5zdHJpbmcoJ2xhc3RfbmFtZScpXG4gICAgdGFibGUuc3RyaW5nKCdsb2NhbGUnKVxuICAgIHRhYmxlLnRpbWVzdGFtcCgnY3JlYXRlZF9vbicpXG4gIH0pXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2RhdGFiYXNlL3VzZXJzLmpzIl0sIm1hcHBpbmdzIjoiOztBQUlBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///67\n");

/***/ }),
/* 68 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('users_tags', function (table) {\n    table.string('userId');\n    table.string('tag');\n    table.string('value');\n    table.timestamp('tagged_on');\n    table.unique(['userId', 'tag']);\n  });\n}; /*\n     A table storing all the user tags\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL3RhZ3MuanM/ZmRlZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBBIHRhYmxlIHN0b3JpbmcgYWxsIHRoZSB1c2VyIHRhZ3NcbiovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSBrbmV4ID0+IHtcbiAgcmV0dXJuIGhlbHBlcnMoa25leCkuY3JlYXRlVGFibGVJZk5vdEV4aXN0cygndXNlcnNfdGFncycsIGZ1bmN0aW9uICh0YWJsZSkge1xuICAgIHRhYmxlLnN0cmluZygndXNlcklkJylcbiAgICB0YWJsZS5zdHJpbmcoJ3RhZycpXG4gICAgdGFibGUuc3RyaW5nKCd2YWx1ZScpXG4gICAgdGFibGUudGltZXN0YW1wKCd0YWdnZWRfb24nKVxuICAgIHRhYmxlLnVuaXF1ZShbJ3VzZXJJZCcsICd0YWcnXSlcbiAgfSlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZGF0YWJhc2UvdGFncy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFJQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///68\n");

/***/ }),
/* 69 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('notifications', function (table) {\n    table.string('id').unique();\n    table.string('message');\n    table.string('level');\n    table.string('module_id');\n    table.string('module_icon');\n    table.string('module_name');\n    table.string('redirect_url');\n\n    table.timestamp('created_on');\n\n    table.boolean('read');\n    table.boolean('archived');\n  });\n}; /*\n     A table storing all notifications\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL25vdGlmaWNhdGlvbnMuanM/Yzk2MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBBIHRhYmxlIHN0b3JpbmcgYWxsIG5vdGlmaWNhdGlvbnNcbiovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSBrbmV4ID0+IHtcbiAgcmV0dXJuIGhlbHBlcnMoa25leCkuY3JlYXRlVGFibGVJZk5vdEV4aXN0cygnbm90aWZpY2F0aW9ucycsIGZ1bmN0aW9uKHRhYmxlKSB7XG4gICAgdGFibGUuc3RyaW5nKCdpZCcpLnVuaXF1ZSgpXG4gICAgdGFibGUuc3RyaW5nKCdtZXNzYWdlJylcbiAgICB0YWJsZS5zdHJpbmcoJ2xldmVsJylcbiAgICB0YWJsZS5zdHJpbmcoJ21vZHVsZV9pZCcpXG4gICAgdGFibGUuc3RyaW5nKCdtb2R1bGVfaWNvbicpXG4gICAgdGFibGUuc3RyaW5nKCdtb2R1bGVfbmFtZScpXG4gICAgdGFibGUuc3RyaW5nKCdyZWRpcmVjdF91cmwnKVxuXG4gICAgdGFibGUudGltZXN0YW1wKCdjcmVhdGVkX29uJylcblxuICAgIHRhYmxlLmJvb2xlYW4oJ3JlYWQnKVxuICAgIHRhYmxlLmJvb2xlYW4oJ2FyY2hpdmVkJylcbiAgfSlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZGF0YWJhc2Uvbm90aWZpY2F0aW9ucy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFJQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///69\n");

/***/ }),
/* 70 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (knex) {\n  return (0, _helpers2.default)(knex).createTableIfNotExists('content_items', function (table) {\n    table.string('id').primary();\n    table.text('data');\n    table.text('formData');\n    table.text('metadata');\n    table.string('categoryId');\n    table.text('previewText');\n    table.string('created_by');\n    table.timestamp('created_on');\n  });\n}; /*\n     Table storing the created content\n   *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2RhdGFiYXNlL2NvbnRlbnQuanM/ZTk5YiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBUYWJsZSBzdG9yaW5nIHRoZSBjcmVhdGVkIGNvbnRlbnRcbiovXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4vaGVscGVycydcblxubW9kdWxlLmV4cG9ydHMgPSBrbmV4ID0+IHtcbiAgcmV0dXJuIGhlbHBlcnMoa25leCkuY3JlYXRlVGFibGVJZk5vdEV4aXN0cygnY29udGVudF9pdGVtcycsIGZ1bmN0aW9uICh0YWJsZSkge1xuICAgIHRhYmxlLnN0cmluZygnaWQnKS5wcmltYXJ5KClcbiAgICB0YWJsZS50ZXh0KCdkYXRhJylcbiAgICB0YWJsZS50ZXh0KCdmb3JtRGF0YScpXG4gICAgdGFibGUudGV4dCgnbWV0YWRhdGEnKVxuICAgIHRhYmxlLnN0cmluZygnY2F0ZWdvcnlJZCcpXG4gICAgdGFibGUudGV4dCgncHJldmlld1RleHQnKVxuICAgIHRhYmxlLnN0cmluZygnY3JlYXRlZF9ieScpXG4gICAgdGFibGUudGltZXN0YW1wKCdjcmVhdGVkX29uJylcbiAgfSlcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvZGF0YWJhc2UvY29udGVudC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFJQTtBQUNBOzs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///70\n");

/***/ }),
/* 71 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _util = __webpack_require__(3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = function (projectLocation) {\n\n  var getBotInformation = function getBotInformation() {\n    var packageJsonPath = (0, _util.resolveProjectFile)('package.json', projectLocation, true);\n    var packageJson = JSON.parse(_fs2.default.readFileSync(packageJsonPath));\n\n    return {\n      name: packageJson.name,\n      version: packageJson.version,\n      description: packageJson.description || '<no description>',\n      author: packageJson.author || '<no author>',\n      license: packageJson.license || 'AGPL-v3.0'\n    };\n  };\n\n  return { getBotInformation: getBotInformation };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2Fib3V0LmpzPzQ1YmUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHsgcmVzb2x2ZVByb2plY3RGaWxlIH0gZnJvbSAnLi91dGlsJ1xuXG5tb2R1bGUuZXhwb3J0cyA9IChwcm9qZWN0TG9jYXRpb24pID0+IHtcblxuICBjb25zdCBnZXRCb3RJbmZvcm1hdGlvbiA9ICgpID0+IHtcbiAgICBjb25zdCBwYWNrYWdlSnNvblBhdGggPSByZXNvbHZlUHJvamVjdEZpbGUoJ3BhY2thZ2UuanNvbicsIHByb2plY3RMb2NhdGlvbiwgdHJ1ZSlcbiAgICBjb25zdCBwYWNrYWdlSnNvbiA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhY2thZ2VKc29uUGF0aCkpXG5cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogcGFja2FnZUpzb24ubmFtZSxcbiAgICAgIHZlcnNpb246IHBhY2thZ2VKc29uLnZlcnNpb24sXG4gICAgICBkZXNjcmlwdGlvbjogcGFja2FnZUpzb24uZGVzY3JpcHRpb24gfHwgJzxubyBkZXNjcmlwdGlvbj4nLFxuICAgICAgYXV0aG9yOiBwYWNrYWdlSnNvbi5hdXRob3IgfHwgJzxubyBhdXRob3I+JyxcbiAgICAgIGxpY2Vuc2U6IHBhY2thZ2VKc29uLmxpY2Vuc2UgfHwgJ0FHUEwtdjMuMCdcbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBnZXRCb3RJbmZvcm1hdGlvbiB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2Fib3V0LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///71\n");

/***/ }),
/* 72 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _util = __webpack_require__(27);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _engine = __webpack_require__(73);\n\nvar _engine2 = _interopRequireDefault(_engine);\n\nvar _proactive = __webpack_require__(75);\n\nvar _proactive2 = _interopRequireDefault(_proactive);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar fs = _bluebird2.default.promisifyAll(__webpack_require__(2));\n\nmodule.exports = function (_ref) {\n  var getDocument = function () {\n    var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n      var _this = this;\n\n      var stats, _ret;\n\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fs.statAsync(storagePath);\n\n            case 2:\n              stats = _context2.sent;\n\n              if (!stats.isDirectory()) {\n                _context2.next = 8;\n                break;\n              }\n\n              return _context2.delegateYield(regeneratorRuntime.mark(function _callee() {\n                var files, contents;\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.next = 2;\n                        return fs.readdirAsync(storagePath);\n\n                      case 2:\n                        files = _context.sent;\n                        contents = {};\n\n\n                        files.forEach(function (file) {\n                          if (!file.endsWith('.yml')) {\n                            return;\n                          }\n\n                          var filename = _path2.default.basename(file, _path2.default.extname(file));\n                          contents[filename] = fs.readFileAsync(_path2.default.join(storagePath, file), 'utf8');\n                        });\n\n                        return _context.abrupt('return', {\n                          v: _bluebird2.default.props(contents)\n                        });\n\n                      case 6:\n                      case 'end':\n                        return _context.stop();\n                    }\n                  }\n                }, _callee, _this);\n              })(), 't0', 5);\n\n            case 5:\n              _ret = _context2.t0;\n\n              if (!((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\")) {\n                _context2.next = 8;\n                break;\n              }\n\n              return _context2.abrupt('return', _ret.v);\n\n            case 8:\n              return _context2.abrupt('return', fs.readFileAsync(storagePath, 'utf8'));\n\n            case 9:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function getDocument() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var sendBloc = function () {\n    var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(incomingEvent, blocName) {\n      var additionalData = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var initialData, itemName, contentItem, itemCategoryId, itemCategory, itemBloc, split, fileName, markdown, fullContext, blocs, bloc, error;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              blocName = blocName[0] === '#' ? blocName.substr(1) : blocName;\n\n              initialData = {};\n\n              if (!blocName.startsWith('!')) {\n                _context3.next = 20;\n                break;\n              }\n\n              itemName = blocName.substr(1);\n              _context3.next = 6;\n              return contentManager.getItem(itemName);\n\n            case 6:\n              contentItem = _context3.sent;\n\n              if (contentItem) {\n                _context3.next = 9;\n                break;\n              }\n\n              throw new Error('Could not find content item with ID \"' + itemName + '\" in the Content Manager');\n\n            case 9:\n              itemCategoryId = contentItem.categoryId;\n              _context3.next = 12;\n              return contentManager.getCategorySchema(itemCategoryId);\n\n            case 12:\n              itemCategory = _context3.sent;\n\n              if (itemCategory) {\n                _context3.next = 15;\n                break;\n              }\n\n              throw new Error('Could not find category \"' + itemCategoryId + '\" in the Content Manager' + (' for item with ID \"' + itemName + '\"'));\n\n            case 15:\n              itemBloc = itemCategory.ummBloc;\n\n              if (!(!_lodash2.default.isString(itemBloc) || !itemBloc.startsWith('#') || itemBloc.length <= 1)) {\n                _context3.next = 18;\n                break;\n              }\n\n              throw new Error('Invalid UMM bloc \"' + itemBloc + '\" in category ' + itemCategoryId + ' of Content Manager');\n\n            case 18:\n\n              blocName = itemBloc.substr(1);\n              initialData = Object.assign(initialData, contentItem.data);\n\n            case 20:\n              split = blocName.split('.');\n              fileName = null;\n\n\n              if (split.length === 2) {\n                fileName = split[0];\n                blocName = split[1];\n              }\n\n              _context3.next = 25;\n              return getDocument();\n\n            case 25:\n              markdown = _context3.sent;\n\n\n              // TODO Add more context\n              fullContext = Object.assign({}, initialData, {\n                user: incomingEvent.user,\n                originalEvent: incomingEvent\n              }, additionalData);\n\n              if (!_lodash2.default.isObject(markdown)) {\n                _context3.next = 33;\n                break;\n              }\n\n              if (fileName) {\n                _context3.next = 30;\n                break;\n              }\n\n              throw new Error('Unknown UMM bloc filename: ' + blocName);\n\n            case 30:\n              if (markdown[fileName]) {\n                _context3.next = 32;\n                break;\n              }\n\n              throw new Error('UMM content ' + fileName + '.yml not found');\n\n            case 32:\n\n              markdown = markdown[fileName];\n\n            case 33:\n              blocs = parse({\n                context: fullContext,\n                outputPlatform: incomingEvent.platform,\n                markdown: markdown,\n                incomingEvent: incomingEvent\n              });\n\n              // TODO check if message OK and catch errors\n              // TODO throw if bloc does not exist\n\n              bloc = blocs[blocName];\n\n              if (!_lodash2.default.isNil(bloc)) {\n                _context3.next = 39;\n                break;\n              }\n\n              error = '[UMM] Bloc not defined (#' + blocName + ')';\n\n              logger.error(error);\n              throw new Error(error);\n\n            case 39:\n              return _context3.abrupt('return', doSendBloc(bloc));\n\n            case 40:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function sendBloc(_x, _x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var logger = _ref.logger,\n      middlewares = _ref.middlewares,\n      botfile = _ref.botfile,\n      projectLocation = _ref.projectLocation,\n      db = _ref.db,\n      contentManager = _ref.contentManager;\n\n\n  var processors = {}; // A map of all the platforms that can process outgoing messages\n  var templates = {}; // A map of all the platforms templates\n  var storagePath = getStoragePath();\n\n  function registerConnector(_ref2) {\n    var platform = _ref2.platform,\n        processOutgoing = _ref2.processOutgoing,\n        templates = _ref2.templates;\n\n\n    // TODO throw if templates not array\n    // TODO throw if platform not string\n    // TODO throw if processOutgoing not a function\n    // TODO throw if platform already registered\n\n    logger.verbose('[UMM] Enabled for ' + platform); // TODO remove that\n\n    processors[platform] = processOutgoing;\n    templates[platform] = templates;\n  }\n\n  function parse(_ref3) {\n    var context = _ref3.context,\n        outputPlatform = _ref3.outputPlatform,\n        _ref3$markdown = _ref3.markdown,\n        markdown = _ref3$markdown === undefined ? null : _ref3$markdown,\n        _ref3$incomingEvent = _ref3.incomingEvent,\n        incomingEvent = _ref3$incomingEvent === undefined ? null : _ref3$incomingEvent;\n\n    // TODO throw if context empty\n\n    // TODO throw if markdown nil <<<==== Pick default markdown\n    // TODO throw if incomingEvents null <<<==== MOCK IT\n\n    var options = {\n      throwIfNoPlatform: true,\n      currentPlatform: outputPlatform\n    };\n\n    return (0, _engine2.default)({ markdown: markdown, context: context, options: options, processors: processors, incomingEvent: incomingEvent });\n  }\n\n  function getTemplates() {\n    return _lodash2.default.merge({}, templates); // Return a deep copy\n  }\n\n  function getStoragePath() {\n    var resolve = function resolve(file) {\n      return _path2.default.resolve(projectLocation, file);\n    };\n    var ummPath = _lodash2.default.get(botfile, 'umm.contentPath');\n\n    if (!ummPath) {\n      var single = resolve('content.yml');\n      var folder = resolve('content');\n\n      if (fs.existsSync(single)) {\n        ummPath = single;\n      } else if (fs.existsSync(folder)) {\n        ummPath = folder;\n      } else {\n        throw new Error('UMM content location not found');\n      }\n    }\n\n    if (_path2.default.isAbsolute(ummPath)) {\n      return ummPath;\n    } else {\n      return _path2.default.resolve(projectLocation, ummPath);\n    }\n  }\n\n  function saveDocument(content) {\n    if (_lodash2.default.isObject(content)) {\n      return _bluebird2.default.map(Object.keys(content), function (fileName) {\n        var filePath = _path2.default.join(storagePath, fileName + '.yml');\n        return fs.writeFileAsync(filePath, content[fileName], 'utf8');\n      });\n    }\n\n    return fs.writeFileAsync(storagePath, content, 'utf8');\n  }\n\n  function doSendBloc(bloc) {\n    return _bluebird2.default.mapSeries(bloc, function (message) {\n      if (message.__internal) {\n        if (message.type === 'wait') {\n          return _bluebird2.default.delay(message.wait);\n        }\n      } else {\n        return middlewares.sendOutgoing(message);\n      }\n    });\n  }\n\n  function processIncoming(event, next) {\n    event.reply = function (blocName) {\n      var additionalData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      return sendBloc(event, blocName, additionalData);\n    };\n\n    next();\n  }\n\n  var incomingMiddleware = {\n    name: 'UMM.instrumentation',\n    type: 'incoming',\n    order: 2, // Should really be first\n    module: 'botpress',\n    description: 'Built-in Botpress middleware that adds a `.reply` to events. Works with UMM.',\n    handler: processIncoming\n  };\n\n  var proactiveMethods = (0, _proactive2.default)({ sendBloc: sendBloc, db: db });\n\n  return _extends({ registerConnector: registerConnector, parse: parse, getTemplates: getTemplates, incomingMiddleware: incomingMiddleware, getDocument: getDocument, saveDocument: saveDocument }, proactiveMethods);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3VtbS9pbmRleC5qcz81ZDZiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgdXRpbCBmcm9tICd1dGlsJ1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IEVuZ2luZSBmcm9tICcuL2VuZ2luZSdcbmltcG9ydCBQcm9hY3RpdmUgZnJvbSAnLi9wcm9hY3RpdmUnXG5cbmNvbnN0IGZzID0gUHJvbWlzZS5wcm9taXNpZnlBbGwocmVxdWlyZSgnZnMnKSlcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBsb2dnZXIsIG1pZGRsZXdhcmVzLCBib3RmaWxlLCBwcm9qZWN0TG9jYXRpb24sIGRiLCBjb250ZW50TWFuYWdlciB9KSA9PiB7XG5cbiAgY29uc3QgcHJvY2Vzc29ycyA9IHt9IC8vIEEgbWFwIG9mIGFsbCB0aGUgcGxhdGZvcm1zIHRoYXQgY2FuIHByb2Nlc3Mgb3V0Z29pbmcgbWVzc2FnZXNcbiAgY29uc3QgdGVtcGxhdGVzID0ge30gLy8gQSBtYXAgb2YgYWxsIHRoZSBwbGF0Zm9ybXMgdGVtcGxhdGVzXG4gIGNvbnN0IHN0b3JhZ2VQYXRoID0gZ2V0U3RvcmFnZVBhdGgoKVxuXG4gIGZ1bmN0aW9uIHJlZ2lzdGVyQ29ubmVjdG9yKHsgcGxhdGZvcm0sIHByb2Nlc3NPdXRnb2luZywgdGVtcGxhdGVzIH0pIHtcblxuICAgIC8vIFRPRE8gdGhyb3cgaWYgdGVtcGxhdGVzIG5vdCBhcnJheVxuICAgIC8vIFRPRE8gdGhyb3cgaWYgcGxhdGZvcm0gbm90IHN0cmluZ1xuICAgIC8vIFRPRE8gdGhyb3cgaWYgcHJvY2Vzc091dGdvaW5nIG5vdCBhIGZ1bmN0aW9uXG4gICAgLy8gVE9ETyB0aHJvdyBpZiBwbGF0Zm9ybSBhbHJlYWR5IHJlZ2lzdGVyZWRcblxuICAgIGxvZ2dlci52ZXJib3NlKGBbVU1NXSBFbmFibGVkIGZvciAke3BsYXRmb3JtfWApIC8vIFRPRE8gcmVtb3ZlIHRoYXRcblxuICAgIHByb2Nlc3NvcnNbcGxhdGZvcm1dID0gcHJvY2Vzc091dGdvaW5nXG4gICAgdGVtcGxhdGVzW3BsYXRmb3JtXSA9IHRlbXBsYXRlc1xuICB9XG5cbiAgZnVuY3Rpb24gcGFyc2UoeyBjb250ZXh0LCBvdXRwdXRQbGF0Zm9ybSwgbWFya2Rvd24gPSBudWxsLCBpbmNvbWluZ0V2ZW50ID0gbnVsbCB9KSB7XG4gICAgLy8gVE9ETyB0aHJvdyBpZiBjb250ZXh0IGVtcHR5XG5cbiAgICAvLyBUT0RPIHRocm93IGlmIG1hcmtkb3duIG5pbCA8PDw9PT09IFBpY2sgZGVmYXVsdCBtYXJrZG93blxuICAgIC8vIFRPRE8gdGhyb3cgaWYgaW5jb21pbmdFdmVudHMgbnVsbCA8PDw9PT09IE1PQ0sgSVRcblxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICB0aHJvd0lmTm9QbGF0Zm9ybTogdHJ1ZSxcbiAgICAgIGN1cnJlbnRQbGF0Zm9ybTogb3V0cHV0UGxhdGZvcm1cbiAgICB9XG5cbiAgICByZXR1cm4gRW5naW5lKHsgbWFya2Rvd24sIGNvbnRleHQsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQgfSlcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFRlbXBsYXRlcygpIHtcbiAgICByZXR1cm4gXy5tZXJnZSh7fSwgdGVtcGxhdGVzKSAvLyBSZXR1cm4gYSBkZWVwIGNvcHlcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFN0b3JhZ2VQYXRoKCkge1xuICAgIGNvbnN0IHJlc29sdmUgPSBmaWxlID0+IHBhdGgucmVzb2x2ZShwcm9qZWN0TG9jYXRpb24sIGZpbGUpXG4gICAgbGV0IHVtbVBhdGggPSBfLmdldChib3RmaWxlLCAndW1tLmNvbnRlbnRQYXRoJylcblxuICAgIGlmICghdW1tUGF0aCkge1xuICAgICAgY29uc3Qgc2luZ2xlID0gcmVzb2x2ZSgnY29udGVudC55bWwnKVxuICAgICAgY29uc3QgZm9sZGVyID0gcmVzb2x2ZSgnY29udGVudCcpXG5cbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHNpbmdsZSkpIHtcbiAgICAgICAgdW1tUGF0aCA9IHNpbmdsZVxuICAgICAgfSBlbHNlIGlmIChmcy5leGlzdHNTeW5jKGZvbGRlcikpIHtcbiAgICAgICAgdW1tUGF0aCA9IGZvbGRlclxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVTU0gY29udGVudCBsb2NhdGlvbiBub3QgZm91bmQnKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwYXRoLmlzQWJzb2x1dGUodW1tUGF0aCkpIHtcbiAgICAgIHJldHVybiB1bW1QYXRoXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBwYXRoLnJlc29sdmUocHJvamVjdExvY2F0aW9uLCB1bW1QYXRoKVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNhdmVEb2N1bWVudChjb250ZW50KSB7XG4gICAgaWYgKF8uaXNPYmplY3QoY29udGVudCkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLm1hcChPYmplY3Qua2V5cyhjb250ZW50KSwgZmlsZU5hbWUgPT4ge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHBhdGguam9pbihzdG9yYWdlUGF0aCwgZmlsZU5hbWUgKyAnLnltbCcpXG4gICAgICAgIHJldHVybiBmcy53cml0ZUZpbGVBc3luYyhmaWxlUGF0aCwgY29udGVudFtmaWxlTmFtZV0sICd1dGY4JylcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGZzLndyaXRlRmlsZUFzeW5jKHN0b3JhZ2VQYXRoLCBjb250ZW50LCAndXRmOCcpXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBnZXREb2N1bWVudCgpIHtcbiAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGZzLnN0YXRBc3luYyhzdG9yYWdlUGF0aClcblxuICAgIGlmIChzdGF0cy5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICBjb25zdCBmaWxlcyA9IGF3YWl0IGZzLnJlYWRkaXJBc3luYyhzdG9yYWdlUGF0aClcbiAgICAgIGNvbnN0IGNvbnRlbnRzID0ge31cblxuICAgICAgZmlsZXMuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgICAgaWYgKCFmaWxlLmVuZHNXaXRoKCcueW1sJykpIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aC5iYXNlbmFtZShmaWxlLCBwYXRoLmV4dG5hbWUoZmlsZSkpXG4gICAgICAgIGNvbnRlbnRzW2ZpbGVuYW1lXSA9IGZzLnJlYWRGaWxlQXN5bmMocGF0aC5qb2luKHN0b3JhZ2VQYXRoLCBmaWxlKSwgJ3V0ZjgnKVxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIFByb21pc2UucHJvcHMoY29udGVudHMpXG4gICAgfVxuXG4gICAgcmV0dXJuIGZzLnJlYWRGaWxlQXN5bmMoc3RvcmFnZVBhdGgsICd1dGY4JylcbiAgfVxuXG4gIGZ1bmN0aW9uIGRvU2VuZEJsb2MoYmxvYykge1xuICAgIHJldHVybiBQcm9taXNlLm1hcFNlcmllcyhibG9jLCBtZXNzYWdlID0+IHtcbiAgICAgIGlmIChtZXNzYWdlLl9faW50ZXJuYWwpIHtcbiAgICAgICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ3dhaXQnKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UuZGVsYXkobWVzc2FnZS53YWl0KVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbWlkZGxld2FyZXMuc2VuZE91dGdvaW5nKG1lc3NhZ2UpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHNlbmRCbG9jKGluY29taW5nRXZlbnQsIGJsb2NOYW1lLCBhZGRpdGlvbmFsRGF0YSA9IHt9KSB7XG4gICAgYmxvY05hbWUgPSBibG9jTmFtZVswXSA9PT0gJyMnID8gYmxvY05hbWUuc3Vic3RyKDEpIDogYmxvY05hbWVcblxuICAgIGxldCBpbml0aWFsRGF0YSA9IHt9XG5cbiAgICBpZiAoYmxvY05hbWUuc3RhcnRzV2l0aCgnIScpKSB7XG4gICAgICBjb25zdCBpdGVtTmFtZSA9IGJsb2NOYW1lLnN1YnN0cigxKVxuICAgICAgY29uc3QgY29udGVudEl0ZW0gPSBhd2FpdCBjb250ZW50TWFuYWdlci5nZXRJdGVtKGl0ZW1OYW1lKVxuXG4gICAgICBpZiAoIWNvbnRlbnRJdGVtKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgY29udGVudCBpdGVtIHdpdGggSUQgXCIke2l0ZW1OYW1lfVwiIGluIHRoZSBDb250ZW50IE1hbmFnZXJgKVxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGNhdGVnb3J5SWQ6IGl0ZW1DYXRlZ29yeUlkIH0gPSBjb250ZW50SXRlbVxuXG4gICAgICBjb25zdCBpdGVtQ2F0ZWdvcnkgPSBhd2FpdCBjb250ZW50TWFuYWdlci5nZXRDYXRlZ29yeVNjaGVtYShpdGVtQ2F0ZWdvcnlJZClcblxuICAgICAgaWYgKCFpdGVtQ2F0ZWdvcnkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBjYXRlZ29yeSBcIiR7aXRlbUNhdGVnb3J5SWR9XCIgaW4gdGhlIENvbnRlbnQgTWFuYWdlcmAgXG4gICAgICAgICAgKyBgIGZvciBpdGVtIHdpdGggSUQgXCIke2l0ZW1OYW1lfVwiYClcbiAgICAgIH1cblxuICAgICAgY29uc3QgaXRlbUJsb2MgPSBpdGVtQ2F0ZWdvcnkudW1tQmxvY1xuICAgICAgaWYgKCFfLmlzU3RyaW5nKGl0ZW1CbG9jKSB8fCAhaXRlbUJsb2Muc3RhcnRzV2l0aCgnIycpIHx8IGl0ZW1CbG9jLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBVTU0gYmxvYyBcIiR7aXRlbUJsb2N9XCIgaW4gY2F0ZWdvcnkgJHtpdGVtQ2F0ZWdvcnlJZH0gb2YgQ29udGVudCBNYW5hZ2VyYClcbiAgICAgIH1cblxuICAgICAgYmxvY05hbWUgPSBpdGVtQmxvYy5zdWJzdHIoMSlcbiAgICAgIGluaXRpYWxEYXRhID0gT2JqZWN0LmFzc2lnbihpbml0aWFsRGF0YSwgY29udGVudEl0ZW0uZGF0YSlcbiAgICB9XG5cbiAgICBjb25zdCBzcGxpdCA9IGJsb2NOYW1lLnNwbGl0KCcuJylcbiAgICBsZXQgZmlsZU5hbWUgPSBudWxsXG5cbiAgICBpZiAoc3BsaXQubGVuZ3RoID09PSAyKSB7XG4gICAgICBmaWxlTmFtZSA9IHNwbGl0WzBdXG4gICAgICBibG9jTmFtZSA9IHNwbGl0WzFdXG4gICAgfVxuXG4gICAgbGV0IG1hcmtkb3duID0gYXdhaXQgZ2V0RG9jdW1lbnQoKVxuXG4gICAgLy8gVE9ETyBBZGQgbW9yZSBjb250ZXh0XG4gICAgY29uc3QgZnVsbENvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBpbml0aWFsRGF0YSwge1xuICAgICAgdXNlcjogaW5jb21pbmdFdmVudC51c2VyLFxuICAgICAgb3JpZ2luYWxFdmVudDogaW5jb21pbmdFdmVudFxuICAgIH0sIGFkZGl0aW9uYWxEYXRhKVxuXG4gICAgaWYgKF8uaXNPYmplY3QobWFya2Rvd24pKSB7XG4gICAgICBpZiAoIWZpbGVOYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBVTU0gYmxvYyBmaWxlbmFtZTogJHtibG9jTmFtZX1gKVxuICAgICAgfVxuXG4gICAgICBpZiAoIW1hcmtkb3duW2ZpbGVOYW1lXSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVNTSBjb250ZW50ICR7ZmlsZU5hbWV9LnltbCBub3QgZm91bmRgKVxuICAgICAgfVxuXG4gICAgICBtYXJrZG93biA9IG1hcmtkb3duW2ZpbGVOYW1lXVxuICAgIH1cblxuICAgIGxldCBibG9jcyA9IHBhcnNlKHtcbiAgICAgIGNvbnRleHQ6IGZ1bGxDb250ZXh0LFxuICAgICAgb3V0cHV0UGxhdGZvcm06IGluY29taW5nRXZlbnQucGxhdGZvcm0sXG4gICAgICBtYXJrZG93bjogbWFya2Rvd24sXG4gICAgICBpbmNvbWluZ0V2ZW50OiBpbmNvbWluZ0V2ZW50XG4gICAgfSlcblxuICAgIC8vIFRPRE8gY2hlY2sgaWYgbWVzc2FnZSBPSyBhbmQgY2F0Y2ggZXJyb3JzXG4gICAgLy8gVE9ETyB0aHJvdyBpZiBibG9jIGRvZXMgbm90IGV4aXN0XG5cbiAgICBjb25zdCBibG9jID0gYmxvY3NbYmxvY05hbWVdXG5cbiAgICBpZiAoXy5pc05pbChibG9jKSkge1xuICAgICAgY29uc3QgZXJyb3IgPSBgW1VNTV0gQmxvYyBub3QgZGVmaW5lZCAoIyR7YmxvY05hbWV9KWBcbiAgICAgIGxvZ2dlci5lcnJvcihlcnJvcilcbiAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvcilcbiAgICB9XG5cbiAgICByZXR1cm4gZG9TZW5kQmxvYyhibG9jKVxuICB9XG5cbiAgZnVuY3Rpb24gcHJvY2Vzc0luY29taW5nKGV2ZW50LCBuZXh0KSB7XG4gICAgZXZlbnQucmVwbHkgPSAoYmxvY05hbWUsIGFkZGl0aW9uYWxEYXRhID0ge30pID0+IHtcbiAgICAgIHJldHVybiBzZW5kQmxvYyhldmVudCwgYmxvY05hbWUsIGFkZGl0aW9uYWxEYXRhKVxuICAgIH1cblxuICAgIG5leHQoKVxuICB9XG5cbiAgY29uc3QgaW5jb21pbmdNaWRkbGV3YXJlID0ge1xuICAgIG5hbWU6ICdVTU0uaW5zdHJ1bWVudGF0aW9uJyxcbiAgICB0eXBlOiAnaW5jb21pbmcnLFxuICAgIG9yZGVyOiAyLCAvLyBTaG91bGQgcmVhbGx5IGJlIGZpcnN0XG4gICAgbW9kdWxlOiAnYm90cHJlc3MnLFxuICAgIGRlc2NyaXB0aW9uOiAnQnVpbHQtaW4gQm90cHJlc3MgbWlkZGxld2FyZSB0aGF0IGFkZHMgYSBgLnJlcGx5YCB0byBldmVudHMuIFdvcmtzIHdpdGggVU1NLicsXG4gICAgaGFuZGxlcjogcHJvY2Vzc0luY29taW5nXG4gIH1cblxuICBjb25zdCBwcm9hY3RpdmVNZXRob2RzID0gUHJvYWN0aXZlKHsgc2VuZEJsb2MsIGRiIH0pXG5cbiAgcmV0dXJuIHsgcmVnaXN0ZXJDb25uZWN0b3IsIHBhcnNlLCBnZXRUZW1wbGF0ZXMsIGluY29taW5nTWlkZGxld2FyZSwgZ2V0RG9jdW1lbnQsIHNhdmVEb2N1bWVudCwgLi4ucHJvYWN0aXZlTWV0aG9kcyB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3VtbS9pbmRleC5qcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUF3RUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZkE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBekVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBMEdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBTkE7QUFBQTtBQUNBO0FBREE7QUFPQTtBQUNBO0FBUkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQWFBO0FBYkE7QUFBQTtBQUNBO0FBREE7QUFlQTtBQUNBO0FBaEJBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFzQkE7QUFDQTtBQXZCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUEwQkE7QUFDQTtBQUNBO0FBN0JBO0FBK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXRDQTtBQUFBO0FBQ0E7QUFEQTtBQXVDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUEzQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUF1REE7QUFDQTtBQXpEQTtBQTJEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF0RUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXVFQTtBQUNBO0FBQUE7QUF6RUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUEzR0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWlGQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///72\n");

/***/ }),
/* 73 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _mustache = __webpack_require__(74);\n\nvar _mustache2 = _interopRequireDefault(_mustache);\n\nvar _jsYaml = __webpack_require__(19);\n\nvar _jsYaml2 = _interopRequireDefault(_jsYaml);\n\nvar _ms = __webpack_require__(14);\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ParsingError = function (_Error) {\n  _inherits(ParsingError, _Error);\n\n  function ParsingError(bloc, instructionIndex, error) {\n    _classCallCheck(this, ParsingError);\n\n    var _this = _possibleConstructorReturn(this, (ParsingError.__proto__ || Object.getPrototypeOf(ParsingError)).call(this, 'Error parsing bloc \\'' + bloc + '\\' at instruction ' + (instructionIndex + 1) + ': ' + error));\n\n    _this.bloc = bloc;\n    _this.instructionIndex = instructionIndex;\n    _this.internalMessage = error;\n    Error.captureStackTrace(_this, ParsingError);\n    return _this;\n  }\n\n  return ParsingError;\n}(Error);\n\nvar mapBlocs = function mapBlocs(rawBlocs, options, processors, incomingEvent) {\n  var currentPlatform = options.currentPlatform,\n      _options$throwIfNoPla = options.throwIfNoPlatform,\n      throwIfNoPlatform = _options$throwIfNoPla === undefined ? false : _options$throwIfNoPla;\n\n\n  if (!currentPlatform && throwIfNoPlatform) {\n    throw new Error('You need to supply `currentplatform`');\n  }\n\n  return _lodash2.default.mapValues(rawBlocs, mapBloc);\n\n  function premapInstruction(_ref) {\n    var instruction = _ref.instruction,\n        index = _ref.index,\n        instructions = _ref.instructions,\n        detectedPlatforms = _ref.detectedPlatforms,\n        bloc = _ref.bloc;\n\n\n    if (typeof instruction === 'string' || _lodash2.default.isArray(instruction)) {\n      return [{\n        text: instruction\n      }];\n    }\n\n    // Parsing conditionals\n    var evaluate = function evaluate(val, exp) {\n\n      if (typeof exp === 'boolean') {\n        return val === exp;\n      }if (_lodash2.default.isArrayLike(exp)) {\n        return val ? !_lodash2.default.isEmpty(exp) : _lodash2.default.isEmpty(exp);\n      } else {\n        return val ? !!exp : !exp;\n      }\n    };\n\n    if (!_lodash2.default.isNil(instruction.if) && !_lodash2.default.isNil(instruction.unless)) {\n      throw new ParsingError(bloc, index, \"Message can't be both 'if' and 'else'.\");\n    }\n\n    if (!_lodash2.default.isNil(instruction.unless) && !evaluate(false, instruction.unless)) {\n      return [];\n    }\n\n    if (!_lodash2.default.isNil(instruction.if) && !evaluate(true, instruction.if)) {\n      return [];\n    }\n\n    // Parsing \".on\"\n    var i = Object.assign({}, instruction);\n    if (instruction.on) {\n      if (typeof instruction.on === 'string') {\n        var platforms = instruction.on.toLowerCase().split('+').map(_lodash2.default.trim);\n        if (!_lodash2.default.includes(platforms, currentPlatform.toLowerCase())) {\n          return [];\n        } else {\n          i['__platformSpecific'] = true;\n        }\n      } else if (_lodash2.default.isPlainObject(instruction.on)) {\n        (function () {\n          var on = _lodash2.default.mapKeys(instruction.on, function (__, key) {\n            return key.toLowerCase();\n          });\n\n          // This allows multiple platforms to be specified\n          // e.g. \"messenger+slack+web\"\n          _lodash2.default.keys(on).forEach(function (key) {\n            if (key.indexOf('+') >= 0) {\n              _lodash2.default.split(key, '+').forEach(function (alias) {\n                var trimmed = _lodash2.default.trim(alias);\n                on[trimmed] = _lodash2.default.merge({}, on[trimmed] || {}, on[key]);\n              });\n            }\n          });\n\n          i = Object.assign(i, on[currentPlatform.toLowerCase()], { on: currentPlatform });\n        })();\n      } else {\n        throw new ParsingError(bloc, index, '\"on\" must be a string or a plain object but was a ' + _typeof(instruction.on));\n      }\n    }\n\n    return [i];\n  }\n\n  function mapInstruction(_ref2) {\n    var instruction = _ref2.instruction,\n        messages = _ref2.messages,\n        bloc = _ref2.bloc;\n\n    var ret = [];\n\n    if (!_lodash2.default.isNil(instruction.wait)) {\n      ret.push({\n        __internal: true,\n        type: 'wait',\n        wait: _lodash2.default.isString(instruction.wait) ? (0, _ms2.default)(instruction.wait || 1000) : parseInt(instruction.wait) || 1000\n      });\n    }\n\n    if (!_lodash2.default.isNil(instruction.typing)) {\n      instruction.typing = _lodash2.default.isString(instruction.typing) ? (0, _ms2.default)(instruction.typing || 1000) : parseInt(instruction.typing) || 1000;\n    }\n\n    var raw = _lodash2.default.omit(instruction, ['unless', 'if', 'on', 'wait']);\n\n    if (!_lodash2.default.keys(raw).length) {\n      return ret;\n    }\n\n    if (_lodash2.default.isArray(instruction.text)) {\n      instruction.text = _lodash2.default.sample(instruction.text);\n    }\n\n    var processor = currentPlatform && processors[currentPlatform];\n    if (processor) {\n      var msg = processor({ instruction: instruction, messages: messages, blocName: bloc, event: incomingEvent });\n      if (msg) {\n        ret.push(msg);\n      }\n\n      return ret;\n    }\n\n    throw new Error('Unsupported platform: ' + currentPlatform);\n  }\n\n  function mapBloc(bloc, name) {\n    // if the bloc isn't an array, error\n\n    var messages = [];\n    var detectedPlatforms = [];\n    var instructions = [];\n\n    // Premapping allows for modifications, drop and addition of instructions\n    _lodash2.default.forEach(bloc, function (instruction, index) {\n      var add = premapInstruction({\n        instruction: instruction,\n        index: index,\n        instructions: bloc,\n        detectedPlatforms: detectedPlatforms,\n        bloc: name\n      });\n\n      add && _lodash2.default.forEach(add, function (i) {\n        return instructions.push(i);\n      });\n    });\n\n    _lodash2.default.forEach(instructions, function (instruction) {\n      var m = mapInstruction({ instruction: instruction, messages: messages, bloc: name });\n\n      if (!_lodash2.default.isNil(m)) {\n        // Messages can be null when the instruction only modified existing messages\n        m.forEach(function (message) {\n          return messages.push(message);\n        });\n      }\n    });\n\n    return messages;\n  }\n}; // mapBlocs\n\nmodule.exports = function (_ref3) {\n  var markdown = _ref3.markdown,\n      context = _ref3.context,\n      options = _ref3.options,\n      processors = _ref3.processors,\n      incomingEvent = _ref3.incomingEvent;\n\n  _mustache2.default.parse(markdown);\n  var mustached = _mustache2.default.render(markdown, context);\n\n  // The reason we support multi-doc is that people might want to separate documents\n  // Both visually and practically when the file gets large\n  var rawBlocs = {};\n  _jsYaml2.default.safeLoadAll(mustached, function (rawBloc) {\n    return Object.assign(rawBlocs, rawBloc);\n  });\n\n  return mapBlocs(rawBlocs, options, processors, incomingEvent);\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3VtbS9lbmdpbmUuanM/MjA0NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTXVzdGFjaGUgZnJvbSAnbXVzdGFjaGUnXG5pbXBvcnQgeWFtbCBmcm9tICdqcy15YW1sJ1xuaW1wb3J0IG1zIGZyb20gJ21zJ1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuXG5jbGFzcyBQYXJzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKGJsb2MsIGluc3RydWN0aW9uSW5kZXgsIGVycm9yKSB7XG4gICAgc3VwZXIoYEVycm9yIHBhcnNpbmcgYmxvYyAnJHtibG9jfScgYXQgaW5zdHJ1Y3Rpb24gJHtpbnN0cnVjdGlvbkluZGV4ICsgMX06ICR7ZXJyb3J9YClcbiAgICB0aGlzLmJsb2MgPSBibG9jXG4gICAgdGhpcy5pbnN0cnVjdGlvbkluZGV4ID0gaW5zdHJ1Y3Rpb25JbmRleFxuICAgIHRoaXMuaW50ZXJuYWxNZXNzYWdlID0gZXJyb3JcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBQYXJzaW5nRXJyb3IpXG4gIH1cbn1cblxuY29uc3QgbWFwQmxvY3MgPSAocmF3QmxvY3MsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQpID0+IHtcblxuICBjb25zdCB7XG4gICAgY3VycmVudFBsYXRmb3JtLFxuICAgIHRocm93SWZOb1BsYXRmb3JtID0gZmFsc2VcbiAgfSA9IG9wdGlvbnNcblxuICBpZiAoIWN1cnJlbnRQbGF0Zm9ybSAmJiB0aHJvd0lmTm9QbGF0Zm9ybSkge1xuICAgIHRocm93IG5ldyBFcnJvcignWW91IG5lZWQgdG8gc3VwcGx5IGBjdXJyZW50cGxhdGZvcm1gJylcbiAgfVxuXG4gIHJldHVybiBfLm1hcFZhbHVlcyhyYXdCbG9jcywgbWFwQmxvYylcblxuICBmdW5jdGlvbiBwcmVtYXBJbnN0cnVjdGlvbih7IGluc3RydWN0aW9uLCBpbmRleCwgaW5zdHJ1Y3Rpb25zLCBkZXRlY3RlZFBsYXRmb3JtcywgYmxvYyB9KSB7XG5cbiAgICBpZiAodHlwZW9mIGluc3RydWN0aW9uID09PSAnc3RyaW5nJyB8fCBfLmlzQXJyYXkoaW5zdHJ1Y3Rpb24pKSB7XG4gICAgICByZXR1cm4gW3tcbiAgICAgICAgdGV4dDogaW5zdHJ1Y3Rpb25cbiAgICAgIH1dXG4gICAgfVxuXG4gICAgLy8gUGFyc2luZyBjb25kaXRpb25hbHNcbiAgICBjb25zdCBldmFsdWF0ZSA9ICh2YWwsIGV4cCkgPT4ge1xuXG4gICAgICBpZiAodHlwZW9mIGV4cCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIHJldHVybiB2YWwgPT09IGV4cFxuICAgICAgfSBpZiAoXy5pc0FycmF5TGlrZShleHApKSB7XG4gICAgICAgIHJldHVybiB2YWwgPyAhXy5pc0VtcHR5KGV4cCkgOiBfLmlzRW1wdHkoZXhwKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHZhbCA/ICEhZXhwIDogIWV4cFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24uaWYpICYmICFfLmlzTmlsKGluc3RydWN0aW9uLnVubGVzcykpIHtcbiAgICAgIHRocm93IG5ldyBQYXJzaW5nRXJyb3IoYmxvYywgaW5kZXgsIFwiTWVzc2FnZSBjYW4ndCBiZSBib3RoICdpZicgYW5kICdlbHNlJy5cIilcbiAgICB9XG5cbiAgICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24udW5sZXNzKSAmJiAhZXZhbHVhdGUoZmFsc2UsIGluc3RydWN0aW9uLnVubGVzcykpIHtcbiAgICAgIHJldHVybiBbXVxuICAgIH1cblxuICAgIGlmICghXy5pc05pbChpbnN0cnVjdGlvbi5pZikgJiYgIWV2YWx1YXRlKHRydWUsIGluc3RydWN0aW9uLmlmKSkge1xuICAgICAgcmV0dXJuIFtdXG4gICAgfVxuXG4gICAgLy8gUGFyc2luZyBcIi5vblwiXG4gICAgbGV0IGkgPSBPYmplY3QuYXNzaWduKHt9LCBpbnN0cnVjdGlvbilcbiAgICBpZiAoaW5zdHJ1Y3Rpb24ub24pIHtcbiAgICAgIGlmICh0eXBlb2YgaW5zdHJ1Y3Rpb24ub24gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnN0IHBsYXRmb3JtcyA9IGluc3RydWN0aW9uLm9uLnRvTG93ZXJDYXNlKCkuc3BsaXQoJysnKS5tYXAoXy50cmltKVxuICAgICAgICBpZiAoIV8uaW5jbHVkZXMocGxhdGZvcm1zLCBjdXJyZW50UGxhdGZvcm0udG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpWydfX3BsYXRmb3JtU3BlY2lmaWMnXSA9IHRydWVcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChfLmlzUGxhaW5PYmplY3QoaW5zdHJ1Y3Rpb24ub24pKSB7XG4gICAgICAgIGNvbnN0IG9uID0gXy5tYXBLZXlzKGluc3RydWN0aW9uLm9uLCAoX18sIGtleSkgPT4ga2V5LnRvTG93ZXJDYXNlKCkpXG5cbiAgICAgICAgLy8gVGhpcyBhbGxvd3MgbXVsdGlwbGUgcGxhdGZvcm1zIHRvIGJlIHNwZWNpZmllZFxuICAgICAgICAvLyBlLmcuIFwibWVzc2VuZ2VyK3NsYWNrK3dlYlwiXG4gICAgICAgIF8ua2V5cyhvbikuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgIGlmIChrZXkuaW5kZXhPZignKycpID49IDApIHtcbiAgICAgICAgICAgIF8uc3BsaXQoa2V5LCAnKycpLmZvckVhY2goYWxpYXMgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB0cmltbWVkID0gXy50cmltKGFsaWFzKVxuICAgICAgICAgICAgICBvblt0cmltbWVkXSA9IF8ubWVyZ2Uoe30sIG9uW3RyaW1tZWRdIHx8IHt9LCBvbltrZXldKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgaSA9IE9iamVjdC5hc3NpZ24oaSwgb25bY3VycmVudFBsYXRmb3JtLnRvTG93ZXJDYXNlKCldLCB7IG9uOiBjdXJyZW50UGxhdGZvcm0gfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBQYXJzaW5nRXJyb3IoYmxvYywgaW5kZXgsICdcIm9uXCIgbXVzdCBiZSBhIHN0cmluZyBvciBhIHBsYWluIG9iamVjdCBidXQgd2FzIGEgJyBcbiAgICAgICAgICArIHR5cGVvZihpbnN0cnVjdGlvbi5vbikpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFtpXVxuICB9XG5cbiAgZnVuY3Rpb24gbWFwSW5zdHJ1Y3Rpb24oeyBpbnN0cnVjdGlvbiwgbWVzc2FnZXMsIGJsb2MgfSkge1xuICAgIGNvbnN0IHJldCA9IFtdXG5cbiAgICBpZiAoIV8uaXNOaWwoaW5zdHJ1Y3Rpb24ud2FpdCkpIHtcbiAgICAgIHJldC5wdXNoKHtcbiAgICAgICAgX19pbnRlcm5hbDogdHJ1ZSxcbiAgICAgICAgdHlwZTogJ3dhaXQnLFxuICAgICAgICB3YWl0OiBfLmlzU3RyaW5nKGluc3RydWN0aW9uLndhaXQpXG4gICAgICAgICAgPyBtcyhpbnN0cnVjdGlvbi53YWl0IHx8IDEwMDAgKVxuICAgICAgICAgIDogKHBhcnNlSW50KGluc3RydWN0aW9uLndhaXQpIHx8IDEwMDApXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmICghXy5pc05pbChpbnN0cnVjdGlvbi50eXBpbmcpKSB7XG4gICAgICBpbnN0cnVjdGlvbi50eXBpbmcgPSBfLmlzU3RyaW5nKGluc3RydWN0aW9uLnR5cGluZylcbiAgICAgICAgPyBtcyhpbnN0cnVjdGlvbi50eXBpbmcgfHwgMTAwMClcbiAgICAgICAgOiAocGFyc2VJbnQoaW5zdHJ1Y3Rpb24udHlwaW5nKSB8fCAxMDAwKVxuICAgIH1cblxuICAgIGNvbnN0IHJhdyA9IF8ub21pdChpbnN0cnVjdGlvbiwgWyd1bmxlc3MnLCAnaWYnLCAnb24nLCAnd2FpdCddKVxuXG4gICAgaWYgKCFfLmtleXMocmF3KS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiByZXRcbiAgICB9XG5cbiAgICBpZiAoXy5pc0FycmF5KGluc3RydWN0aW9uLnRleHQpKSB7XG4gICAgICBpbnN0cnVjdGlvbi50ZXh0ID0gXy5zYW1wbGUoaW5zdHJ1Y3Rpb24udGV4dClcbiAgICB9XG5cbiAgICBjb25zdCBwcm9jZXNzb3IgPSBjdXJyZW50UGxhdGZvcm0gJiYgcHJvY2Vzc29yc1tjdXJyZW50UGxhdGZvcm1dXG4gICAgaWYgKHByb2Nlc3Nvcikge1xuICAgICAgY29uc3QgbXNnID0gcHJvY2Vzc29yKHsgaW5zdHJ1Y3Rpb24sIG1lc3NhZ2VzLCBibG9jTmFtZTogYmxvYywgZXZlbnQ6IGluY29taW5nRXZlbnQgfSlcbiAgICAgIGlmIChtc2cpIHtcbiAgICAgICAgcmV0LnB1c2gobXNnKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmV0XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBwbGF0Zm9ybTogJyArIGN1cnJlbnRQbGF0Zm9ybSlcbiAgfVxuXG4gIGZ1bmN0aW9uIG1hcEJsb2MoYmxvYywgbmFtZSkge1xuICAgIC8vIGlmIHRoZSBibG9jIGlzbid0IGFuIGFycmF5LCBlcnJvclxuXG4gICAgY29uc3QgbWVzc2FnZXMgPSBbXVxuICAgIGNvbnN0IGRldGVjdGVkUGxhdGZvcm1zID0gW11cbiAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBbXVxuXG4gICAgLy8gUHJlbWFwcGluZyBhbGxvd3MgZm9yIG1vZGlmaWNhdGlvbnMsIGRyb3AgYW5kIGFkZGl0aW9uIG9mIGluc3RydWN0aW9uc1xuICAgIF8uZm9yRWFjaChibG9jLCAoaW5zdHJ1Y3Rpb24sIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBhZGQgPSBwcmVtYXBJbnN0cnVjdGlvbih7IFxuICAgICAgICBpbnN0cnVjdGlvbiwgXG4gICAgICAgIGluZGV4LCBcbiAgICAgICAgaW5zdHJ1Y3Rpb25zOiBibG9jLCBcbiAgICAgICAgZGV0ZWN0ZWRQbGF0Zm9ybXMsIFxuICAgICAgICBibG9jOiBuYW1lXG4gICAgICB9KVxuXG4gICAgICBhZGQgJiYgXy5mb3JFYWNoKGFkZCwgaSA9PiBpbnN0cnVjdGlvbnMucHVzaChpKSlcbiAgICB9KVxuXG4gICAgXy5mb3JFYWNoKGluc3RydWN0aW9ucywgaW5zdHJ1Y3Rpb24gPT4ge1xuICAgICAgY29uc3QgbSA9IG1hcEluc3RydWN0aW9uKHsgaW5zdHJ1Y3Rpb24sIG1lc3NhZ2VzLCBibG9jOiBuYW1lIH0pXG5cbiAgICAgIGlmICghXy5pc05pbChtKSkge1xuICAgICAgICAvLyBNZXNzYWdlcyBjYW4gYmUgbnVsbCB3aGVuIHRoZSBpbnN0cnVjdGlvbiBvbmx5IG1vZGlmaWVkIGV4aXN0aW5nIG1lc3NhZ2VzXG4gICAgICAgIG0uZm9yRWFjaChtZXNzYWdlID0+IG1lc3NhZ2VzLnB1c2gobWVzc2FnZSkpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBtZXNzYWdlc1xuICB9XG5cbn0gLy8gbWFwQmxvY3NcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBtYXJrZG93biwgY29udGV4dCwgb3B0aW9ucywgcHJvY2Vzc29ycywgaW5jb21pbmdFdmVudCB9KSA9PiB7XG4gIE11c3RhY2hlLnBhcnNlKG1hcmtkb3duKVxuICBjb25zdCBtdXN0YWNoZWQgPSBNdXN0YWNoZS5yZW5kZXIobWFya2Rvd24sIGNvbnRleHQpXG5cbiAgLy8gVGhlIHJlYXNvbiB3ZSBzdXBwb3J0IG11bHRpLWRvYyBpcyB0aGF0IHBlb3BsZSBtaWdodCB3YW50IHRvIHNlcGFyYXRlIGRvY3VtZW50c1xuICAvLyBCb3RoIHZpc3VhbGx5IGFuZCBwcmFjdGljYWxseSB3aGVuIHRoZSBmaWxlIGdldHMgbGFyZ2VcbiAgY29uc3QgcmF3QmxvY3MgPSB7fVxuICB5YW1sLnNhZmVMb2FkQWxsKG11c3RhY2hlZCwgcmF3QmxvYyA9PiBPYmplY3QuYXNzaWduKHJhd0Jsb2NzLCByYXdCbG9jKSlcblxuICByZXR1cm4gbWFwQmxvY3MocmF3QmxvY3MsIG9wdGlvbnMsIHByb2Nlc3NvcnMsIGluY29taW5nRXZlbnQpXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3VtbS9lbmdpbmUuanMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7Ozs7Ozs7OztBQUNBOzs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU1BO0FBQ0E7O0FBUkE7QUFDQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWRBO0FBZUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBQ0E7QUFPQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///73\n");

/***/ }),
/* 74 */
/***/ (function(module, exports) {

eval("module.exports = require(\"mustache\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtdXN0YWNoZVwiP2IzYzgiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwibXVzdGFjaGVcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJtdXN0YWNoZVwiXG4vLyBtb2R1bGUgaWQgPSA3NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///74\n");

/***/ }),
/* 75 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _util = __webpack_require__(27);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var getUser = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee(id) {\n      var knex, users;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n              _context.next = 5;\n              return knex('users').where({ id: id }).orWhere('userId', id).limit(1).select('*');\n\n            case 5:\n              users = _context.sent;\n\n              if (!(!users || users.length <= 0)) {\n                _context.next = 8;\n                break;\n              }\n\n              throw new Error('User \"' + id + '\" not found in the database');\n\n            case 8:\n              return _context.abrupt('return', users[0]);\n\n            case 9:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function getUser(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Sends a proactive UMM message to a user\n   * @param  {string|object} user UserId or a full user object\n   * @param  {string} bloc The bloc name to send\n   * @param  {object} data Additional data to provide to the bloc\n   * @return {Promise}      A promise that the bloc is sent\n   */\n\n\n  var sendToUser = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(user, bloc, data) {\n      var text, forgedEvent;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (_lodash2.default.isString(bloc)) {\n                _context2.next = 2;\n                break;\n              }\n\n              throw new Error('Invalid bloc id: ' + bloc);\n\n            case 2:\n              if (!_lodash2.default.isString(user)) {\n                _context2.next = 6;\n                break;\n              }\n\n              _context2.next = 5;\n              return getUser(user);\n\n            case 5:\n              user = _context2.sent;\n\n            case 6:\n              if (!(!user || !user.id)) {\n                _context2.next = 8;\n                break;\n              }\n\n              throw new Error('Invalid user object: ' + _util2.default.inspect(user));\n\n            case 8:\n              text = 'This is not a real event, it has been forged by UMM.';\n              forgedEvent = {\n                platform: user.platform,\n                user: user,\n                type: 'proactive',\n                text: text,\n                raw: { forged: true, message: text, to: user && user.id }\n              };\n              return _context2.abrupt('return', sendBloc(forgedEvent, bloc, data));\n\n            case 11:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function sendToUser(_x2, _x3, _x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var sendBloc = _ref.sendBloc,\n      db = _ref.db;\n\n\n  return { sendToUser: sendToUser };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3VtbS9wcm9hY3RpdmUuanM/ZDVlYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXRpbCBmcm9tICd1dGlsJ1xuXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxubW9kdWxlLmV4cG9ydHMgPSAoeyBzZW5kQmxvYywgZGIgfSkgPT4ge1xuICBhc3luYyBmdW5jdGlvbiBnZXRVc2VyKGlkKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBrbmV4KCd1c2VycycpXG4gICAgICAud2hlcmUoeyBpZDogaWQgfSlcbiAgICAgIC5vcldoZXJlKCd1c2VySWQnLCBpZClcbiAgICAgIC5saW1pdCgxKVxuICAgICAgLnNlbGVjdCgnKicpXG5cbiAgICBpZiAoIXVzZXJzIHx8IHVzZXJzLmxlbmd0aCA8PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVzZXIgXCIke2lkfVwiIG5vdCBmb3VuZCBpbiB0aGUgZGF0YWJhc2VgKVxuICAgIH1cblxuICAgIHJldHVybiB1c2Vyc1swXVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRzIGEgcHJvYWN0aXZlIFVNTSBtZXNzYWdlIHRvIGEgdXNlclxuICAgKiBAcGFyYW0gIHtzdHJpbmd8b2JqZWN0fSB1c2VyIFVzZXJJZCBvciBhIGZ1bGwgdXNlciBvYmplY3RcbiAgICogQHBhcmFtICB7c3RyaW5nfSBibG9jIFRoZSBibG9jIG5hbWUgdG8gc2VuZFxuICAgKiBAcGFyYW0gIHtvYmplY3R9IGRhdGEgQWRkaXRpb25hbCBkYXRhIHRvIHByb3ZpZGUgdG8gdGhlIGJsb2NcbiAgICogQHJldHVybiB7UHJvbWlzZX0gICAgICBBIHByb21pc2UgdGhhdCB0aGUgYmxvYyBpcyBzZW50XG4gICAqL1xuICBhc3luYyBmdW5jdGlvbiBzZW5kVG9Vc2VyKHVzZXIsIGJsb2MsIGRhdGEpIHtcbiAgICBpZiAoIV8uaXNTdHJpbmcoYmxvYykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBibG9jIGlkOiAnICsgYmxvYylcbiAgICB9XG5cbiAgICBpZiAoXy5pc1N0cmluZyh1c2VyKSkge1xuICAgICAgdXNlciA9IGF3YWl0IGdldFVzZXIodXNlcilcbiAgICB9XG5cbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB1c2VyIG9iamVjdDogJyArIHV0aWwuaW5zcGVjdCh1c2VyKSlcbiAgICB9XG5cbiAgICBjb25zdCB0ZXh0ID0gJ1RoaXMgaXMgbm90IGEgcmVhbCBldmVudCwgaXQgaGFzIGJlZW4gZm9yZ2VkIGJ5IFVNTS4nXG4gICAgY29uc3QgZm9yZ2VkRXZlbnQgPSB7XG4gICAgICBwbGF0Zm9ybTogdXNlci5wbGF0Zm9ybSxcbiAgICAgIHVzZXI6IHVzZXIsXG4gICAgICB0eXBlOiAncHJvYWN0aXZlJyxcbiAgICAgIHRleHQ6IHRleHQsXG4gICAgICByYXc6IHsgZm9yZ2VkOiB0cnVlLCBtZXNzYWdlOiB0ZXh0LCB0bzogdXNlciAmJiB1c2VyLmlkIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc2VuZEJsb2MoZm9yZ2VkRXZlbnQsIGJsb2MsIGRhdGEpXG4gIH1cblxuICByZXR1cm4geyBzZW5kVG9Vc2VyIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvdW1tL3Byb2FjdGl2ZS5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7Ozs7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBZUE7Ozs7Ozs7OztBQWhCQTtBQUFBO0FBdUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBTUE7QUFDQTtBQVBBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQWFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFkQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXhCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBQ0E7QUE4Q0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///75\n");

/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var tag = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee(userId, tag) {\n      var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var knex;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context.sent;\n\n\n              tag = _lodash2.default.toUpper(tag);\n\n              _context.next = 6;\n              return hasTag(userId, tag);\n\n            case 6:\n              if (!_context.sent) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 9;\n              return knex('users_tags').where({ userId: userId, tag: tag }).update({\n                userId: userId,\n                tag: tag,\n                value: value,\n                tagged_on: (0, _helpers2.default)(knex).date.now()\n              }).then();\n\n            case 9:\n              _context.next = 13;\n              break;\n\n            case 11:\n              _context.next = 13;\n              return knex('users_tags').insert({\n                userId: userId,\n                tag: tag,\n                value: value,\n                tagged_on: (0, _helpers2.default)(knex).date.now()\n              }).then();\n\n            case 13:\n              return _context.abrupt('return', true);\n\n            case 14:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function tag(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var untag = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(userId, tag) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context2.sent;\n              return _context2.abrupt('return', knex('users_tags').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).del().then());\n\n            case 4:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function untag(_x4, _x5) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var hasTag = function () {\n    var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(userId, tag) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context3.sent;\n              return _context3.abrupt('return', knex('users_tags').select('userId').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).limit(1).then(function (ret) {\n                return ret.length > 0;\n              }));\n\n            case 4:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function hasTag(_x6, _x7) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var getTag = function () {\n    var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4(userId, tag) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context4.sent;\n              return _context4.abrupt('return', knex('users_tags').select('value').where({ userId: userId, tag: _lodash2.default.toUpper(tag) }).limit(1).then().get(0).then(function (ret) {\n                return ret && ret.value;\n              }));\n\n            case 4:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    return function getTag(_x8, _x9) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var getTags = function () {\n    var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(userId) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context5.sent;\n              return _context5.abrupt('return', knex('users_tags').where({ userId: userId }).select('tag', 'value').then(function (tags) {\n                return _lodash2.default.map(tags, function (v) {\n                  return { tag: v.tag, value: v.value };\n                });\n              }));\n\n            case 4:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    return function getTags(_x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  // TODO: Fix this, list of tags is always empty\n\n\n  var list = function () {\n    var _ref7 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6() {\n      var limit = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;\n      var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var knex, isLite, selectTags, subQuery;\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context6.sent;\n              isLite = (0, _helpers2.default)(knex).isLite();\n              selectTags = isLite ? 'group_concat(tag) as tags' : \"string_agg(tag, ',') as tags\";\n              subQuery = knex('users_tags').select('userId', knex.raw(selectTags)).groupBy('userId');\n              return _context6.abrupt('return', knex('users').leftJoin(knex.raw('(' + subQuery.toString() + ') AS t2'), 'users.id', '=', 't2.userId').select('users.userId', 'users.platform', 'users.gender', 'users.timezone', 'users.locale', 'users.picture_url', 'users.first_name', 'users.last_name', 'users.created_on', 't2.tags').orderBy('users.created_on', 'asc').offset(from).limit(limit).then(function (users) {\n                return users.map(function (x) {\n                  return Object.assign(x, {\n                    tags: x.tags && x.tags.split(',') || []\n                  });\n                });\n              }));\n\n            case 7:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    return function list() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  // TODO: Fix this, just doesn't work\n\n\n  var listWithTags = function () {\n    var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7(tags) {\n      var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 50;\n      var from = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n      var knex, filterByTag, isLite, selectTags, query, i, subQuery;\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              _context7.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context7.sent;\n\n\n              tags = _lodash2.default.filter(tags, function (t) {\n                return _lodash2.default.isString(t);\n              }).map(function (t) {\n                return t.toUpperCase();\n              });\n\n              filterByTag = function filterByTag(tag) {\n                return knex('users_tags').select('userId').where('tag', tag);\n              };\n\n              isLite = (0, _helpers2.default)(knex).isLite();\n              selectTags = isLite ? 'group_concat(tag) as tags' : \"string_agg(tag, ',') as tags\";\n              query = knex('users');\n              i = 0;\n              subQuery = knex('users_tags').select('userId', knex.raw(selectTags)).groupBy('userId');\n\n\n              tags.forEach(function (tag) {\n                var name = 't' + ++i;\n                query = query.join(knex.raw('(' + filterByTag(tag).toString() + ') AS ' + name), 'users.id', '=', name + '.userId');\n              });\n\n              return _context7.abrupt('return', query.leftJoin(knex.raw('(' + subQuery.toString() + ') AS tt'), 'users.id', '=', 'tt.userId').select('users.userId as userId', 'users.platform as platform', 'users.gender as gender', 'users.timezone as timezone', 'users.locale as locale', 'users.picture_url as picture_url', 'users.first_name as first_name', 'users.last_name as last_name', 'users.created_on as created_on', 'tt.tags as tags').orderBy('users.created_on', 'asc').offset(from).limit(limit).then(function (users) {\n                return users.map(function (x) {\n                  return Object.assign(x, {\n                    tags: x.tags && x.tags.split(',') || []\n                  });\n                });\n              }));\n\n            case 12:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    return function listWithTags(_x13) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var count = function () {\n    var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee8() {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context8.sent;\n              return _context8.abrupt('return', knex('users').count('* as count').then().get(0).then(function (ret) {\n                return parseInt(ret && ret.count);\n              }));\n\n            case 4:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    return function count() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var db = _ref.db;\n\n\n  return { tag: tag, untag: untag, hasTag: hasTag, getTag: getTag, getTags: getTags, list: list, count: count, listWithTags: listWithTags };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3VzZXJzLmpzPzQ1MTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IGhlbHBlcnMgZnJvbSAnLi9kYXRhYmFzZS9oZWxwZXJzJ1xuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGRiIH0pID0+IHtcbiAgYXN5bmMgZnVuY3Rpb24gdGFnKHVzZXJJZCwgdGFnLCB2YWx1ZSA9IHRydWUpIHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIHRhZyA9IF8udG9VcHBlcih0YWcpXG5cbiAgICBpZiAoYXdhaXQgaGFzVGFnKHVzZXJJZCwgdGFnKSkge1xuICAgICAgYXdhaXQga25leCgndXNlcnNfdGFncycpXG4gICAgICAgIC53aGVyZSh7IHVzZXJJZCwgdGFnIH0pXG4gICAgICAgIC51cGRhdGUoe1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICB0YWcsXG4gICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgdGFnZ2VkX29uOiBoZWxwZXJzKGtuZXgpLmRhdGUubm93KClcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIHRhZyxcbiAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICB0YWdnZWRfb246IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuICAgICAgICB9KVxuICAgICAgICAudGhlbigpXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHVudGFnKHVzZXJJZCwgdGFnKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4ga25leCgndXNlcnNfdGFncycpXG4gICAgICAud2hlcmUoeyB1c2VySWQsIHRhZzogXy50b1VwcGVyKHRhZykgfSlcbiAgICAgIC5kZWwoKVxuICAgICAgLnRoZW4oKVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gaGFzVGFnKHVzZXJJZCwgdGFnKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4ga25leCgndXNlcnNfdGFncycpXG4gICAgICAuc2VsZWN0KCd1c2VySWQnKVxuICAgICAgLndoZXJlKHsgdXNlcklkLCB0YWc6IF8udG9VcHBlcih0YWcpIH0pXG4gICAgICAubGltaXQoMSlcbiAgICAgIC50aGVuKHJldCA9PiByZXQubGVuZ3RoID4gMClcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGdldFRhZyh1c2VySWQsIHRhZykge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgcmV0dXJuIGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgLnNlbGVjdCgndmFsdWUnKVxuICAgICAgLndoZXJlKHsgdXNlcklkLCB0YWc6IF8udG9VcHBlcih0YWcpIH0pXG4gICAgICAubGltaXQoMSlcbiAgICAgIC50aGVuKClcbiAgICAgIC5nZXQoMClcbiAgICAgIC50aGVuKHJldCA9PiByZXQgJiYgcmV0LnZhbHVlKVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZ2V0VGFncyh1c2VySWQpIHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIHJldHVybiBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgIC53aGVyZSh7IHVzZXJJZCB9KVxuICAgICAgLnNlbGVjdCgndGFnJywgJ3ZhbHVlJylcbiAgICAgIC50aGVuKHRhZ3MgPT4ge1xuICAgICAgICByZXR1cm4gXy5tYXAodGFncywgdiA9PiB7XG4gICAgICAgICAgcmV0dXJuIHsgdGFnOiB2LnRhZywgdmFsdWU6IHYudmFsdWUgfVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgfVxuICBcbiAgLy8gVE9ETzogRml4IHRoaXMsIGxpc3Qgb2YgdGFncyBpcyBhbHdheXMgZW1wdHlcbiAgYXN5bmMgZnVuY3Rpb24gbGlzdChsaW1pdCA9IDUwLCBmcm9tID0gMCkge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3QgaXNMaXRlID0gaGVscGVycyhrbmV4KS5pc0xpdGUoKVxuXG4gICAgY29uc3Qgc2VsZWN0VGFncyA9IGlzTGl0ZSA/ICdncm91cF9jb25jYXQodGFnKSBhcyB0YWdzJyA6IFwic3RyaW5nX2FnZyh0YWcsICcsJykgYXMgdGFnc1wiXG5cbiAgICBjb25zdCBzdWJRdWVyeSA9IGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgLnNlbGVjdCgndXNlcklkJywga25leC5yYXcoc2VsZWN0VGFncykpXG4gICAgICAuZ3JvdXBCeSgndXNlcklkJylcblxuICAgIHJldHVybiBrbmV4KCd1c2VycycpXG4gICAgICAubGVmdEpvaW4oa25leC5yYXcoJygnICsgc3ViUXVlcnkudG9TdHJpbmcoKSArICcpIEFTIHQyJyksICd1c2Vycy5pZCcsICc9JywgJ3QyLnVzZXJJZCcpXG4gICAgICAuc2VsZWN0KFxuICAgICAgICAndXNlcnMudXNlcklkJyxcbiAgICAgICAgJ3VzZXJzLnBsYXRmb3JtJyxcbiAgICAgICAgJ3VzZXJzLmdlbmRlcicsXG4gICAgICAgICd1c2Vycy50aW1lem9uZScsXG4gICAgICAgICd1c2Vycy5sb2NhbGUnLFxuICAgICAgICAndXNlcnMucGljdHVyZV91cmwnLFxuICAgICAgICAndXNlcnMuZmlyc3RfbmFtZScsXG4gICAgICAgICd1c2Vycy5sYXN0X25hbWUnLFxuICAgICAgICAndXNlcnMuY3JlYXRlZF9vbicsXG4gICAgICAgICd0Mi50YWdzJ1xuICAgICAgKVxuICAgICAgLm9yZGVyQnkoJ3VzZXJzLmNyZWF0ZWRfb24nLCAnYXNjJylcbiAgICAgIC5vZmZzZXQoZnJvbSlcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC50aGVuKHVzZXJzID0+XG4gICAgICAgIHVzZXJzLm1hcCh4ID0+XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbih4LCB7XG4gICAgICAgICAgICB0YWdzOiAoeC50YWdzICYmIHgudGFncy5zcGxpdCgnLCcpKSB8fCBbXVxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgfVxuICBcbiAgLy8gVE9ETzogRml4IHRoaXMsIGp1c3QgZG9lc24ndCB3b3JrXG4gIGFzeW5jIGZ1bmN0aW9uIGxpc3RXaXRoVGFncyh0YWdzLCBsaW1pdCA9IDUwLCBmcm9tID0gMCkge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgdGFncyA9IF8uZmlsdGVyKHRhZ3MsIHQgPT4gXy5pc1N0cmluZyh0KSkubWFwKHQgPT4gdC50b1VwcGVyQ2FzZSgpKVxuICAgIGNvbnN0IGZpbHRlckJ5VGFnID0gdGFnID0+XG4gICAgICBrbmV4KCd1c2Vyc190YWdzJylcbiAgICAgICAgLnNlbGVjdCgndXNlcklkJylcbiAgICAgICAgLndoZXJlKCd0YWcnLCB0YWcpXG5cbiAgICBjb25zdCBpc0xpdGUgPSBoZWxwZXJzKGtuZXgpLmlzTGl0ZSgpXG4gICAgY29uc3Qgc2VsZWN0VGFncyA9IGlzTGl0ZSA/ICdncm91cF9jb25jYXQodGFnKSBhcyB0YWdzJyA6IFwic3RyaW5nX2FnZyh0YWcsICcsJykgYXMgdGFnc1wiXG5cbiAgICBsZXQgcXVlcnkgPSBrbmV4KCd1c2VycycpXG4gICAgbGV0IGkgPSAwXG5cbiAgICBjb25zdCBzdWJRdWVyeSA9IGtuZXgoJ3VzZXJzX3RhZ3MnKVxuICAgICAgLnNlbGVjdCgndXNlcklkJywga25leC5yYXcoc2VsZWN0VGFncykpXG4gICAgICAuZ3JvdXBCeSgndXNlcklkJylcblxuICAgIHRhZ3MuZm9yRWFjaCh0YWcgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9ICd0JyArICsraVxuICAgICAgcXVlcnkgPSBxdWVyeS5qb2luKFxuICAgICAgICBrbmV4LnJhdygnKCcgKyBmaWx0ZXJCeVRhZyh0YWcpLnRvU3RyaW5nKCkgKyAnKSBBUyAnICsgbmFtZSksXG4gICAgICAgICd1c2Vycy5pZCcsXG4gICAgICAgICc9JyxcbiAgICAgICAgbmFtZSArICcudXNlcklkJ1xuICAgICAgKVxuICAgIH0pXG5cbiAgICByZXR1cm4gcXVlcnlcbiAgICAgIC5sZWZ0Sm9pbihrbmV4LnJhdygnKCcgKyBzdWJRdWVyeS50b1N0cmluZygpICsgJykgQVMgdHQnKSwgJ3VzZXJzLmlkJywgJz0nLCAndHQudXNlcklkJylcbiAgICAgIC5zZWxlY3QoXG4gICAgICAgICd1c2Vycy51c2VySWQgYXMgdXNlcklkJyxcbiAgICAgICAgJ3VzZXJzLnBsYXRmb3JtIGFzIHBsYXRmb3JtJyxcbiAgICAgICAgJ3VzZXJzLmdlbmRlciBhcyBnZW5kZXInLFxuICAgICAgICAndXNlcnMudGltZXpvbmUgYXMgdGltZXpvbmUnLFxuICAgICAgICAndXNlcnMubG9jYWxlIGFzIGxvY2FsZScsXG4gICAgICAgICd1c2Vycy5waWN0dXJlX3VybCBhcyBwaWN0dXJlX3VybCcsXG4gICAgICAgICd1c2Vycy5maXJzdF9uYW1lIGFzIGZpcnN0X25hbWUnLFxuICAgICAgICAndXNlcnMubGFzdF9uYW1lIGFzIGxhc3RfbmFtZScsXG4gICAgICAgICd1c2Vycy5jcmVhdGVkX29uIGFzIGNyZWF0ZWRfb24nLFxuICAgICAgICAndHQudGFncyBhcyB0YWdzJ1xuICAgICAgKVxuICAgICAgLm9yZGVyQnkoJ3VzZXJzLmNyZWF0ZWRfb24nLCAnYXNjJylcbiAgICAgIC5vZmZzZXQoZnJvbSlcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC50aGVuKHVzZXJzID0+XG4gICAgICAgIHVzZXJzLm1hcCh4ID0+XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbih4LCB7XG4gICAgICAgICAgICB0YWdzOiAoeC50YWdzICYmIHgudGFncy5zcGxpdCgnLCcpKSB8fCBbXVxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGNvdW50KCkge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgcmV0dXJuIGtuZXgoJ3VzZXJzJylcbiAgICAgIC5jb3VudCgnKiBhcyBjb3VudCcpXG4gICAgICAudGhlbigpXG4gICAgICAuZ2V0KDApXG4gICAgICAudGhlbihyZXQgPT4gcGFyc2VJbnQocmV0ICYmIHJldC5jb3VudCkpXG4gIH1cblxuICByZXR1cm4geyB0YWcsIHVudGFnLCBoYXNUYWcsIGdldFRhZywgZ2V0VGFncywgbGlzdCwgY291bnQsIGxpc3RXaXRoVGFncyB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3VzZXJzLmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFKQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBVEE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUNBO0FBbEJBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQThCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBL0JBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBdUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFPQTtBQUFBO0FBQ0E7QUFSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBeENBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBaURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFTQTtBQUFBO0FBQ0E7QUFWQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBbERBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBNkRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQTlEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBeUVBO0FBQ0E7QUFDQTtBQTVFQTtBQUFBO0FBMkVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQVBBO0FBNEJBO0FBQ0E7QUFFQTtBQURBO0FBREE7QUFEQTtBQUNBO0FBN0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUE1RUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQStHQTtBQUNBO0FBQ0E7QUFsSEE7QUFBQTtBQWlIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQU1BO0FBQ0E7QUE1QkE7QUE4Q0E7QUFDQTtBQUVBO0FBREE7QUFEQTtBQURBO0FBQ0E7QUEvQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWxIQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQXdLQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBT0E7QUFBQTtBQUNBO0FBUkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXpLQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBZ0xBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///76\n");

/***/ }),
/* 77 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _glob = __webpack_require__(78);\n\nvar _glob2 = _interopRequireDefault(_glob);\n\nvar _uuid = __webpack_require__(13);\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nvar _helpers = __webpack_require__(5);\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (_ref) {\n  var scanAndRegisterCategories = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n      var formDir, searchOptions, files;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              categories = [];\n\n              formDir = _path2.default.resolve(projectLocation, botfile.formsDir || './content/forms');\n\n              if (_fs2.default.existsSync(formDir)) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt('return', categories);\n\n            case 4:\n              searchOptions = { cwd: formDir };\n              _context.next = 7;\n              return _bluebird2.default.fromCallback(function (callback) {\n                return (0, _glob2.default)('**/*.form.js', searchOptions, callback);\n              });\n\n            case 7:\n              files = _context.sent;\n\n\n              files.forEach(function (file) {\n                try {\n                  (function () {\n                    var filePath = _path2.default.resolve(formDir, './' + file);\n                    // eslint-disable-next-line no-eval\n                    var category = eval('require')(filePath); // Dynamic loading require eval for Webpack\n                    var requiredFields = ['id', 'title', 'jsonSchema'];\n\n                    requiredFields.forEach(function (field) {\n                      if (_lodash2.default.isNil(category[field])) {\n                        throw new Error(field + ' is required but missing in Content Form file: ' + file);\n                      }\n                    });\n\n                    category.id = category.id.toLowerCase();\n\n                    if (_lodash2.default.find(categories, { id: category.id })) {\n                      throw new Error('There is already a form with id=' + category.id);\n                    }\n\n                    categories.push(category);\n                  })();\n                } catch (err) {\n                  logger.warn('[Content Manager] Could not load Form: ' + file, err);\n                }\n              });\n\n              return _context.abrupt('return', categories);\n\n            case 10:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function scanAndRegisterCategories() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var listAvailableCategories = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3() {\n      var _this = this;\n\n      var knex;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context3.sent;\n              _context3.next = 5;\n              return _bluebird2.default.map(categories, function () {\n                var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(category) {\n                  var count;\n                  return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.next = 2;\n                          return knex('content_items').where({ categoryId: category.id }).select(knex.raw('count(*) as count')).then().get(0).then(function (row) {\n                            return row && row.count || 0;\n                          });\n\n                        case 2:\n                          count = _context2.sent;\n                          return _context2.abrupt('return', {\n                            id: category.id,\n                            title: category.title,\n                            description: category.description,\n                            count: count\n                          });\n\n                        case 4:\n                        case 'end':\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2, _this);\n                }));\n\n                return function (_x) {\n                  return _ref4.apply(this, arguments);\n                };\n              }());\n\n            case 5:\n              return _context3.abrupt('return', _context3.sent);\n\n            case 6:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function listAvailableCategories() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var getCategorySchema = function () {\n    var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4(categoryId) {\n      var category;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              category = _lodash2.default.find(categories, { id: categoryId });\n\n              if (!_lodash2.default.isNil(category)) {\n                _context4.next = 3;\n                break;\n              }\n\n              return _context4.abrupt('return', null);\n\n            case 3:\n              return _context4.abrupt('return', {\n                json: category.jsonSchema,\n                ui: category.uiSchema,\n                title: category.title,\n                description: category.description,\n                ummBloc: category.ummBloc\n              });\n\n            case 4:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    return function getCategorySchema(_x2) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var createOrUpdateCategoryItem = function () {\n    var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(_ref7) {\n      var itemId = _ref7.itemId,\n          categoryId = _ref7.categoryId,\n          formData = _ref7.formData;\n      var category, data, metadata, previewText, prefix, randomId, knex, body;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              categoryId = categoryId && categoryId.toLowerCase();\n              category = _lodash2.default.find(categories, { id: categoryId });\n\n              if (!_lodash2.default.isNil(category)) {\n                _context5.next = 4;\n                break;\n              }\n\n              throw new Error('Category \"' + categoryId + '\" is not a valid registered categoryId');\n\n            case 4:\n              if (!(_lodash2.default.isNil(formData) || !_lodash2.default.isObject(formData))) {\n                _context5.next = 6;\n                break;\n              }\n\n              throw new Error('\"formData\" must be a valid object');\n\n            case 6:\n              _context5.t1 = category.computeFormData;\n\n              if (!_context5.t1) {\n                _context5.next = 11;\n                break;\n              }\n\n              _context5.next = 10;\n              return category.computeFormData(formData);\n\n            case 10:\n              _context5.t1 = _context5.sent;\n\n            case 11:\n              _context5.t0 = _context5.t1;\n\n              if (_context5.t0) {\n                _context5.next = 14;\n                break;\n              }\n\n              _context5.t0 = formData;\n\n            case 14:\n              data = _context5.t0;\n              _context5.t3 = category.computeMetadata;\n\n              if (!_context5.t3) {\n                _context5.next = 20;\n                break;\n              }\n\n              _context5.next = 19;\n              return category.computeMetadata(formData);\n\n            case 19:\n              _context5.t3 = _context5.sent;\n\n            case 20:\n              _context5.t2 = _context5.t3;\n\n              if (_context5.t2) {\n                _context5.next = 23;\n                break;\n              }\n\n              _context5.t2 = [];\n\n            case 23:\n              metadata = _context5.t2;\n              _context5.t5 = category.computePreviewText;\n\n              if (!_context5.t5) {\n                _context5.next = 29;\n                break;\n              }\n\n              _context5.next = 28;\n              return category.computePreviewText(formData);\n\n            case 28:\n              _context5.t5 = _context5.sent;\n\n            case 29:\n              _context5.t4 = _context5.t5;\n\n              if (_context5.t4) {\n                _context5.next = 32;\n                break;\n              }\n\n              _context5.t4 = 'No preview';\n\n            case 32:\n              previewText = _context5.t4;\n\n              if (_lodash2.default.isArray(metadata)) {\n                _context5.next = 35;\n                break;\n              }\n\n              throw new Error('computeMetadata must return an array of string');\n\n            case 35:\n              if (_lodash2.default.isString(previewText)) {\n                _context5.next = 37;\n                break;\n              }\n\n              throw new Error('computePreviewText must return a string');\n\n            case 37:\n              if (!(_lodash2.default.isNil(data) || !_lodash2.default.isObject(data))) {\n                _context5.next = 39;\n                break;\n              }\n\n              throw new Error('computeFormData must return a valid object');\n\n            case 39:\n              prefix = category.ummBloc || categoryId;\n\n\n              if (prefix.startsWith('#')) {\n                prefix = prefix.substr(1);\n              }\n\n              randomId = prefix + '-' + _uuid2.default.v4().split('-').join('').substr(0, 6);\n              _context5.next = 44;\n              return db.get();\n\n            case 44:\n              knex = _context5.sent;\n              body = {\n                data: JSON.stringify(data),\n                formData: JSON.stringify(formData),\n                metadata: '|' + metadata.join('|') + '|',\n                previewText: previewText,\n                created_by: 'admin',\n                created_on: (0, _helpers2.default)(knex).date.now()\n              };\n\n              if (!itemId) {\n                _context5.next = 50;\n                break;\n              }\n\n              _context5.next = 49;\n              return knex('content_items').update(body).where({ id: itemId });\n\n            case 49:\n              return _context5.abrupt('return', _context5.sent);\n\n            case 50:\n              _context5.next = 52;\n              return knex('content_items').insert(Object.assign({\n                id: randomId,\n                categoryId: categoryId\n              }, body));\n\n            case 52:\n              return _context5.abrupt('return', _context5.sent);\n\n            case 53:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, this);\n    }));\n\n    return function createOrUpdateCategoryItem(_x3) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var listCategoryItems = function () {\n    var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6(categoryId) {\n      var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var count = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 50;\n      var searchTerm = arguments[3];\n      var knex, items, query;\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context6.sent;\n              items = null;\n              query = knex('content_items');\n\n\n              if (categoryId) {\n                query = query.where({\n                  categoryId: categoryId\n                });\n              }\n\n              if (searchTerm) {\n                query = query.andWhere('metadata', 'like', '%' + searchTerm + '%').orWhere('formData', 'like', '%' + searchTerm + '%');\n              }\n\n              _context6.next = 9;\n              return query.orderBy('created_on').offset(from).limit(count).then();\n\n            case 9:\n              items = _context6.sent;\n              return _context6.abrupt('return', items.map(transformCategoryItem));\n\n            case 11:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, this);\n    }));\n\n    return function listCategoryItems(_x4) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var deleteCategoryItems = function () {\n    var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7(ids) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              if (!(!_lodash2.default.isArray(ids) || _lodash2.default.some(ids, function (id) {\n                return !_lodash2.default.isString(id);\n              }))) {\n                _context7.next = 2;\n                break;\n              }\n\n              throw new Error('Expected an array of Ids to delete');\n\n            case 2:\n              _context7.next = 4;\n              return db.get();\n\n            case 4:\n              knex = _context7.sent;\n              return _context7.abrupt('return', knex('content_items').whereIn('id', ids).del());\n\n            case 6:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, this);\n    }));\n\n    return function deleteCategoryItems(_x7) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var getItem = function () {\n    var _ref10 = _asyncToGenerator(regeneratorRuntime.mark(function _callee8(itemId) {\n      var knex, item;\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context8.sent;\n              _context8.next = 5;\n              return knex('content_items').where({ id: itemId }).then().get(0).then();\n\n            case 5:\n              item = _context8.sent;\n              return _context8.abrupt('return', transformCategoryItem(item));\n\n            case 7:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, this);\n    }));\n\n    return function getItem(_x8) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var getItemsByMetadata = function () {\n    var _ref11 = _asyncToGenerator(regeneratorRuntime.mark(function _callee9(metadata) {\n      var knex, items;\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context9.sent;\n              _context9.next = 5;\n              return knex('content_items').where('metadata', 'like', '%|' + metadata + '|%').then();\n\n            case 5:\n              items = _context9.sent;\n              return _context9.abrupt('return', transformCategoryItem(items));\n\n            case 7:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, this);\n    }));\n\n    return function getItemsByMetadata(_x9) {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var exportContent = function () {\n    var _ref12 = _asyncToGenerator(regeneratorRuntime.mark(function _callee10() {\n      var ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var knex, query, items;\n      return regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context10.sent;\n              query = knex('content_items').select('*');\n\n\n              if (ids) {\n                query = query.whereIn('id', ids);\n              }\n\n              items = query.then();\n              return _context10.abrupt('return', items.map(function (item) {\n                return transformCategoryItem(item);\n              }));\n\n            case 7:\n            case 'end':\n              return _context10.stop();\n          }\n        }\n      }, _callee10, this);\n    }));\n\n    return function exportContent() {\n      return _ref12.apply(this, arguments);\n    };\n  }();\n\n  var importContent = function () {\n    var _ref13 = _asyncToGenerator(regeneratorRuntime.mark(function _callee11(documents) {\n      var knex;\n      return regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.next = 2;\n              return db.get();\n\n            case 2:\n              knex = _context11.sent;\n              return _context11.abrupt('return', _bluebird2.default.mapSeries(documents, function (doc) {\n                if (!doc.id || !doc.formData || !doc.categoryId) {\n                  throw new Error('Invalid data');\n                }\n\n                var row = {\n                  data: JSON.stringify(doc.data),\n                  formData: JSON.stringify(doc.formData),\n                  metadata: '|' + doc.metadata.join('|') + '|',\n                  previewText: doc.previewText,\n                  created_by: 'admin',\n                  created_on: (0, _helpers2.default)(knex).date.now(),\n                  id: doc.id,\n                  categoryId: doc.categoryId\n                };\n\n                return knex('content_items').insert(row).then().catch(function (err) {\n                  return knex('content_items').where({ id: doc.id }).update(row).then();\n                });\n              }));\n\n            case 4:\n            case 'end':\n              return _context11.stop();\n          }\n        }\n      }, _callee11, this);\n    }));\n\n    return function importContent(_x11) {\n      return _ref13.apply(this, arguments);\n    };\n  }();\n\n  var db = _ref.db,\n      botfile = _ref.botfile,\n      projectLocation = _ref.projectLocation,\n      logger = _ref.logger;\n\n  var categories = [];\n\n  function transformCategoryItem(item) {\n    if (!item) {\n      return item;\n    }\n\n    var metadata = item.metadata || '';\n    metadata = _lodash2.default.filter(metadata.split('|'), function (i) {\n      return i.length > 0;\n    });\n\n    return {\n      id: item.id,\n      data: JSON.parse(item.data),\n      formData: JSON.parse(item.formData),\n      categoryId: item.categoryId,\n      previewText: item.previewText,\n      metadata: metadata,\n      createdBy: item.created_by,\n      createdOn: item.created_on\n    };\n  }\n\n  return {\n    scanAndRegisterCategories: scanAndRegisterCategories,\n    listAvailableCategories: listAvailableCategories,\n    getCategorySchema: getCategorySchema,\n\n    createOrUpdateCategoryItem: createOrUpdateCategoryItem,\n    listCategoryItems: listCategoryItems,\n    deleteCategoryItems: deleteCategoryItems,\n\n    getItem: getItem,\n    getItemsByMetadata: getItemsByMetadata,\n\n    exportContent: exportContent,\n    importContent: importContent\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NvbnRlbnQvc2VydmljZS5qcz9iYWZkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZnMgZnJvbSAnZnMnXG5cbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuaW1wb3J0IGdsb2IgZnJvbSAnZ2xvYidcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQnXG5cbmltcG9ydCBoZWxwZXJzIGZyb20gJy4uL2RhdGFiYXNlL2hlbHBlcnMnXG5cbm1vZHVsZS5leHBvcnRzID0gKHsgZGIsIGJvdGZpbGUsIHByb2plY3RMb2NhdGlvbiwgbG9nZ2VyIH0pID0+IHtcbiAgbGV0IGNhdGVnb3JpZXMgPSBbXVxuXG4gIGFzeW5jIGZ1bmN0aW9uIHNjYW5BbmRSZWdpc3RlckNhdGVnb3JpZXMoKSB7XG4gICAgY2F0ZWdvcmllcyA9IFtdXG5cbiAgICBjb25zdCBmb3JtRGlyID0gcGF0aC5yZXNvbHZlKHByb2plY3RMb2NhdGlvbiwgYm90ZmlsZS5mb3Jtc0RpciB8fCAnLi9jb250ZW50L2Zvcm1zJylcblxuICAgIGlmICghZnMuZXhpc3RzU3luYyhmb3JtRGlyKSkge1xuICAgICAgcmV0dXJuIGNhdGVnb3JpZXNcbiAgICB9XG5cbiAgICBjb25zdCBzZWFyY2hPcHRpb25zID0geyBjd2Q6IGZvcm1EaXIgfVxuXG4gICAgY29uc3QgZmlsZXMgPSBhd2FpdCBQcm9taXNlLmZyb21DYWxsYmFjayhjYWxsYmFjayA9PiBnbG9iKCcqKi8qLmZvcm0uanMnLCBzZWFyY2hPcHRpb25zLCBjYWxsYmFjaykpXG5cbiAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBwYXRoLnJlc29sdmUoZm9ybURpciwgJy4vJyArIGZpbGUpXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gZXZhbCgncmVxdWlyZScpKGZpbGVQYXRoKSAvLyBEeW5hbWljIGxvYWRpbmcgcmVxdWlyZSBldmFsIGZvciBXZWJwYWNrXG4gICAgICAgIGNvbnN0IHJlcXVpcmVkRmllbGRzID0gWydpZCcsICd0aXRsZScsICdqc29uU2NoZW1hJ11cblxuICAgICAgICByZXF1aXJlZEZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgICBpZiAoXy5pc05pbChjYXRlZ29yeVtmaWVsZF0pKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZmllbGQgKyAnIGlzIHJlcXVpcmVkIGJ1dCBtaXNzaW5nIGluIENvbnRlbnQgRm9ybSBmaWxlOiAnICsgZmlsZSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG5cbiAgICAgICAgY2F0ZWdvcnkuaWQgPSBjYXRlZ29yeS5pZC50b0xvd2VyQ2FzZSgpXG5cbiAgICAgICAgaWYgKF8uZmluZChjYXRlZ29yaWVzLCB7IGlkOiBjYXRlZ29yeS5pZCB9KSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlcmUgaXMgYWxyZWFkeSBhIGZvcm0gd2l0aCBpZD0nICsgY2F0ZWdvcnkuaWQpXG4gICAgICAgIH1cblxuICAgICAgICBjYXRlZ29yaWVzLnB1c2goY2F0ZWdvcnkpXG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ1tDb250ZW50IE1hbmFnZXJdIENvdWxkIG5vdCBsb2FkIEZvcm06ICcgKyBmaWxlLCBlcnIpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBjYXRlZ29yaWVzXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBsaXN0QXZhaWxhYmxlQ2F0ZWdvcmllcygpIHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLm1hcChjYXRlZ29yaWVzLCBhc3luYyBjYXRlZ29yeSA9PiB7XG4gICAgICBjb25zdCBjb3VudCA9IGF3YWl0IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgICAud2hlcmUoeyBjYXRlZ29yeUlkOiBjYXRlZ29yeS5pZCB9KVxuICAgICAgICAuc2VsZWN0KGtuZXgucmF3KCdjb3VudCgqKSBhcyBjb3VudCcpKVxuICAgICAgICAudGhlbigpXG4gICAgICAgIC5nZXQoMClcbiAgICAgICAgLnRoZW4ocm93ID0+IChyb3cgJiYgcm93LmNvdW50KSB8fCAwKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZDogY2F0ZWdvcnkuaWQsXG4gICAgICAgIHRpdGxlOiBjYXRlZ29yeS50aXRsZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGNhdGVnb3J5LmRlc2NyaXB0aW9uLFxuICAgICAgICBjb3VudDogY291bnRcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZ2V0Q2F0ZWdvcnlTY2hlbWEoY2F0ZWdvcnlJZCkge1xuICAgIGNvbnN0IGNhdGVnb3J5ID0gXy5maW5kKGNhdGVnb3JpZXMsIHsgaWQ6IGNhdGVnb3J5SWQgfSlcbiAgICBpZiAoXy5pc05pbChjYXRlZ29yeSkpIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGpzb246IGNhdGVnb3J5Lmpzb25TY2hlbWEsXG4gICAgICB1aTogY2F0ZWdvcnkudWlTY2hlbWEsXG4gICAgICB0aXRsZTogY2F0ZWdvcnkudGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogY2F0ZWdvcnkuZGVzY3JpcHRpb24sXG4gICAgICB1bW1CbG9jOiBjYXRlZ29yeS51bW1CbG9jXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gY3JlYXRlT3JVcGRhdGVDYXRlZ29yeUl0ZW0oeyBpdGVtSWQsIGNhdGVnb3J5SWQsIGZvcm1EYXRhIH0pIHtcbiAgICBjYXRlZ29yeUlkID0gY2F0ZWdvcnlJZCAmJiBjYXRlZ29yeUlkLnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCBjYXRlZ29yeSA9IF8uZmluZChjYXRlZ29yaWVzLCB7IGlkOiBjYXRlZ29yeUlkIH0pXG5cbiAgICBpZiAoXy5pc05pbChjYXRlZ29yeSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2F0ZWdvcnkgXCIke2NhdGVnb3J5SWR9XCIgaXMgbm90IGEgdmFsaWQgcmVnaXN0ZXJlZCBjYXRlZ29yeUlkYClcbiAgICB9XG5cbiAgICBpZiAoXy5pc05pbChmb3JtRGF0YSkgfHwgIV8uaXNPYmplY3QoZm9ybURhdGEpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1wiZm9ybURhdGFcIiBtdXN0IGJlIGEgdmFsaWQgb2JqZWN0JylcbiAgICB9XG5cbiAgICBsZXQgZGF0YSA9IChjYXRlZ29yeS5jb21wdXRlRm9ybURhdGEgJiYgKGF3YWl0IGNhdGVnb3J5LmNvbXB1dGVGb3JtRGF0YShmb3JtRGF0YSkpKSB8fCBmb3JtRGF0YVxuICAgIGNvbnN0IG1ldGFkYXRhID0gKGNhdGVnb3J5LmNvbXB1dGVNZXRhZGF0YSAmJiAoYXdhaXQgY2F0ZWdvcnkuY29tcHV0ZU1ldGFkYXRhKGZvcm1EYXRhKSkpIHx8IFtdXG4gICAgY29uc3QgcHJldmlld1RleHQgPSAoY2F0ZWdvcnkuY29tcHV0ZVByZXZpZXdUZXh0ICYmIChhd2FpdCBjYXRlZ29yeS5jb21wdXRlUHJldmlld1RleHQoZm9ybURhdGEpKSkgfHwgJ05vIHByZXZpZXcnXG5cbiAgICBpZiAoIV8uaXNBcnJheShtZXRhZGF0YSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY29tcHV0ZU1ldGFkYXRhIG11c3QgcmV0dXJuIGFuIGFycmF5IG9mIHN0cmluZycpXG4gICAgfVxuXG4gICAgaWYgKCFfLmlzU3RyaW5nKHByZXZpZXdUZXh0KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb21wdXRlUHJldmlld1RleHQgbXVzdCByZXR1cm4gYSBzdHJpbmcnKVxuICAgIH1cblxuICAgIGlmIChfLmlzTmlsKGRhdGEpIHx8ICFfLmlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbXB1dGVGb3JtRGF0YSBtdXN0IHJldHVybiBhIHZhbGlkIG9iamVjdCcpXG4gICAgfVxuXG4gICAgbGV0IHByZWZpeCA9IGNhdGVnb3J5LnVtbUJsb2MgfHwgY2F0ZWdvcnlJZFxuXG4gICAgaWYgKHByZWZpeC5zdGFydHNXaXRoKCcjJykpIHtcbiAgICAgIHByZWZpeCA9IHByZWZpeC5zdWJzdHIoMSlcbiAgICB9XG5cbiAgICBjb25zdCByYW5kb21JZCA9IGAke3ByZWZpeH0tJHt1dWlkXG4gICAgICAudjQoKVxuICAgICAgLnNwbGl0KCctJylcbiAgICAgIC5qb2luKCcnKVxuICAgICAgLnN1YnN0cigwLCA2KX1gXG5cbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIGNvbnN0IGJvZHkgPSB7XG4gICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShkYXRhKSxcbiAgICAgIGZvcm1EYXRhOiBKU09OLnN0cmluZ2lmeShmb3JtRGF0YSksXG4gICAgICBtZXRhZGF0YTogJ3wnICsgbWV0YWRhdGEuam9pbignfCcpICsgJ3wnLFxuICAgICAgcHJldmlld1RleHQ6IHByZXZpZXdUZXh0LFxuICAgICAgY3JlYXRlZF9ieTogJ2FkbWluJyxcbiAgICAgIGNyZWF0ZWRfb246IGhlbHBlcnMoa25leCkuZGF0ZS5ub3coKVxuICAgIH1cblxuICAgIGlmIChpdGVtSWQpIHtcbiAgICAgIHJldHVybiBhd2FpdCBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAgICAgLnVwZGF0ZShib2R5KVxuICAgICAgICAud2hlcmUoeyBpZDogaXRlbUlkIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIGF3YWl0IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKS5pbnNlcnQoXG4gICAgICBPYmplY3QuYXNzaWduKFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6IHJhbmRvbUlkLFxuICAgICAgICAgIGNhdGVnb3J5SWQ6IGNhdGVnb3J5SWRcbiAgICAgICAgfSxcbiAgICAgICAgYm9keVxuICAgICAgKVxuICAgIClcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGxpc3RDYXRlZ29yeUl0ZW1zKGNhdGVnb3J5SWQsIGZyb20gPSAwLCBjb3VudCA9IDUwLCBzZWFyY2hUZXJtKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICBsZXQgaXRlbXMgPSBudWxsXG4gICAgbGV0IHF1ZXJ5ID0ga25leCgnY29udGVudF9pdGVtcycpXG5cbiAgICBpZiAoY2F0ZWdvcnlJZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSh7XG4gICAgICAgIGNhdGVnb3J5SWQ6IGNhdGVnb3J5SWRcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKHNlYXJjaFRlcm0pIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuYW5kV2hlcmUoJ21ldGFkYXRhJywgJ2xpa2UnLCBgJSR7c2VhcmNoVGVybX0lYCkub3JXaGVyZSgnZm9ybURhdGEnLCAnbGlrZScsIGAlJHtzZWFyY2hUZXJtfSVgKVxuICAgIH1cblxuICAgIGl0ZW1zID0gYXdhaXQgcXVlcnlcbiAgICAgIC5vcmRlckJ5KCdjcmVhdGVkX29uJylcbiAgICAgIC5vZmZzZXQoZnJvbSlcbiAgICAgIC5saW1pdChjb3VudClcbiAgICAgIC50aGVuKClcblxuICAgIHJldHVybiBpdGVtcy5tYXAodHJhbnNmb3JtQ2F0ZWdvcnlJdGVtKVxuICB9XG5cbiAgZnVuY3Rpb24gdHJhbnNmb3JtQ2F0ZWdvcnlJdGVtKGl0ZW0pIHtcbiAgICBpZiAoIWl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtXG4gICAgfVxuXG4gICAgbGV0IG1ldGFkYXRhID0gaXRlbS5tZXRhZGF0YSB8fCAnJ1xuICAgIG1ldGFkYXRhID0gXy5maWx0ZXIobWV0YWRhdGEuc3BsaXQoJ3wnKSwgaSA9PiBpLmxlbmd0aCA+IDApXG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICBkYXRhOiBKU09OLnBhcnNlKGl0ZW0uZGF0YSksXG4gICAgICBmb3JtRGF0YTogSlNPTi5wYXJzZShpdGVtLmZvcm1EYXRhKSxcbiAgICAgIGNhdGVnb3J5SWQ6IGl0ZW0uY2F0ZWdvcnlJZCxcbiAgICAgIHByZXZpZXdUZXh0OiBpdGVtLnByZXZpZXdUZXh0LFxuICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhLFxuICAgICAgY3JlYXRlZEJ5OiBpdGVtLmNyZWF0ZWRfYnksXG4gICAgICBjcmVhdGVkT246IGl0ZW0uY3JlYXRlZF9vblxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhdGVnb3J5SXRlbXMoaWRzKSB7XG4gICAgaWYgKCFfLmlzQXJyYXkoaWRzKSB8fCBfLnNvbWUoaWRzLCBpZCA9PiAhXy5pc1N0cmluZyhpZCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIGFuIGFycmF5IG9mIElkcyB0byBkZWxldGUnKVxuICAgIH1cblxuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgcmV0dXJuIGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgLndoZXJlSW4oJ2lkJywgaWRzKVxuICAgICAgLmRlbCgpXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBnZXRJdGVtKGl0ZW1JZCkge1xuICAgIGNvbnN0IGtuZXggPSBhd2FpdCBkYi5nZXQoKVxuXG4gICAgY29uc3QgaXRlbSA9IGF3YWl0IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgLndoZXJlKHsgaWQ6IGl0ZW1JZCB9KVxuICAgICAgLnRoZW4oKVxuICAgICAgLmdldCgwKVxuICAgICAgLnRoZW4oKVxuXG4gICAgcmV0dXJuIHRyYW5zZm9ybUNhdGVnb3J5SXRlbShpdGVtKVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gZ2V0SXRlbXNCeU1ldGFkYXRhKG1ldGFkYXRhKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgLndoZXJlKCdtZXRhZGF0YScsICdsaWtlJywgJyV8JyArIG1ldGFkYXRhICsgJ3wlJylcbiAgICAgIC50aGVuKClcblxuICAgIHJldHVybiB0cmFuc2Zvcm1DYXRlZ29yeUl0ZW0oaXRlbXMpXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBleHBvcnRDb250ZW50KGlkcyA9IG51bGwpIHtcbiAgICBjb25zdCBrbmV4ID0gYXdhaXQgZGIuZ2V0KClcblxuICAgIGxldCBxdWVyeSA9IGtuZXgoJ2NvbnRlbnRfaXRlbXMnKS5zZWxlY3QoJyonKVxuXG4gICAgaWYgKGlkcykge1xuICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZUluKCdpZCcsIGlkcylcbiAgICB9XG5cbiAgICBjb25zdCBpdGVtcyA9IHF1ZXJ5LnRoZW4oKVxuXG4gICAgcmV0dXJuIGl0ZW1zLm1hcChpdGVtID0+IHRyYW5zZm9ybUNhdGVnb3J5SXRlbShpdGVtKSlcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGltcG9ydENvbnRlbnQoZG9jdW1lbnRzKSB7XG4gICAgY29uc3Qga25leCA9IGF3YWl0IGRiLmdldCgpXG5cbiAgICByZXR1cm4gUHJvbWlzZS5tYXBTZXJpZXMoZG9jdW1lbnRzLCBkb2MgPT4ge1xuICAgICAgaWYgKCFkb2MuaWQgfHwgIWRvYy5mb3JtRGF0YSB8fCAhZG9jLmNhdGVnb3J5SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGRhdGEnKVxuICAgICAgfVxuXG4gICAgICBjb25zdCByb3cgPSB7XG4gICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGRvYy5kYXRhKSxcbiAgICAgICAgZm9ybURhdGE6IEpTT04uc3RyaW5naWZ5KGRvYy5mb3JtRGF0YSksXG4gICAgICAgIG1ldGFkYXRhOiAnfCcgKyBkb2MubWV0YWRhdGEuam9pbignfCcpICsgJ3wnLFxuICAgICAgICBwcmV2aWV3VGV4dDogZG9jLnByZXZpZXdUZXh0LFxuICAgICAgICBjcmVhdGVkX2J5OiAnYWRtaW4nLFxuICAgICAgICBjcmVhdGVkX29uOiBoZWxwZXJzKGtuZXgpLmRhdGUubm93KCksXG4gICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgIGNhdGVnb3J5SWQ6IGRvYy5jYXRlZ29yeUlkXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBrbmV4KCdjb250ZW50X2l0ZW1zJylcbiAgICAgICAgLmluc2VydChyb3cpXG4gICAgICAgIC50aGVuKClcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgcmV0dXJuIGtuZXgoJ2NvbnRlbnRfaXRlbXMnKVxuICAgICAgICAgICAgLndoZXJlKHsgaWQ6IGRvYy5pZCB9KVxuICAgICAgICAgICAgLnVwZGF0ZShyb3cpXG4gICAgICAgICAgICAudGhlbigpXG4gICAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgc2NhbkFuZFJlZ2lzdGVyQ2F0ZWdvcmllcyxcbiAgICBsaXN0QXZhaWxhYmxlQ2F0ZWdvcmllcyxcbiAgICBnZXRDYXRlZ29yeVNjaGVtYSxcblxuICAgIGNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtLFxuICAgIGxpc3RDYXRlZ29yeUl0ZW1zLFxuICAgIGRlbGV0ZUNhdGVnb3J5SXRlbXMsXG5cbiAgICBnZXRJdGVtLFxuICAgIGdldEl0ZW1zQnlNZXRhZGF0YSxcblxuICAgIGV4cG9ydENvbnRlbnQsXG4gICAgaW1wb3J0Q29udGVudFxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NvbnRlbnQvc2VydmljZS5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7Ozs7O0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQVNBO0FBVEE7QUFBQTtBQVdBO0FBQUE7QUFDQTtBQVpBO0FBV0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbEJBO0FBbUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFyQ0E7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFKQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQTRDQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1BO0FBQUE7QUFDQTtBQVBBO0FBQ0E7QUFEQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFDQTtBQVRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQTdDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQWdFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUNBO0FBUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWpFQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQStFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFZQTtBQVpBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQWFBO0FBYkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBY0E7QUFDQTtBQWZBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQTRCQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBbENBO0FBQUE7QUFDQTtBQURBO0FBd0NBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUNBO0FBM0NBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUE0REE7QUFDQTtBQUZBO0FBQ0E7QUE1REE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWhGQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQW1KQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFmQTtBQUFBO0FBQ0E7QUFEQTtBQWdCQTtBQWhCQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXBKQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQWdNQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUtBO0FBTEE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFqTUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUE0TUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBSEE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUE3TUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUF3TkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBSEE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUF6TkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFrT0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQUE7QUFDQTtBQVpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFuT0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFnUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFDQTtBQVVBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7QUE3QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWpQQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUEwS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVVBO0FBQ0E7QUFnRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWJBO0FBZUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///77\n");

/***/ }),
/* 78 */
/***/ (function(module, exports) {

eval("module.exports = require(\"glob\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJnbG9iXCI/NTljYSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJnbG9iXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiZ2xvYlwiXG4vLyBtb2R1bGUgaWQgPSA3OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///78\n");

/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _eventemitter = __webpack_require__(24);\n\nvar _eventemitter2 = _interopRequireDefault(_eventemitter);\n\nvar _ms = __webpack_require__(14);\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _listeners = __webpack_require__(12);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar INTERVAL_MSGS = 5000;\n\nvar formatMessage = function formatMessage(msg, initialEvent) {\n  if (typeof msg === 'string') {\n    return {\n      platform: initialEvent.platform,\n      user: initialEvent.user,\n      type: 'text',\n      text: msg,\n      raw: {\n        user: initialEvent.user,\n        message: msg\n      }\n    };\n  } else if (typeof msg === 'function') {\n    // This is a 'wrapped' or 'delayed' execution message\n    // It is going to be evaluated at send time, this this has a risk of failing\n    // If the function execution fails\n    return msg;\n  } else {\n    if (msg && msg.type && msg.platform && msg.text) {\n      return msg;\n    } else {\n      throw new Error('Invalid message: ', msg);\n    }\n  }\n};\n\nvar formatBloc = function formatBloc(blocName) {\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (!_lodash2.default.isString(blocName)) {\n    throw new Error('Invalid bloc name, espected string');\n  }\n\n  return {\n    isBloc: true,\n    bloc: blocName,\n    data: data\n  };\n};\n\nvar isBlocCall = function isBlocCall(args) {\n  return _lodash2.default.isString(args[0]) && args[0].startsWith('#');\n};\n\nvar validateHandlers = function validateHandlers(handlers) {\n  if (_lodash2.default.isFunction(handlers)) {\n    return [{\n      default: true,\n      callback: handlers\n    }];\n  }\n\n  if (!_lodash2.default.isArray(handlers)) {\n    throw new Error('Invalid handler(s) for question, expected a function or an array of handlers (see doc).');\n  }\n\n  return handlers;\n};\n\nvar Thread = function (_EventEmmiter) {\n  _inherits(Thread, _EventEmmiter);\n\n  function Thread(name, bp, convo) {\n    _classCallCheck(this, Thread);\n\n    var _this = _possibleConstructorReturn(this, (Thread.__proto__ || Object.getPrototypeOf(Thread)).call(this));\n\n    _this.initialEvent = convo.initialEvent;\n    _this.name = name;\n    _this.bp = bp;\n    _this.convo = convo;\n    _this.queue = []; // Queue of messages and questions to say / ask next\n    _this.archive = []; // Archive of unqueued questions. We store them so we can re-create (restart) the thread.\n    _this.waiting = false; // Thread is waiting when it asked for a question\n    _this._last = null;\n    return _this;\n  }\n\n  _createClass(Thread, [{\n    key: 'enqueue',\n    value: function enqueue(message) {\n      this.queue.push(message);\n      this.archive.push(message);\n    }\n  }, {\n    key: 'addMessage',\n    value: function addMessage(msg) {\n      return this.add({\n        content: arguments[0],\n        data: arguments[1],\n        handler: null,\n        condition: null\n      });\n    }\n\n    // Two signatures possible:\n    // msg, handlers\n    // bloc, data, handlers\n\n  }, {\n    key: 'addQuestion',\n    value: function addQuestion(msg) {\n      var handlers = validateHandlers(_lodash2.default.last(arguments));\n      var content = arguments[0];\n      var data = arguments.length >= 3 ? arguments[1] : null;\n\n      return this.add({\n        content: content,\n        handler: handlers,\n        condition: null,\n        data: data\n      });\n    }\n\n    /* { \n      content: 'string or #umm'\n      handler?: function(response) // If no handler = message + next()\n      condition?: function() // return bool|Promise<bool> to execute it or not\n      data?: object|func<object>|func<Promise<object>> to feed data to the UMM\n    } */\n\n  }, {\n    key: 'add',\n    value: function add(_ref) {\n      var content = _ref.content,\n          handler = _ref.handler,\n          condition = _ref.condition,\n          data = _ref.data;\n\n      var handlers = handler ? validateHandlers(handler) : null;\n      var type = handlers ? 'question' : 'message';\n\n      var isBloc = _lodash2.default.isString(content) && content.startsWith('#');\n\n      if (isBloc) {\n        return this.enqueue({\n          type: type,\n          message: formatBloc(content, data),\n          handlers: handlers,\n          condition: condition\n        });\n      }\n\n      // Add raw message question\n      var message = formatMessage(content, this.initialEvent);\n\n      this.enqueue({\n        type: type,\n        message: message,\n        handlers: handlers,\n        condition: condition\n      });\n    }\n  }, {\n    key: 'peek',\n    value: function peek() {\n      return this.queue.length > 0 ? this.queue[0] : null;\n    }\n  }, {\n    key: 'dequeue',\n    value: function () {\n      var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee() {\n        var msg, exec;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                msg = null;\n\n              case 1:\n                if (false) {\n                  _context.next = 12;\n                  break;\n                }\n\n                msg = this.queue.shift();\n\n                if (!(msg && msg.condition && _lodash2.default.isFunction(msg.condition))) {\n                  _context.next = 9;\n                  break;\n                }\n\n                _context.next = 6;\n                return msg.condition();\n\n              case 6:\n                exec = _context.sent;\n\n                if (exec) {\n                  _context.next = 9;\n                  break;\n                }\n\n                return _context.abrupt('continue', 1);\n\n              case 9:\n                return _context.abrupt('break', 12);\n\n              case 12:\n\n                this._last = msg;\n                this.waiting = msg && msg.type === 'question';\n\n                if (!msg) {\n                  this.emit('done');\n                }\n\n                return _context.abrupt('return', msg);\n\n              case 16:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function dequeue() {\n        return _ref2.apply(this, arguments);\n      }\n\n      return dequeue;\n    }()\n  }, {\n    key: 'process',\n    value: function process(event) {\n      var handlers = this.waiting && this._last && this._last.handlers || [];\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = handlers[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var handler = _step.value;\n\n          if (handler.pattern && (0, _listeners.matches)(handler.pattern, event)) {\n            if (_lodash2.default.isRegExp(handler.pattern)) {\n              var match = handler.pattern.exec(event.text);\n              if (match) {\n                event.match = match[1];\n              }\n            }\n\n            handler.callback && handler.callback(event);\n            return; // Interrupt further processing\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      var defaultHandler = _lodash2.default.find(handlers, { default: true });\n\n      defaultHandler && defaultHandler.callback && defaultHandler.callback(event);\n    }\n  }, {\n    key: 'repeat',\n    value: function repeat() {\n      return this._last && this._last.message;\n    }\n  }, {\n    key: 'restart',\n    value: function restart() {\n      this.queue = this.archive.map(function (i) {\n        return i;\n      });\n      this._last = null;\n      this.waiting = false;\n    }\n  }]);\n\n  return Thread;\n}(_eventemitter2.default);\n\nvar Conversation = function (_EventEmmiter2) {\n  _inherits(Conversation, _EventEmmiter2);\n\n  function Conversation(_ref3) {\n    var initialEvent = _ref3.initialEvent,\n        middleware = _ref3.middleware,\n        logger = _ref3.logger,\n        messageTypes = _ref3.messageTypes,\n        _ref3$clockSpeed = _ref3.clockSpeed,\n        clockSpeed = _ref3$clockSpeed === undefined ? 500 : _ref3$clockSpeed;\n\n    _classCallCheck(this, Conversation);\n\n    var _this2 = _possibleConstructorReturn(this, (Conversation.__proto__ || Object.getPrototypeOf(Conversation)).call(this));\n\n    _this2.logger = logger;\n    _this2.middleware = middleware;\n    _this2.initialEvent = initialEvent;\n    _this2._threads = {};\n    _this2.currentThread = null;\n    _this2.defaultThread = _this2.createThread('default');\n    _this2.status = 'new';\n    _this2.get = _this2._get;\n    _this2.set = _this2._set;\n    _this2._cache = {};\n    _this2.intervalBetweenMessages = INTERVAL_MSGS;\n    _this2._timeoutHandle = null;\n    _this2._timeoutInterval = (0, _ms2.default)('5 minutes');\n    _this2._useTimeout = false;\n    _this2._clock = setInterval(_this2.tick.bind(_this2), clockSpeed);\n    _this2._clockSpeed = clockSpeed;\n    _this2._processing = false;\n    _this2._sendLock = false;\n    _this2.messageTypes = messageTypes || ['message', 'text', 'quick_reply'];\n    _this2._outgoing = [];\n    _this2.endWhenDone = true;\n\n    _this2.sendNext(); // Infinite loop. Must be called only once.\n    return _this2;\n  }\n\n  _createClass(Conversation, [{\n    key: 'sendNext',\n    value: function () {\n      var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2() {\n        var msg, data;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!this._sendLock) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt('return');\n\n              case 4:\n                this._sendLock = true;\n\n              case 5:\n                _context2.prev = 5;\n                msg = this._outgoing.shift();\n\n                if (!msg) {\n                  _context2.next = 22;\n                  break;\n                }\n\n                if (!(msg.isBloc === true)) {\n                  _context2.next = 20;\n                  break;\n                }\n\n                if (!(!this.initialEvent || !this.initialEvent.reply)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                throw new Error(\"Convo doesn't have default event or does not support UMM\");\n\n              case 11:\n                data = msg.data;\n\n                if (!_lodash2.default.isFunction(data)) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                _context2.next = 15;\n                return _bluebird2.default.resolve(data());\n\n              case 15:\n                data = _context2.sent;\n\n              case 16:\n                _context2.next = 18;\n                return _bluebird2.default.resolve(this.initialEvent.reply(msg.bloc, data));\n\n              case 18:\n                _context2.next = 22;\n                break;\n\n              case 20:\n                _context2.next = 22;\n                return _bluebird2.default.resolve(this.middleware && this.middleware.sendOutgoing && this.middleware.sendOutgoing(msg));\n\n              case 22:\n                _context2.next = 24;\n                return _bluebird2.default.delay(this._clockSpeed);\n\n              case 24:\n\n                if (this.status === 'active' || this._outgoing.length > 0) {\n                  setImmediate(this.sendNext.bind(this));\n                }\n\n              case 25:\n                _context2.prev = 25;\n\n                this._sendLock = false;\n                return _context2.finish(25);\n\n              case 28:\n              case 'end':\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5,, 25, 28]]);\n      }));\n\n      function sendNext() {\n        return _ref4.apply(this, arguments);\n      }\n\n      return sendNext;\n    }()\n  }, {\n    key: 'teardown',\n    value: function teardown() {\n      // Dispose of timeouts and intervals\n      clearInterval(this._clock);\n      this.clearTimeout();\n      this.status = 'destroyed';\n    }\n  }, {\n    key: 'getCurrentThread',\n    value: function getCurrentThread() {\n      return this._threads[this.currentThread];\n    }\n  }, {\n    key: 'tick',\n    value: function tick() {\n      var thread = this.getCurrentThread();\n      if (this.status === 'active' && !thread.waiting) {\n        this.next();\n      }\n    }\n  }, {\n    key: 'clearTimeout',\n    value: function clearTimeout() {\n      if (this._timeoutHandle) {\n        this.clearTimeout(this._timeoutHandle);\n      }\n    }\n  }, {\n    key: 'resetTimeout',\n    value: function resetTimeout() {\n      var _this3 = this;\n\n      this.clearTimeout();\n\n      this._timeoutHandle = this._useTimeout && setTimeout(function () {\n        // TODO If there's a timeout thread, switch to it\n        _this3.emit('timeout');\n      }, this._timeoutInterval);\n    }\n  }, {\n    key: 'createThread',\n    value: function createThread(name) {\n      var thread = new Thread(name, this.bp, this);\n      this._threads[name] = thread;\n\n      if (!this.currentThread) {\n        this.currentThread = name;\n      }\n\n      return thread;\n    }\n  }, {\n    key: 'switchTo',\n    value: function () {\n      var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(name) {\n        var restart = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n        var before, thread;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(this.currentThread === name)) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                return _context3.abrupt('return');\n\n              case 2:\n                if (this._threads[name]) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                throw new Error('Thread \"' + name + '\" doesn\\'t exist');\n\n              case 4:\n                _context3.next = 6;\n                return this.emitAsync('beforeSwitch', name);\n\n              case 6:\n                before = _context3.sent;\n\n                if (!_lodash2.default.some(before, function (a) {\n                  return a === false;\n                })) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                return _context3.abrupt('return');\n\n              case 9:\n\n                this.currentThread = name;\n\n                if (restart) {\n                  thread = this.getCurrentThread();\n\n                  thread && thread.restart();\n                }\n\n                this.emit('switched', name);\n\n              case 12:\n              case 'end':\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function switchTo(_x2) {\n        return _ref5.apply(this, arguments);\n      }\n\n      return switchTo;\n    }()\n  }, {\n    key: 'next',\n    value: function () {\n      var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n        var thread, msg, message;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                thread = this.getCurrentThread();\n\n                if (thread.peek()) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt('return', this.endWhenDone && this.stop('done'));\n\n              case 3:\n                _context4.next = 5;\n                return thread.dequeue();\n\n              case 5:\n                msg = _context4.sent;\n\n                if (msg) {\n                  message = msg.message;\n\n\n                  if (typeof message === 'function') {\n                    // Executes (unwrap) the message on the fly\n                    message = msg.message();\n                  }\n\n                  this.say(message, this.initialEvent);\n                }\n\n              case 7:\n              case 'end':\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function next() {\n        return _ref6.apply(this, arguments);\n      }\n\n      return next;\n    }()\n  }, {\n    key: 'processIncoming',\n    value: function () {\n      var _ref7 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(event) {\n        var before, thread;\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (_lodash2.default.includes(this.messageTypes, event.type)) {\n                  _context5.next = 2;\n                  break;\n                }\n\n                return _context5.abrupt('return');\n\n              case 2:\n\n                this._timeoutHandle && this.resetTimeout();\n                _context5.next = 5;\n                return this.emitAsync('beforeProcessing', event);\n\n              case 5:\n                before = _context5.sent;\n\n                if (!_lodash2.default.some(before, function (a) {\n                  return a === false;\n                })) {\n                  _context5.next = 8;\n                  break;\n                }\n\n                return _context5.abrupt('return');\n\n              case 8:\n                thread = this.getCurrentThread();\n\n                thread && thread.waiting && thread.process(event);\n\n              case 10:\n              case 'end':\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function processIncoming(_x4) {\n        return _ref7.apply(this, arguments);\n      }\n\n      return processIncoming;\n    }()\n  }, {\n    key: 'setTimeout',\n    value: function setTimeout(timeout) {\n      this._useTimeout = true;\n      this._timeoutInterval = typeof timeout === 'number' ? timeout : (0, _ms2.default)(timeout);\n      this.resetTimeout();\n    }\n  }, {\n    key: 'say',\n    value: function () {\n      var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6(msg) {\n        var message,\n            _args6 = arguments;\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                message = null;\n\n\n                if (msg && msg.isBloc === true) {\n                  message = msg;\n                } else {\n                  message = isBlocCall(_args6) ? formatBloc.apply(undefined, _args6) : formatMessage(msg, this.initialEvent);\n                }\n\n                this._outgoing.push(message);\n\n                if (this.status !== 'active') {\n                  this.sendNext(); // restart sending process once\n                }\n\n              case 4:\n              case 'end':\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function say(_x5) {\n        return _ref8.apply(this, arguments);\n      }\n\n      return say;\n    }()\n  }, {\n    key: 'activate',\n    value: function activate() {\n      if (this.status === 'new') {\n        this.status = 'active';\n        this.emit('activated');\n      } else {\n        throw new Error('Conversation was already activated');\n      }\n    }\n  }, {\n    key: 'getStatus',\n    value: function getStatus() {\n      return this.status;\n    }\n  }, {\n    key: '_get',\n    value: function _get(name) {\n      return this._cache[name];\n    }\n  }, {\n    key: '_set',\n    value: function _set(name, value) {\n      this._cache[name] = value;\n    }\n  }, {\n    key: 'repeat',\n    value: function () {\n      var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7() {\n        var thread, msg;\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                thread = this._threads[this.currentThread];\n                msg = thread && thread.repeat();\n\n                if (!msg) {\n                  _context7.next = 4;\n                  break;\n                }\n\n                return _context7.abrupt('return', this.say(msg));\n\n              case 4:\n              case 'end':\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function repeat() {\n        return _ref9.apply(this, arguments);\n      }\n\n      return repeat;\n    }()\n  }, {\n    key: 'stop',\n    value: function stop(reason) {\n      this.status = reason;\n      this.emit(reason);\n\n      if (reason !== 'stop') {\n        this.emit('stop', reason);\n      }\n      this.teardown();\n    }\n  }, {\n    key: 'threads',\n    get: function get() {\n      return Object.assign({}, this._threads);\n    }\n  }]);\n\n  return Conversation;\n}(_eventemitter2.default);\n\nmodule.exports = function (_ref10) {\n  var logger = _ref10.logger,\n      middleware = _ref10.middleware,\n      _ref10$clockSpeed = _ref10.clockSpeed,\n      clockSpeed = _ref10$clockSpeed === undefined ? 500 : _ref10$clockSpeed;\n\n  var convos = [];\n\n  var belongsToConvo = function belongsToConvo(convo, event) {\n    var initial = convo.initialEvent;\n\n    return convo.initialEvent.platform === event.platform && _lodash2.default.get(initial, 'user.id', '') === _lodash2.default.get(event, 'user.id', '');\n  };\n\n  middleware.register({\n    name: 'conversations',\n    type: 'incoming',\n    order: 25,\n    module: 'botpress',\n    description: 'Built-in conversation flow manager',\n    handler: function handler(event, next) {\n\n      // Clean up and free from memory ended conversations\n      convos = _lodash2.default.filter(convos, function (c) {\n        return _lodash2.default.includes(['new', 'active'], c.status);\n      });\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = convos[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var convo = _step2.value;\n\n          if (belongsToConvo(convo, event) && convo.status === 'active') {\n            convo.processIncoming(event);\n            return; // Stop the processing, only one convo per event. Swallow the event\n          }\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      next && next(); // Don't swallow the event\n    }\n  });\n\n  var validateEvent = function validateEvent(event) {\n    if (!event || !event.type || !event.platform) {\n      throw new Error('You need to pass an original incoming event to start a conversation');\n    }\n  };\n\n  function start(event, callback) {\n    var convo = create(event);\n    callback && callback(convo);\n\n    convo.activate();\n    return convo;\n  }\n\n  function create(event) {\n    validateEvent(event);\n    var convo = new Conversation({\n      logger: logger,\n      middleware: middleware,\n      clockSpeed: clockSpeed,\n      initialEvent: event\n    });\n    convos.push(convo);\n    return convo;\n  }\n\n  function find(event) {\n    var _iteratorNormalCompletion3 = true;\n    var _didIteratorError3 = false;\n    var _iteratorError3 = undefined;\n\n    try {\n      for (var _iterator3 = convos[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n        var convo = _step3.value;\n\n        if (belongsToConvo(convo, event) && convo.status === 'active') {\n          return convo;\n        }\n      }\n    } catch (err) {\n      _didIteratorError3 = true;\n      _iteratorError3 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n          _iterator3.return();\n        }\n      } finally {\n        if (_didIteratorError3) {\n          throw _iteratorError3;\n        }\n      }\n    }\n  }\n\n  function destroy() {\n    var _iteratorNormalCompletion4 = true;\n    var _didIteratorError4 = false;\n    var _iteratorError4 = undefined;\n\n    try {\n      for (var _iterator4 = convos[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n        var convo = _step4.value;\n\n        convo.teardown();\n      }\n    } catch (err) {\n      _didIteratorError4 = true;\n      _iteratorError4 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion4 && _iterator4.return) {\n          _iterator4.return();\n        }\n      } finally {\n        if (_didIteratorError4) {\n          throw _iteratorError4;\n        }\n      }\n    }\n\n    convos = [];\n  }\n\n  return { start: start, create: create, find: find, destroy: destroy };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL2NvbnZlcnNhdGlvbnMuanM/MjVjNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRXZlbnRFbW1pdGVyIGZyb20gJ2V2ZW50ZW1pdHRlcjInXG5pbXBvcnQgbXMgZnJvbSAnbXMnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcblxuaW1wb3J0IHsgbWF0Y2hlcyB9IGZyb20gJy4vbGlzdGVuZXJzJ1xuXG5jb25zdCBJTlRFUlZBTF9NU0dTID0gNTAwMFxuXG5jb25zdCBmb3JtYXRNZXNzYWdlID0gKG1zZywgaW5pdGlhbEV2ZW50KSA9PiB7XG4gIGlmICh0eXBlb2YgbXNnID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB7XG4gICAgICBwbGF0Zm9ybTogaW5pdGlhbEV2ZW50LnBsYXRmb3JtLFxuICAgICAgdXNlcjogaW5pdGlhbEV2ZW50LnVzZXIsXG4gICAgICB0eXBlOiAndGV4dCcsXG4gICAgICB0ZXh0OiBtc2csXG4gICAgICByYXc6IHtcbiAgICAgICAgdXNlcjogaW5pdGlhbEV2ZW50LnVzZXIsXG4gICAgICAgIG1lc3NhZ2U6IG1zZ1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIGlmICh0eXBlb2YgbXNnID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gVGhpcyBpcyBhICd3cmFwcGVkJyBvciAnZGVsYXllZCcgZXhlY3V0aW9uIG1lc3NhZ2VcbiAgICAvLyBJdCBpcyBnb2luZyB0byBiZSBldmFsdWF0ZWQgYXQgc2VuZCB0aW1lLCB0aGlzIHRoaXMgaGFzIGEgcmlzayBvZiBmYWlsaW5nXG4gICAgLy8gSWYgdGhlIGZ1bmN0aW9uIGV4ZWN1dGlvbiBmYWlsc1xuICAgIHJldHVybiBtc2dcbiAgfSBlbHNlIHtcbiAgICBpZiAobXNnICYmIG1zZy50eXBlICYmIG1zZy5wbGF0Zm9ybSAmJiBtc2cudGV4dCkge1xuICAgICAgcmV0dXJuIG1zZ1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgbWVzc2FnZTogJywgbXNnKVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBmb3JtYXRCbG9jID0gKGJsb2NOYW1lLCBkYXRhID0ge30pID0+IHtcbiAgaWYgKCFfLmlzU3RyaW5nKGJsb2NOYW1lKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBibG9jIG5hbWUsIGVzcGVjdGVkIHN0cmluZycpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGlzQmxvYzogdHJ1ZSxcbiAgICBibG9jOiBibG9jTmFtZSxcbiAgICBkYXRhOiBkYXRhXG4gIH1cbn1cblxuY29uc3QgaXNCbG9jQ2FsbCA9IGFyZ3MgPT4ge1xuICByZXR1cm4gXy5pc1N0cmluZyhhcmdzWzBdKSAmJiBhcmdzWzBdLnN0YXJ0c1dpdGgoJyMnKVxufVxuXG5jb25zdCB2YWxpZGF0ZUhhbmRsZXJzID0gaGFuZGxlcnMgPT4ge1xuICBpZiAoXy5pc0Z1bmN0aW9uKGhhbmRsZXJzKSkge1xuICAgIHJldHVybiBbe1xuICAgICAgZGVmYXVsdDogdHJ1ZSxcbiAgICAgIGNhbGxiYWNrOiBoYW5kbGVyc1xuICAgIH1dXG4gIH1cblxuICBpZiAoIV8uaXNBcnJheShoYW5kbGVycykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaGFuZGxlcihzKSBmb3IgcXVlc3Rpb24sIGV4cGVjdGVkIGEgZnVuY3Rpb24gb3IgYW4gYXJyYXkgb2YgaGFuZGxlcnMgKHNlZSBkb2MpLicpXG4gIH1cblxuICByZXR1cm4gaGFuZGxlcnNcbn1cblxuY2xhc3MgVGhyZWFkIGV4dGVuZHMgRXZlbnRFbW1pdGVyIHtcblxuICBjb25zdHJ1Y3RvcihuYW1lLCBicCwgY29udm8pIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5pbml0aWFsRXZlbnQgPSBjb252by5pbml0aWFsRXZlbnRcbiAgICB0aGlzLm5hbWUgPSBuYW1lXG4gICAgdGhpcy5icCA9IGJwXG4gICAgdGhpcy5jb252byA9IGNvbnZvXG4gICAgdGhpcy5xdWV1ZSA9IFtdIC8vIFF1ZXVlIG9mIG1lc3NhZ2VzIGFuZCBxdWVzdGlvbnMgdG8gc2F5IC8gYXNrIG5leHRcbiAgICB0aGlzLmFyY2hpdmUgPSBbXSAvLyBBcmNoaXZlIG9mIHVucXVldWVkIHF1ZXN0aW9ucy4gV2Ugc3RvcmUgdGhlbSBzbyB3ZSBjYW4gcmUtY3JlYXRlIChyZXN0YXJ0KSB0aGUgdGhyZWFkLlxuICAgIHRoaXMud2FpdGluZyA9IGZhbHNlIC8vIFRocmVhZCBpcyB3YWl0aW5nIHdoZW4gaXQgYXNrZWQgZm9yIGEgcXVlc3Rpb25cbiAgICB0aGlzLl9sYXN0ID0gbnVsbFxuICB9XG5cbiAgZW5xdWV1ZShtZXNzYWdlKSB7XG4gICAgdGhpcy5xdWV1ZS5wdXNoKG1lc3NhZ2UpXG4gICAgdGhpcy5hcmNoaXZlLnB1c2gobWVzc2FnZSlcbiAgfVxuXG4gIGFkZE1lc3NhZ2UobXNnKSB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKHsgXG4gICAgICBjb250ZW50OiBhcmd1bWVudHNbMF0sXG4gICAgICBkYXRhOiBhcmd1bWVudHNbMV0sXG4gICAgICBoYW5kbGVyOiBudWxsLFxuICAgICAgY29uZGl0aW9uOiBudWxsXG4gICAgfSlcbiAgfVxuXG4gIC8vIFR3byBzaWduYXR1cmVzIHBvc3NpYmxlOlxuICAvLyBtc2csIGhhbmRsZXJzXG4gIC8vIGJsb2MsIGRhdGEsIGhhbmRsZXJzXG4gIGFkZFF1ZXN0aW9uKG1zZykge1xuICAgIGNvbnN0IGhhbmRsZXJzID0gdmFsaWRhdGVIYW5kbGVycyhfLmxhc3QoYXJndW1lbnRzKSlcbiAgICBjb25zdCBjb250ZW50ID0gYXJndW1lbnRzWzBdXG4gICAgY29uc3QgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPj0gMyA/IGFyZ3VtZW50c1sxXSA6IG51bGxcblxuICAgIHJldHVybiB0aGlzLmFkZCh7IFxuICAgICAgY29udGVudCwgXG4gICAgICBoYW5kbGVyOiBoYW5kbGVycywgXG4gICAgICBjb25kaXRpb246IG51bGwsIFxuICAgICAgZGF0YSBcbiAgICB9KVxuICB9XG5cbiAgLyogeyBcbiAgICBjb250ZW50OiAnc3RyaW5nIG9yICN1bW0nXG4gICAgaGFuZGxlcj86IGZ1bmN0aW9uKHJlc3BvbnNlKSAvLyBJZiBubyBoYW5kbGVyID0gbWVzc2FnZSArIG5leHQoKVxuICAgIGNvbmRpdGlvbj86IGZ1bmN0aW9uKCkgLy8gcmV0dXJuIGJvb2x8UHJvbWlzZTxib29sPiB0byBleGVjdXRlIGl0IG9yIG5vdFxuICAgIGRhdGE/OiBvYmplY3R8ZnVuYzxvYmplY3Q+fGZ1bmM8UHJvbWlzZTxvYmplY3Q+PiB0byBmZWVkIGRhdGEgdG8gdGhlIFVNTVxuICB9ICovXG4gIGFkZCh7IGNvbnRlbnQsIGhhbmRsZXIsIGNvbmRpdGlvbiwgZGF0YSB9KSB7XG4gICAgY29uc3QgaGFuZGxlcnMgPSBoYW5kbGVyID8gdmFsaWRhdGVIYW5kbGVycyhoYW5kbGVyKSA6IG51bGxcbiAgICBjb25zdCB0eXBlID0gaGFuZGxlcnMgPyAncXVlc3Rpb24nIDogJ21lc3NhZ2UnXG5cbiAgICBjb25zdCBpc0Jsb2MgPSBfLmlzU3RyaW5nKGNvbnRlbnQpICYmIGNvbnRlbnQuc3RhcnRzV2l0aCgnIycpXG5cbiAgICBpZiAoaXNCbG9jKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbnF1ZXVlKHtcbiAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgbWVzc2FnZTogZm9ybWF0QmxvYyhjb250ZW50LCBkYXRhKSxcbiAgICAgICAgaGFuZGxlcnM6IGhhbmRsZXJzLFxuICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvblxuICAgICAgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIHJhdyBtZXNzYWdlIHF1ZXN0aW9uXG4gICAgY29uc3QgbWVzc2FnZSA9IGZvcm1hdE1lc3NhZ2UoY29udGVudCwgdGhpcy5pbml0aWFsRXZlbnQpXG5cbiAgICB0aGlzLmVucXVldWUoe1xuICAgICAgdHlwZTogdHlwZSxcbiAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG4gICAgICBoYW5kbGVyczogaGFuZGxlcnMsXG4gICAgICBjb25kaXRpb246IGNvbmRpdGlvblxuICAgIH0pXG4gIH1cblxuICBwZWVrKCkge1xuICAgIHJldHVybiB0aGlzLnF1ZXVlLmxlbmd0aCA+IDAgPyB0aGlzLnF1ZXVlWzBdIDogbnVsbFxuICB9XG5cbiAgYXN5bmMgZGVxdWV1ZSgpIHtcbiAgICBsZXQgbXNnID0gbnVsbFxuXG4gICAgd2hpbGUodHJ1ZSkge1xuICAgICAgbXNnID0gdGhpcy5xdWV1ZS5zaGlmdCgpXG5cbiAgICAgIGlmIChtc2cgJiYgbXNnLmNvbmRpdGlvbiAmJiBfLmlzRnVuY3Rpb24obXNnLmNvbmRpdGlvbikpIHtcbiAgICAgICAgY29uc3QgZXhlYyA9IGF3YWl0IG1zZy5jb25kaXRpb24oKVxuICAgICAgICBpZiAoIWV4ZWMpIHtcbiAgICAgICAgICBjb250aW51ZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGJyZWFrXG4gICAgfVxuXG4gICAgdGhpcy5fbGFzdCA9IG1zZ1xuICAgIHRoaXMud2FpdGluZyA9IG1zZyAmJiBtc2cudHlwZSA9PT0gJ3F1ZXN0aW9uJ1xuXG4gICAgaWYgKCFtc2cpIHtcbiAgICAgIHRoaXMuZW1pdCgnZG9uZScpXG4gICAgfVxuXG4gICAgcmV0dXJuIG1zZ1xuICB9XG5cbiAgcHJvY2VzcyhldmVudCkge1xuICAgIGNvbnN0IGhhbmRsZXJzID0gKHRoaXMud2FpdGluZyAmJiB0aGlzLl9sYXN0ICYmIHRoaXMuX2xhc3QuaGFuZGxlcnMpIHx8IFtdXG5cbiAgICBmb3IgKGxldCBoYW5kbGVyIG9mIGhhbmRsZXJzKSB7XG4gICAgICBpZiAoaGFuZGxlci5wYXR0ZXJuICYmIG1hdGNoZXMoaGFuZGxlci5wYXR0ZXJuLCBldmVudCkpIHtcbiAgICAgICAgaWYgKF8uaXNSZWdFeHAoaGFuZGxlci5wYXR0ZXJuKSkge1xuICAgICAgICAgIGNvbnN0IG1hdGNoID0gaGFuZGxlci5wYXR0ZXJuLmV4ZWMoZXZlbnQudGV4dClcbiAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgIGV2ZW50Lm1hdGNoID0gbWF0Y2hbMV1cbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBoYW5kbGVyLmNhbGxiYWNrICYmIGhhbmRsZXIuY2FsbGJhY2soZXZlbnQpXG4gICAgICAgIHJldHVybiAvLyBJbnRlcnJ1cHQgZnVydGhlciBwcm9jZXNzaW5nXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZGVmYXVsdEhhbmRsZXIgPSBfLmZpbmQoaGFuZGxlcnMsIHsgZGVmYXVsdDogdHJ1ZSB9KVxuXG4gICAgZGVmYXVsdEhhbmRsZXIgJiYgZGVmYXVsdEhhbmRsZXIuY2FsbGJhY2sgJiYgZGVmYXVsdEhhbmRsZXIuY2FsbGJhY2soZXZlbnQpXG4gIH1cblxuICByZXBlYXQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xhc3QgJiYgdGhpcy5fbGFzdC5tZXNzYWdlXG4gIH1cblxuICByZXN0YXJ0KCkge1xuICAgIHRoaXMucXVldWUgPSB0aGlzLmFyY2hpdmUubWFwKGkgPT4gaSlcbiAgICB0aGlzLl9sYXN0ID0gbnVsbFxuICAgIHRoaXMud2FpdGluZyA9IGZhbHNlXG4gIH1cbn1cblxuY2xhc3MgQ29udmVyc2F0aW9uIGV4dGVuZHMgRXZlbnRFbW1pdGVyIHtcblxuICBjb25zdHJ1Y3Rvcih7IGluaXRpYWxFdmVudCwgbWlkZGxld2FyZSwgbG9nZ2VyLCBtZXNzYWdlVHlwZXMsIGNsb2NrU3BlZWQgPSA1MDAgfSkge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlclxuICAgIHRoaXMubWlkZGxld2FyZSA9IG1pZGRsZXdhcmVcbiAgICB0aGlzLmluaXRpYWxFdmVudCA9IGluaXRpYWxFdmVudFxuICAgIHRoaXMuX3RocmVhZHMgPSB7fVxuICAgIHRoaXMuY3VycmVudFRocmVhZCA9IG51bGxcbiAgICB0aGlzLmRlZmF1bHRUaHJlYWQgPSB0aGlzLmNyZWF0ZVRocmVhZCgnZGVmYXVsdCcpXG4gICAgdGhpcy5zdGF0dXMgPSAnbmV3J1xuICAgIHRoaXMuZ2V0ID0gdGhpcy5fZ2V0XG4gICAgdGhpcy5zZXQgPSB0aGlzLl9zZXRcbiAgICB0aGlzLl9jYWNoZSA9IHt9XG4gICAgdGhpcy5pbnRlcnZhbEJldHdlZW5NZXNzYWdlcyA9IElOVEVSVkFMX01TR1NcbiAgICB0aGlzLl90aW1lb3V0SGFuZGxlID0gbnVsbFxuICAgIHRoaXMuX3RpbWVvdXRJbnRlcnZhbCA9IG1zKCc1IG1pbnV0ZXMnKVxuICAgIHRoaXMuX3VzZVRpbWVvdXQgPSBmYWxzZVxuICAgIHRoaXMuX2Nsb2NrID0gc2V0SW50ZXJ2YWwoOjp0aGlzLnRpY2ssIGNsb2NrU3BlZWQpXG4gICAgdGhpcy5fY2xvY2tTcGVlZCA9IGNsb2NrU3BlZWRcbiAgICB0aGlzLl9wcm9jZXNzaW5nID0gZmFsc2VcbiAgICB0aGlzLl9zZW5kTG9jayA9IGZhbHNlXG4gICAgdGhpcy5tZXNzYWdlVHlwZXMgPSBtZXNzYWdlVHlwZXMgfHwgWydtZXNzYWdlJywgJ3RleHQnLCAncXVpY2tfcmVwbHknXVxuICAgIHRoaXMuX291dGdvaW5nID0gW11cbiAgICB0aGlzLmVuZFdoZW5Eb25lID0gdHJ1ZVxuXG4gICAgdGhpcy5zZW5kTmV4dCgpIC8vIEluZmluaXRlIGxvb3AuIE11c3QgYmUgY2FsbGVkIG9ubHkgb25jZS5cbiAgfVxuXG4gIGdldCB0aHJlYWRzKCkge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl90aHJlYWRzKVxuICB9XG5cbiAgYXN5bmMgc2VuZE5leHQoKSB7XG4gICAgaWYgKHRoaXMuX3NlbmRMb2NrKSB7XG4gICAgICByZXR1cm5cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2VuZExvY2sgPSB0cnVlXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1zZyA9IHRoaXMuX291dGdvaW5nLnNoaWZ0KClcblxuICAgICAgaWYgKG1zZykge1xuXG4gICAgICAgIGlmIChtc2cuaXNCbG9jID09PSB0cnVlKSB7XG4gICAgICAgICAgLy8gU2VuZCBibG9jXG4gICAgICAgICAgaWYgKCF0aGlzLmluaXRpYWxFdmVudCB8fCAhdGhpcy5pbml0aWFsRXZlbnQucmVwbHkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbnZvIGRvZXNuJ3QgaGF2ZSBkZWZhdWx0IGV2ZW50IG9yIGRvZXMgbm90IHN1cHBvcnQgVU1NXCIpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGV0IGRhdGEgPSBtc2cuZGF0YVxuXG4gICAgICAgICAgaWYgKF8uaXNGdW5jdGlvbihkYXRhKSkge1xuICAgICAgICAgICAgZGF0YSA9IGF3YWl0IFByb21pc2UucmVzb2x2ZShkYXRhKCkpXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHRoaXMuaW5pdGlhbEV2ZW50LnJlcGx5KG1zZy5ibG9jLCBkYXRhKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBSYXcgbWVzc2FnZVxuICAgICAgICAgIGF3YWl0IFByb21pc2UucmVzb2x2ZSh0aGlzLm1pZGRsZXdhcmVcbiAgICAgICAgICAmJiB0aGlzLm1pZGRsZXdhcmUuc2VuZE91dGdvaW5nIFxuICAgICAgICAgICYmIHRoaXMubWlkZGxld2FyZS5zZW5kT3V0Z29pbmcobXNnKSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBhd2FpdCBQcm9taXNlLmRlbGF5KHRoaXMuX2Nsb2NrU3BlZWQpXG4gICAgICBcbiAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gJ2FjdGl2ZScgfHwgdGhpcy5fb3V0Z29pbmcubGVuZ3RoID4gMCkge1xuICAgICAgICBzZXRJbW1lZGlhdGUoOjp0aGlzLnNlbmROZXh0KVxuICAgICAgfVxuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLl9zZW5kTG9jayA9IGZhbHNlXG4gICAgfVxuICB9XG5cbiAgdGVhcmRvd24oKSB7XG4gICAgLy8gRGlzcG9zZSBvZiB0aW1lb3V0cyBhbmQgaW50ZXJ2YWxzXG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9jbG9jaylcbiAgICB0aGlzLmNsZWFyVGltZW91dCgpXG4gICAgdGhpcy5zdGF0dXMgPSAnZGVzdHJveWVkJ1xuICB9XG5cbiAgZ2V0Q3VycmVudFRocmVhZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdGhyZWFkc1t0aGlzLmN1cnJlbnRUaHJlYWRdXG4gIH1cblxuICB0aWNrKCkge1xuICAgIGNvbnN0IHRocmVhZCA9IHRoaXMuZ2V0Q3VycmVudFRocmVhZCgpXG4gICAgaWYgKHRoaXMuc3RhdHVzID09PSAnYWN0aXZlJyAmJiAhdGhyZWFkLndhaXRpbmcpIHtcbiAgICAgIHRoaXMubmV4dCgpXG4gICAgfVxuICB9XG5cbiAgY2xlYXJUaW1lb3V0KCkge1xuICAgIGlmICh0aGlzLl90aW1lb3V0SGFuZGxlKSB7XG4gICAgICB0aGlzLmNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SGFuZGxlKVxuICAgIH1cbiAgfVxuXG4gIHJlc2V0VGltZW91dCgpIHtcbiAgICB0aGlzLmNsZWFyVGltZW91dCgpXG5cbiAgICB0aGlzLl90aW1lb3V0SGFuZGxlID0gdGhpcy5fdXNlVGltZW91dCAmJiBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vIFRPRE8gSWYgdGhlcmUncyBhIHRpbWVvdXQgdGhyZWFkLCBzd2l0Y2ggdG8gaXRcbiAgICAgIHRoaXMuZW1pdCgndGltZW91dCcpXG4gICAgfSwgdGhpcy5fdGltZW91dEludGVydmFsKVxuICB9XG5cbiAgY3JlYXRlVGhyZWFkKG5hbWUpIHtcbiAgICBjb25zdCB0aHJlYWQgPSBuZXcgVGhyZWFkKG5hbWUsIHRoaXMuYnAsIHRoaXMpXG4gICAgdGhpcy5fdGhyZWFkc1tuYW1lXSA9IHRocmVhZFxuXG4gICAgaWYgKCF0aGlzLmN1cnJlbnRUaHJlYWQpIHtcbiAgICAgIHRoaXMuY3VycmVudFRocmVhZCA9IG5hbWVcbiAgICB9XG5cbiAgICByZXR1cm4gdGhyZWFkXG4gIH1cblxuICBhc3luYyBzd2l0Y2hUbyhuYW1lLCByZXN0YXJ0ID0gdHJ1ZSkge1xuICAgIGlmICh0aGlzLmN1cnJlbnRUaHJlYWQgPT09IG5hbWUpIHtcbiAgICAgIHJldHVybiAvLyBEb24ndCBzd2l0Y2ggaWYgaXQncyBhbHJlYWR5IHRoZSBjdXJyZW50IHRocmVhZFxuICAgIH1cblxuICAgIGlmICghdGhpcy5fdGhyZWFkc1tuYW1lXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaHJlYWQgXCIke25hbWV9XCIgZG9lc24ndCBleGlzdGApXG4gICAgfVxuXG4gICAgY29uc3QgYmVmb3JlID0gYXdhaXQgdGhpcy5lbWl0QXN5bmMoJ2JlZm9yZVN3aXRjaCcsIG5hbWUpXG4gICAgaWYgKF8uc29tZShiZWZvcmUsIGEgPT4gYSA9PT0gZmFsc2UpKSB7XG4gICAgICByZXR1cm4gLy8gQWJvcnRlZCB0aHJlYWQgc3dpdGNoXG4gICAgfVxuXG4gICAgdGhpcy5jdXJyZW50VGhyZWFkID0gbmFtZVxuXG4gICAgaWYgKHJlc3RhcnQpIHtcbiAgICAgIGNvbnN0IHRocmVhZCA9IHRoaXMuZ2V0Q3VycmVudFRocmVhZCgpXG4gICAgICB0aHJlYWQgJiYgdGhyZWFkLnJlc3RhcnQoKVxuICAgIH1cblxuICAgIHRoaXMuZW1pdCgnc3dpdGNoZWQnLCBuYW1lKVxuICB9XG5cbiAgYXN5bmMgbmV4dCgpIHtcbiAgICBjb25zdCB0aHJlYWQgPSB0aGlzLmdldEN1cnJlbnRUaHJlYWQoKVxuXG4gICAgaWYgKCF0aHJlYWQucGVlaygpKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbmRXaGVuRG9uZSAmJiB0aGlzLnN0b3AoJ2RvbmUnKVxuICAgIH1cblxuICAgIGNvbnN0IG1zZyA9IGF3YWl0IHRocmVhZC5kZXF1ZXVlKClcbiAgICBpZiAobXNnKSB7XG4gICAgICBsZXQgbWVzc2FnZSA9IG1zZy5tZXNzYWdlXG5cbiAgICAgIGlmICh0eXBlb2YgbWVzc2FnZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBFeGVjdXRlcyAodW53cmFwKSB0aGUgbWVzc2FnZSBvbiB0aGUgZmx5XG4gICAgICAgIG1lc3NhZ2UgPSBtc2cubWVzc2FnZSgpXG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2F5KG1lc3NhZ2UsIHRoaXMuaW5pdGlhbEV2ZW50KVxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHByb2Nlc3NJbmNvbWluZyhldmVudCkge1xuXG4gICAgaWYgKCFfLmluY2x1ZGVzKHRoaXMubWVzc2FnZVR5cGVzLCBldmVudC50eXBlKSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgdGhpcy5fdGltZW91dEhhbmRsZSAmJiB0aGlzLnJlc2V0VGltZW91dCgpXG4gICAgY29uc3QgYmVmb3JlID0gYXdhaXQgdGhpcy5lbWl0QXN5bmMoJ2JlZm9yZVByb2Nlc3NpbmcnLCBldmVudClcbiAgICBpZiAoXy5zb21lKGJlZm9yZSwgYSA9PiBhID09PSBmYWxzZSkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHRocmVhZCA9IHRoaXMuZ2V0Q3VycmVudFRocmVhZCgpXG4gICAgdGhyZWFkICYmIHRocmVhZC53YWl0aW5nICYmIHRocmVhZC5wcm9jZXNzKGV2ZW50KVxuICB9XG5cbiAgc2V0VGltZW91dCh0aW1lb3V0KSB7XG4gICAgdGhpcy5fdXNlVGltZW91dCA9IHRydWVcbiAgICB0aGlzLl90aW1lb3V0SW50ZXJ2YWwgPSB0eXBlb2YgdGltZW91dCA9PT0gJ251bWJlcicgPyB0aW1lb3V0IDogbXModGltZW91dClcbiAgICB0aGlzLnJlc2V0VGltZW91dCgpXG4gIH1cblxuICBhc3luYyBzYXkobXNnKSB7XG4gICAgbGV0IG1lc3NhZ2UgPSBudWxsXG5cbiAgICBpZiAobXNnICYmIG1zZy5pc0Jsb2MgPT09IHRydWUpIHtcbiAgICAgIG1lc3NhZ2UgPSBtc2dcbiAgICB9IGVsc2Uge1xuICAgICAgbWVzc2FnZSA9IGlzQmxvY0NhbGwoYXJndW1lbnRzKVxuICAgICAgICA/IGZvcm1hdEJsb2MoLi4uYXJndW1lbnRzKVxuICAgICAgICA6IGZvcm1hdE1lc3NhZ2UobXNnLCB0aGlzLmluaXRpYWxFdmVudClcbiAgICB9XG5cbiAgICB0aGlzLl9vdXRnb2luZy5wdXNoKG1lc3NhZ2UpXG5cbiAgICBpZiAodGhpcy5zdGF0dXMgIT09ICdhY3RpdmUnKSB7XG4gICAgICB0aGlzLnNlbmROZXh0KCkgLy8gcmVzdGFydCBzZW5kaW5nIHByb2Nlc3Mgb25jZVxuICAgIH1cbiAgfVxuXG4gIGFjdGl2YXRlKCkge1xuICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gJ25ldycpIHtcbiAgICAgIHRoaXMuc3RhdHVzID0gJ2FjdGl2ZSdcbiAgICAgIHRoaXMuZW1pdCgnYWN0aXZhdGVkJylcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb252ZXJzYXRpb24gd2FzIGFscmVhZHkgYWN0aXZhdGVkJylcbiAgICB9XG4gIH1cblxuICBnZXRTdGF0dXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzXG4gIH1cblxuICBfZ2V0KG5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FjaGVbbmFtZV1cbiAgfVxuXG4gIF9zZXQobmFtZSwgdmFsdWUpIHtcbiAgICB0aGlzLl9jYWNoZVtuYW1lXSA9IHZhbHVlXG4gIH1cblxuICBhc3luYyByZXBlYXQoKSB7XG4gICAgY29uc3QgdGhyZWFkID0gdGhpcy5fdGhyZWFkc1t0aGlzLmN1cnJlbnRUaHJlYWRdXG4gICAgY29uc3QgbXNnID0gdGhyZWFkICYmIHRocmVhZC5yZXBlYXQoKVxuXG4gICAgaWYgKG1zZykge1xuICAgICAgcmV0dXJuIHRoaXMuc2F5KG1zZylcbiAgICB9XG4gIH1cblxuICBzdG9wKHJlYXNvbikge1xuICAgIHRoaXMuc3RhdHVzID0gcmVhc29uXG4gICAgdGhpcy5lbWl0KHJlYXNvbilcblxuICAgIGlmIChyZWFzb24gIT09ICdzdG9wJykge1xuICAgICAgdGhpcy5lbWl0KCdzdG9wJywgcmVhc29uKVxuICAgIH1cbiAgICB0aGlzLnRlYXJkb3duKClcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9ICh7IGxvZ2dlciwgbWlkZGxld2FyZSwgY2xvY2tTcGVlZCA9IDUwMCB9KSA9PiB7XG4gIGxldCBjb252b3MgPSBbXVxuXG4gIGNvbnN0IGJlbG9uZ3NUb0NvbnZvID0gKGNvbnZvLCBldmVudCkgPT4ge1xuICAgIGNvbnN0IGluaXRpYWwgPSBjb252by5pbml0aWFsRXZlbnRcblxuICAgIHJldHVybiBjb252by5pbml0aWFsRXZlbnQucGxhdGZvcm0gPT09IGV2ZW50LnBsYXRmb3JtXG4gICAgICAmJiBfLmdldChpbml0aWFsLCAndXNlci5pZCcsICcnKSA9PT0gXy5nZXQoZXZlbnQsICd1c2VyLmlkJywgJycpXG4gIH1cblxuICBtaWRkbGV3YXJlLnJlZ2lzdGVyKHtcbiAgICBuYW1lOiAnY29udmVyc2F0aW9ucycsXG4gICAgdHlwZTogJ2luY29taW5nJyxcbiAgICBvcmRlcjogMjUsXG4gICAgbW9kdWxlOiAnYm90cHJlc3MnLFxuICAgIGRlc2NyaXB0aW9uOiAnQnVpbHQtaW4gY29udmVyc2F0aW9uIGZsb3cgbWFuYWdlcicsXG4gICAgaGFuZGxlcjogZnVuY3Rpb24oZXZlbnQsIG5leHQpIHtcblxuICAgICAgLy8gQ2xlYW4gdXAgYW5kIGZyZWUgZnJvbSBtZW1vcnkgZW5kZWQgY29udmVyc2F0aW9uc1xuICAgICAgY29udm9zID0gXy5maWx0ZXIoY29udm9zLCBjID0+IHtcbiAgICAgICAgcmV0dXJuIF8uaW5jbHVkZXMoWyduZXcnLCAnYWN0aXZlJ10sIGMuc3RhdHVzKVxuICAgICAgfSlcblxuICAgICAgZm9yIChsZXQgY29udm8gb2YgY29udm9zKSB7XG4gICAgICAgIGlmIChiZWxvbmdzVG9Db252byhjb252bywgZXZlbnQpICYmIGNvbnZvLnN0YXR1cyA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgICBjb252by5wcm9jZXNzSW5jb21pbmcoZXZlbnQpXG4gICAgICAgICAgcmV0dXJuIC8vIFN0b3AgdGhlIHByb2Nlc3NpbmcsIG9ubHkgb25lIGNvbnZvIHBlciBldmVudC4gU3dhbGxvdyB0aGUgZXZlbnRcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBuZXh0ICYmIG5leHQoKSAvLyBEb24ndCBzd2FsbG93IHRoZSBldmVudFxuICAgIH1cbiAgfSlcblxuICBjb25zdCB2YWxpZGF0ZUV2ZW50ID0gZXZlbnQgPT4ge1xuICAgIGlmICghZXZlbnQgfHwgIWV2ZW50LnR5cGUgfHwgIWV2ZW50LnBsYXRmb3JtKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBuZWVkIHRvIHBhc3MgYW4gb3JpZ2luYWwgaW5jb21pbmcgZXZlbnQgdG8gc3RhcnQgYSBjb252ZXJzYXRpb24nKVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0KGV2ZW50LCBjYWxsYmFjaykge1xuICAgIGNvbnN0IGNvbnZvID0gY3JlYXRlKGV2ZW50KVxuICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGNvbnZvKVxuXG4gICAgY29udm8uYWN0aXZhdGUoKVxuICAgIHJldHVybiBjb252b1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlKGV2ZW50KSB7XG4gICAgdmFsaWRhdGVFdmVudChldmVudClcbiAgICBjb25zdCBjb252byA9IG5ldyBDb252ZXJzYXRpb24oe1xuICAgICAgbG9nZ2VyLFxuICAgICAgbWlkZGxld2FyZSxcbiAgICAgIGNsb2NrU3BlZWQsXG4gICAgICBpbml0aWFsRXZlbnQ6IGV2ZW50XG4gICAgfSlcbiAgICBjb252b3MucHVzaChjb252bylcbiAgICByZXR1cm4gY29udm9cbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmQoZXZlbnQpIHtcbiAgICBmb3IgKGxldCBjb252byBvZiBjb252b3MpIHtcbiAgICAgIGlmIChiZWxvbmdzVG9Db252byhjb252bywgZXZlbnQpICYmIGNvbnZvLnN0YXR1cyA9PT0gJ2FjdGl2ZScpIHtcbiAgICAgICAgcmV0dXJuIGNvbnZvXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICBmb3IgKGxldCBjb252byBvZiBjb252b3MpIHtcbiAgICAgIGNvbnZvLnRlYXJkb3duKClcbiAgICB9XG5cbiAgICBjb252b3MgPSBbXVxuICB9XG5cbiAgcmV0dXJuIHsgc3RhcnQsIGNyZWF0ZSwgZmluZCwgZGVzdHJveSB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL2NvbnZlcnNhdGlvbnMuanMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBTEE7QUFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVEE7QUFVQTtBQUNBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7Ozs7Ozs7OztBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FBR0E7QUFDQTs7QUFDQTs7Ozs7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQUNBO0FBQ0E7O0FBREE7QUFDQTtBQUFBOzs7Ozs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUdBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWdCQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBR0E7OztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF4QkE7QUF5QkE7QUFDQTs7Ozs7Ozs7OztBQU1BOzs7Ozs7OztBQUdBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7Ozs7QUFFQTs7Ozs7QUFFQTs7Ozs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7Ozs7O0FBQ0E7QUFDQTs7QUFEQTtBQUNBOzs7QUFFQTtBQUNBOzs7Ozs7O0FBRUE7QUFDQTs7O0FBS0E7QUFDQTs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUVBO0FBQUE7Ozs7OztBQUNBOzs7Ozs7OztBQUlBOzs7OztBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBREE7QUFDQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUdBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBOzs7Ozs7QUFFQTs7Ozs7Ozs7O0FBSUE7O0FBQ0E7QUFDQTs7QUFEQTtBQUNBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFFQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7Ozs7Ozs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQXJOQTtBQUNBO0FBQ0E7Ozs7OztBQXNOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBT0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWFBO0FBQ0E7QUFyQkE7QUFDQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///79\n");

/***/ }),
/* 80 */
/***/ (function(module, exports) {

eval("module.exports = {\n\t\"name\": \"botpress\",\n\t\"description\": \"The world's first CMS for bots. Easily create, manage and extend chatbots.\",\n\t\"version\": \"1.1.13\",\n\t\"author\": \"Botpress\",\n\t\"bin\": {\n\t\t\"bp\": \"./bin/botpress\",\n\t\t\"botpress\": \"./bin/botpress\"\n\t},\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/botpress/botpress/issues\"\n\t},\n\t\"dependencies\": {\n\t\t\"axios\": \"^0.15.2\",\n\t\t\"babel-polyfill\": \"^6.23.0\",\n\t\t\"bluebird\": \"^3.4.6\",\n\t\t\"body-parser\": \"^1.15.2\",\n\t\t\"chalk\": \"^1.1.3\",\n\t\t\"commander\": \"^2.9.0\",\n\t\t\"dotenv\": \"^4.0.0\",\n\t\t\"email-templates\": \"^2.5.4\",\n\t\t\"eventemitter2\": \"^2.1.3\",\n\t\t\"express\": \"^4.14.0\",\n\t\t\"formidable\": \"^1.1.1\",\n\t\t\"glob\": \"^7.1.2\",\n\t\t\"handlebars\": \"^4.0.6\",\n\t\t\"howler\": \"^2.0.3\",\n\t\t\"js-yaml\": \"^3.8.4\",\n\t\t\"jsonwebtoken\": \"^7.1.9\",\n\t\t\"knex\": \"^0.12.6\",\n\t\t\"lodash\": \"^4.16.4\",\n\t\t\"moment\": \"^2.15.1\",\n\t\t\"monitorctrlc\": \"^2.0.1\",\n\t\t\"ms\": \"^0.7.1\",\n\t\t\"multer\": \"^1.3.0\",\n\t\t\"mustache\": \"^2.3.0\",\n\t\t\"mware\": \"0.0.3\",\n\t\t\"node-machine-id\": \"^1.1.3\",\n\t\t\"nodemailer\": \"^2.7.2\",\n\t\t\"nodemon\": \"^1.12.1\",\n\t\t\"pg\": \"^6.1.2\",\n\t\t\"prompt\": \"^1.0.0\",\n\t\t\"react-codemirror\": \"^1.0.0\",\n\t\t\"react-jsonschema-form\": \"^0.49.0\",\n\t\t\"socket.io\": \"^1.5.0\",\n\t\t\"socket.io-client\": \"^2.0.3\",\n\t\t\"socketio-jwt\": \"^4.5.0\",\n\t\t\"source-map-support\": \"^0.4.6\",\n\t\t\"sqlite3\": \"^3.1.13\",\n\t\t\"universal-analytics\": \"^0.4.8\",\n\t\t\"uuid\": \"^3.0.0\",\n\t\t\"winston\": \"^2.2.0\"\n\t},\n\t\"devDependencies\": {\n\t\t\"autoprefixer\": \"^6.5.3\",\n\t\t\"babel-cli\": \"^6.16.0\",\n\t\t\"babel-core\": \"^6.18.0\",\n\t\t\"babel-loader\": \"^7.1.2\",\n\t\t\"babel-plugin-root-import\": \"^5.1.0\",\n\t\t\"babel-plugin-transform-decorators-legacy\": \"^1.3.4\",\n\t\t\"babel-plugin-transform-object-rest-spread\": \"^6.16.0\",\n\t\t\"babel-preset-latest\": \"^6.16.0\",\n\t\t\"babel-preset-react\": \"^6.11.1\",\n\t\t\"babel-preset-stage-0\": \"^6.16.0\",\n\t\t\"babel-register\": \"^6.16.3\",\n\t\t\"bootstrap\": \"^3.3.7\",\n\t\t\"chai\": \"^3.5.0\",\n\t\t\"classnames\": \"^2.2.5\",\n\t\t\"copy-webpack-plugin\": \"^4.2.0\",\n\t\t\"cross-os\": \"^1.2.2\",\n\t\t\"css-loader\": \"^0.25.0\",\n\t\t\"exports-loader\": \"^0.6.3\",\n\t\t\"expose-loader\": \"^0.7.1\",\n\t\t\"extract-text-webpack-plugin\": \"^3.0.1\",\n\t\t\"file-loader\": \"^0.9.0\",\n\t\t\"history\": \"^2.1.2\",\n\t\t\"husky\": \"0.14.3\",\n\t\t\"json-loader\": \"^0.5.4\",\n\t\t\"keymirror\": \"^0.1.1\",\n\t\t\"lint-staged\": \"4.3.0\",\n\t\t\"mkdirp\": \"^0.5.1\",\n\t\t\"mocha\": \"^3.1.2\",\n\t\t\"ncp\": \"^2.0.0\",\n\t\t\"node-sass\": \"^4.5.3\",\n\t\t\"npm-watch\": \"^0.1.6\",\n\t\t\"nuclear-js\": \"^1.4.0\",\n\t\t\"nuclear-js-react-addons\": \"^0.4.1\",\n\t\t\"postcss-loader\": \"^2.0.8\",\n\t\t\"prettier\": \"1.7.4\",\n\t\t\"prop-types\": \"^15.5.8\",\n\t\t\"react\": \"^15.3.1\",\n\t\t\"react-addons-css-transition-group\": \"^15.3.1\",\n\t\t\"react-addons-update\": \"^15.4.2\",\n\t\t\"react-bootstrap\": \"^0.30.3\",\n\t\t\"react-bootstrap-button-loader\": \"^1.0.7\",\n\t\t\"react-dom\": \"^15.3.1\",\n\t\t\"react-dropzone\": \"^4.1.3\",\n\t\t\"react-emoji\": \"^0.4.4\",\n\t\t\"react-fontawesome\": \"^1.2.0\",\n\t\t\"react-ga\": \"^2.1.2\",\n\t\t\"react-markdown\": \"^2.4.5\",\n\t\t\"react-router\": \"^2.8.1\",\n\t\t\"react-sidebar\": \"^2.2.1\",\n\t\t\"react-sortable\": \"^1.2.0\",\n\t\t\"rimraf\": \"^2.6.2\",\n\t\t\"sass-loader\": \"^6.0.6\",\n\t\t\"script-loader\": \"^0.7.0\",\n\t\t\"sinon\": \"^1.17.7\",\n\t\t\"style-loader\": \"^0.13.1\",\n\t\t\"tmp\": \"0.0.31\",\n\t\t\"uglifyjs-webpack-plugin\": \"^1.0.1\",\n\t\t\"webpack\": \"^3.8.1\",\n\t\t\"webpack-node-externals\": \"^1.6.0\"\n\t},\n\t\"engines\": {\n\t\t\"node\": \">=4.6.0 <9.0.0\"\n\t},\n\t\"homepage\": \"https://github.com/botpress/botpress#readme\",\n\t\"keywords\": [\n\t\t\"bots\",\n\t\t\"chatbots\",\n\t\t\"bot framework\",\n\t\t\"messenger\",\n\t\t\"facebook\",\n\t\t\"slack\",\n\t\t\"botkit\",\n\t\t\"microsoft bot framework\",\n\t\t\"bot builder\",\n\t\t\"bot\",\n\t\t\"chatbot\",\n\t\t\"api\"\n\t],\n\t\"license\": \"AGPL-3.0\",\n\t\"main\": \"lib/node.bundle.js\",\n\t\"repository\": \"git+https://github.com/botpress/botpress.git\",\n\t\"os\": [\n\t\t\"darwin\",\n\t\t\"linux\",\n\t\t\"win32\"\n\t],\n\t\"scripts\": {\n\t\t\"compile\": \"node ./build.js\",\n\t\t\"compile-prod\": \"cross-os compile-prod\",\n\t\t\"test\": \"cross-os test\",\n\t\t\"watch\": \"npm-watch\",\n\t\t\"precommit\": \"lint-staged\"\n\t},\n\t\"cross-os\": {\n\t\t\"compile-prod\": {\n\t\t\t\"darwin\": \"NODE_ENV=production node ./build.js && ls -lh ./lib/web/js && echo \\\"DONE\\\"\",\n\t\t\t\"linux\": \"NODE_ENV=production node ./build.js && ls -lh ./lib/web/js && echo \\\"DONE\\\"\",\n\t\t\t\"win32\": \"SET NODE_ENV=production&& node ./build.js && ls -lh ./lib/web/js && echo \\\"DONE\\\" && SET NODE_ENV=\"\n\t\t},\n\t\t\"test\": {\n\t\t\t\"darwin\": \"BABEL_ENV=tests mocha --compilers js:babel-core/register --require tests/index.js tests/** extensions/**/tests/**\",\n\t\t\t\"linux\": \"BABEL_ENV=tests mocha --compilers js:babel-core/register --require tests/index.js tests/** extensions/**/tests/**\",\n\t\t\t\"win32\": \"SET BABEL_ENV=tests&& mocha --compilers js:babel-core/register --require tests/index.js tests/** extensions/**/tests/** && SET BABEL_ENV=\"\n\t\t}\n\t},\n\t\"watch\": {\n\t\t\"compile\": {\n\t\t\t\"patterns\": [\n\t\t\t\t\"src\",\n\t\t\t\t\"extensions\"\n\t\t\t],\n\t\t\t\"extensions\": \"js,jsx,scss,json,html\"\n\t\t}\n\t},\n\t\"lint-staged\": {\n\t\t\"*.{js,jsx,json,css}\": [\n\t\t\t\"prettier --write\",\n\t\t\t\"git add\"\n\t\t]\n\t},\n\t\"pre-commit\": {\n\t\t\"run\": \"precommit\",\n\t\t\"silent\": true\n\t}\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWNrYWdlLmpzb24/ZWQ4OCJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcblx0XCJuYW1lXCI6IFwiYm90cHJlc3NcIixcblx0XCJkZXNjcmlwdGlvblwiOiBcIlRoZSB3b3JsZCdzIGZpcnN0IENNUyBmb3IgYm90cy4gRWFzaWx5IGNyZWF0ZSwgbWFuYWdlIGFuZCBleHRlbmQgY2hhdGJvdHMuXCIsXG5cdFwidmVyc2lvblwiOiBcIjEuMS4xM1wiLFxuXHRcImF1dGhvclwiOiBcIkJvdHByZXNzXCIsXG5cdFwiYmluXCI6IHtcblx0XHRcImJwXCI6IFwiLi9iaW4vYm90cHJlc3NcIixcblx0XHRcImJvdHByZXNzXCI6IFwiLi9iaW4vYm90cHJlc3NcIlxuXHR9LFxuXHRcImJ1Z3NcIjoge1xuXHRcdFwidXJsXCI6IFwiaHR0cHM6Ly9naXRodWIuY29tL2JvdHByZXNzL2JvdHByZXNzL2lzc3Vlc1wiXG5cdH0sXG5cdFwiZGVwZW5kZW5jaWVzXCI6IHtcblx0XHRcImF4aW9zXCI6IFwiXjAuMTUuMlwiLFxuXHRcdFwiYmFiZWwtcG9seWZpbGxcIjogXCJeNi4yMy4wXCIsXG5cdFx0XCJibHVlYmlyZFwiOiBcIl4zLjQuNlwiLFxuXHRcdFwiYm9keS1wYXJzZXJcIjogXCJeMS4xNS4yXCIsXG5cdFx0XCJjaGFsa1wiOiBcIl4xLjEuM1wiLFxuXHRcdFwiY29tbWFuZGVyXCI6IFwiXjIuOS4wXCIsXG5cdFx0XCJkb3RlbnZcIjogXCJeNC4wLjBcIixcblx0XHRcImVtYWlsLXRlbXBsYXRlc1wiOiBcIl4yLjUuNFwiLFxuXHRcdFwiZXZlbnRlbWl0dGVyMlwiOiBcIl4yLjEuM1wiLFxuXHRcdFwiZXhwcmVzc1wiOiBcIl40LjE0LjBcIixcblx0XHRcImZvcm1pZGFibGVcIjogXCJeMS4xLjFcIixcblx0XHRcImdsb2JcIjogXCJeNy4xLjJcIixcblx0XHRcImhhbmRsZWJhcnNcIjogXCJeNC4wLjZcIixcblx0XHRcImhvd2xlclwiOiBcIl4yLjAuM1wiLFxuXHRcdFwianMteWFtbFwiOiBcIl4zLjguNFwiLFxuXHRcdFwianNvbndlYnRva2VuXCI6IFwiXjcuMS45XCIsXG5cdFx0XCJrbmV4XCI6IFwiXjAuMTIuNlwiLFxuXHRcdFwibG9kYXNoXCI6IFwiXjQuMTYuNFwiLFxuXHRcdFwibW9tZW50XCI6IFwiXjIuMTUuMVwiLFxuXHRcdFwibW9uaXRvcmN0cmxjXCI6IFwiXjIuMC4xXCIsXG5cdFx0XCJtc1wiOiBcIl4wLjcuMVwiLFxuXHRcdFwibXVsdGVyXCI6IFwiXjEuMy4wXCIsXG5cdFx0XCJtdXN0YWNoZVwiOiBcIl4yLjMuMFwiLFxuXHRcdFwibXdhcmVcIjogXCIwLjAuM1wiLFxuXHRcdFwibm9kZS1tYWNoaW5lLWlkXCI6IFwiXjEuMS4zXCIsXG5cdFx0XCJub2RlbWFpbGVyXCI6IFwiXjIuNy4yXCIsXG5cdFx0XCJub2RlbW9uXCI6IFwiXjEuMTIuMVwiLFxuXHRcdFwicGdcIjogXCJeNi4xLjJcIixcblx0XHRcInByb21wdFwiOiBcIl4xLjAuMFwiLFxuXHRcdFwicmVhY3QtY29kZW1pcnJvclwiOiBcIl4xLjAuMFwiLFxuXHRcdFwicmVhY3QtanNvbnNjaGVtYS1mb3JtXCI6IFwiXjAuNDkuMFwiLFxuXHRcdFwic29ja2V0LmlvXCI6IFwiXjEuNS4wXCIsXG5cdFx0XCJzb2NrZXQuaW8tY2xpZW50XCI6IFwiXjIuMC4zXCIsXG5cdFx0XCJzb2NrZXRpby1qd3RcIjogXCJeNC41LjBcIixcblx0XHRcInNvdXJjZS1tYXAtc3VwcG9ydFwiOiBcIl4wLjQuNlwiLFxuXHRcdFwic3FsaXRlM1wiOiBcIl4zLjEuMTNcIixcblx0XHRcInVuaXZlcnNhbC1hbmFseXRpY3NcIjogXCJeMC40LjhcIixcblx0XHRcInV1aWRcIjogXCJeMy4wLjBcIixcblx0XHRcIndpbnN0b25cIjogXCJeMi4yLjBcIlxuXHR9LFxuXHRcImRldkRlcGVuZGVuY2llc1wiOiB7XG5cdFx0XCJhdXRvcHJlZml4ZXJcIjogXCJeNi41LjNcIixcblx0XHRcImJhYmVsLWNsaVwiOiBcIl42LjE2LjBcIixcblx0XHRcImJhYmVsLWNvcmVcIjogXCJeNi4xOC4wXCIsXG5cdFx0XCJiYWJlbC1sb2FkZXJcIjogXCJeNy4xLjJcIixcblx0XHRcImJhYmVsLXBsdWdpbi1yb290LWltcG9ydFwiOiBcIl41LjEuMFwiLFxuXHRcdFwiYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1kZWNvcmF0b3JzLWxlZ2FjeVwiOiBcIl4xLjMuNFwiLFxuXHRcdFwiYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1vYmplY3QtcmVzdC1zcHJlYWRcIjogXCJeNi4xNi4wXCIsXG5cdFx0XCJiYWJlbC1wcmVzZXQtbGF0ZXN0XCI6IFwiXjYuMTYuMFwiLFxuXHRcdFwiYmFiZWwtcHJlc2V0LXJlYWN0XCI6IFwiXjYuMTEuMVwiLFxuXHRcdFwiYmFiZWwtcHJlc2V0LXN0YWdlLTBcIjogXCJeNi4xNi4wXCIsXG5cdFx0XCJiYWJlbC1yZWdpc3RlclwiOiBcIl42LjE2LjNcIixcblx0XHRcImJvb3RzdHJhcFwiOiBcIl4zLjMuN1wiLFxuXHRcdFwiY2hhaVwiOiBcIl4zLjUuMFwiLFxuXHRcdFwiY2xhc3NuYW1lc1wiOiBcIl4yLjIuNVwiLFxuXHRcdFwiY29weS13ZWJwYWNrLXBsdWdpblwiOiBcIl40LjIuMFwiLFxuXHRcdFwiY3Jvc3Mtb3NcIjogXCJeMS4yLjJcIixcblx0XHRcImNzcy1sb2FkZXJcIjogXCJeMC4yNS4wXCIsXG5cdFx0XCJleHBvcnRzLWxvYWRlclwiOiBcIl4wLjYuM1wiLFxuXHRcdFwiZXhwb3NlLWxvYWRlclwiOiBcIl4wLjcuMVwiLFxuXHRcdFwiZXh0cmFjdC10ZXh0LXdlYnBhY2stcGx1Z2luXCI6IFwiXjMuMC4xXCIsXG5cdFx0XCJmaWxlLWxvYWRlclwiOiBcIl4wLjkuMFwiLFxuXHRcdFwiaGlzdG9yeVwiOiBcIl4yLjEuMlwiLFxuXHRcdFwiaHVza3lcIjogXCIwLjE0LjNcIixcblx0XHRcImpzb24tbG9hZGVyXCI6IFwiXjAuNS40XCIsXG5cdFx0XCJrZXltaXJyb3JcIjogXCJeMC4xLjFcIixcblx0XHRcImxpbnQtc3RhZ2VkXCI6IFwiNC4zLjBcIixcblx0XHRcIm1rZGlycFwiOiBcIl4wLjUuMVwiLFxuXHRcdFwibW9jaGFcIjogXCJeMy4xLjJcIixcblx0XHRcIm5jcFwiOiBcIl4yLjAuMFwiLFxuXHRcdFwibm9kZS1zYXNzXCI6IFwiXjQuNS4zXCIsXG5cdFx0XCJucG0td2F0Y2hcIjogXCJeMC4xLjZcIixcblx0XHRcIm51Y2xlYXItanNcIjogXCJeMS40LjBcIixcblx0XHRcIm51Y2xlYXItanMtcmVhY3QtYWRkb25zXCI6IFwiXjAuNC4xXCIsXG5cdFx0XCJwb3N0Y3NzLWxvYWRlclwiOiBcIl4yLjAuOFwiLFxuXHRcdFwicHJldHRpZXJcIjogXCIxLjcuNFwiLFxuXHRcdFwicHJvcC10eXBlc1wiOiBcIl4xNS41LjhcIixcblx0XHRcInJlYWN0XCI6IFwiXjE1LjMuMVwiLFxuXHRcdFwicmVhY3QtYWRkb25zLWNzcy10cmFuc2l0aW9uLWdyb3VwXCI6IFwiXjE1LjMuMVwiLFxuXHRcdFwicmVhY3QtYWRkb25zLXVwZGF0ZVwiOiBcIl4xNS40LjJcIixcblx0XHRcInJlYWN0LWJvb3RzdHJhcFwiOiBcIl4wLjMwLjNcIixcblx0XHRcInJlYWN0LWJvb3RzdHJhcC1idXR0b24tbG9hZGVyXCI6IFwiXjEuMC43XCIsXG5cdFx0XCJyZWFjdC1kb21cIjogXCJeMTUuMy4xXCIsXG5cdFx0XCJyZWFjdC1kcm9wem9uZVwiOiBcIl40LjEuM1wiLFxuXHRcdFwicmVhY3QtZW1vamlcIjogXCJeMC40LjRcIixcblx0XHRcInJlYWN0LWZvbnRhd2Vzb21lXCI6IFwiXjEuMi4wXCIsXG5cdFx0XCJyZWFjdC1nYVwiOiBcIl4yLjEuMlwiLFxuXHRcdFwicmVhY3QtbWFya2Rvd25cIjogXCJeMi40LjVcIixcblx0XHRcInJlYWN0LXJvdXRlclwiOiBcIl4yLjguMVwiLFxuXHRcdFwicmVhY3Qtc2lkZWJhclwiOiBcIl4yLjIuMVwiLFxuXHRcdFwicmVhY3Qtc29ydGFibGVcIjogXCJeMS4yLjBcIixcblx0XHRcInJpbXJhZlwiOiBcIl4yLjYuMlwiLFxuXHRcdFwic2Fzcy1sb2FkZXJcIjogXCJeNi4wLjZcIixcblx0XHRcInNjcmlwdC1sb2FkZXJcIjogXCJeMC43LjBcIixcblx0XHRcInNpbm9uXCI6IFwiXjEuMTcuN1wiLFxuXHRcdFwic3R5bGUtbG9hZGVyXCI6IFwiXjAuMTMuMVwiLFxuXHRcdFwidG1wXCI6IFwiMC4wLjMxXCIsXG5cdFx0XCJ1Z2xpZnlqcy13ZWJwYWNrLXBsdWdpblwiOiBcIl4xLjAuMVwiLFxuXHRcdFwid2VicGFja1wiOiBcIl4zLjguMVwiLFxuXHRcdFwid2VicGFjay1ub2RlLWV4dGVybmFsc1wiOiBcIl4xLjYuMFwiXG5cdH0sXG5cdFwiZW5naW5lc1wiOiB7XG5cdFx0XCJub2RlXCI6IFwiPj00LjYuMCA8OS4wLjBcIlxuXHR9LFxuXHRcImhvbWVwYWdlXCI6IFwiaHR0cHM6Ly9naXRodWIuY29tL2JvdHByZXNzL2JvdHByZXNzI3JlYWRtZVwiLFxuXHRcImtleXdvcmRzXCI6IFtcblx0XHRcImJvdHNcIixcblx0XHRcImNoYXRib3RzXCIsXG5cdFx0XCJib3QgZnJhbWV3b3JrXCIsXG5cdFx0XCJtZXNzZW5nZXJcIixcblx0XHRcImZhY2Vib29rXCIsXG5cdFx0XCJzbGFja1wiLFxuXHRcdFwiYm90a2l0XCIsXG5cdFx0XCJtaWNyb3NvZnQgYm90IGZyYW1ld29ya1wiLFxuXHRcdFwiYm90IGJ1aWxkZXJcIixcblx0XHRcImJvdFwiLFxuXHRcdFwiY2hhdGJvdFwiLFxuXHRcdFwiYXBpXCJcblx0XSxcblx0XCJsaWNlbnNlXCI6IFwiQUdQTC0zLjBcIixcblx0XCJtYWluXCI6IFwibGliL25vZGUuYnVuZGxlLmpzXCIsXG5cdFwicmVwb3NpdG9yeVwiOiBcImdpdCtodHRwczovL2dpdGh1Yi5jb20vYm90cHJlc3MvYm90cHJlc3MuZ2l0XCIsXG5cdFwib3NcIjogW1xuXHRcdFwiZGFyd2luXCIsXG5cdFx0XCJsaW51eFwiLFxuXHRcdFwid2luMzJcIlxuXHRdLFxuXHRcInNjcmlwdHNcIjoge1xuXHRcdFwiY29tcGlsZVwiOiBcIm5vZGUgLi9idWlsZC5qc1wiLFxuXHRcdFwiY29tcGlsZS1wcm9kXCI6IFwiY3Jvc3Mtb3MgY29tcGlsZS1wcm9kXCIsXG5cdFx0XCJ0ZXN0XCI6IFwiY3Jvc3Mtb3MgdGVzdFwiLFxuXHRcdFwid2F0Y2hcIjogXCJucG0td2F0Y2hcIixcblx0XHRcInByZWNvbW1pdFwiOiBcImxpbnQtc3RhZ2VkXCJcblx0fSxcblx0XCJjcm9zcy1vc1wiOiB7XG5cdFx0XCJjb21waWxlLXByb2RcIjoge1xuXHRcdFx0XCJkYXJ3aW5cIjogXCJOT0RFX0VOVj1wcm9kdWN0aW9uIG5vZGUgLi9idWlsZC5qcyAmJiBscyAtbGggLi9saWIvd2ViL2pzICYmIGVjaG8gXFxcIkRPTkVcXFwiXCIsXG5cdFx0XHRcImxpbnV4XCI6IFwiTk9ERV9FTlY9cHJvZHVjdGlvbiBub2RlIC4vYnVpbGQuanMgJiYgbHMgLWxoIC4vbGliL3dlYi9qcyAmJiBlY2hvIFxcXCJET05FXFxcIlwiLFxuXHRcdFx0XCJ3aW4zMlwiOiBcIlNFVCBOT0RFX0VOVj1wcm9kdWN0aW9uJiYgbm9kZSAuL2J1aWxkLmpzICYmIGxzIC1saCAuL2xpYi93ZWIvanMgJiYgZWNobyBcXFwiRE9ORVxcXCIgJiYgU0VUIE5PREVfRU5WPVwiXG5cdFx0fSxcblx0XHRcInRlc3RcIjoge1xuXHRcdFx0XCJkYXJ3aW5cIjogXCJCQUJFTF9FTlY9dGVzdHMgbW9jaGEgLS1jb21waWxlcnMganM6YmFiZWwtY29yZS9yZWdpc3RlciAtLXJlcXVpcmUgdGVzdHMvaW5kZXguanMgdGVzdHMvKiogZXh0ZW5zaW9ucy8qKi90ZXN0cy8qKlwiLFxuXHRcdFx0XCJsaW51eFwiOiBcIkJBQkVMX0VOVj10ZXN0cyBtb2NoYSAtLWNvbXBpbGVycyBqczpiYWJlbC1jb3JlL3JlZ2lzdGVyIC0tcmVxdWlyZSB0ZXN0cy9pbmRleC5qcyB0ZXN0cy8qKiBleHRlbnNpb25zLyoqL3Rlc3RzLyoqXCIsXG5cdFx0XHRcIndpbjMyXCI6IFwiU0VUIEJBQkVMX0VOVj10ZXN0cyYmIG1vY2hhIC0tY29tcGlsZXJzIGpzOmJhYmVsLWNvcmUvcmVnaXN0ZXIgLS1yZXF1aXJlIHRlc3RzL2luZGV4LmpzIHRlc3RzLyoqIGV4dGVuc2lvbnMvKiovdGVzdHMvKiogJiYgU0VUIEJBQkVMX0VOVj1cIlxuXHRcdH1cblx0fSxcblx0XCJ3YXRjaFwiOiB7XG5cdFx0XCJjb21waWxlXCI6IHtcblx0XHRcdFwicGF0dGVybnNcIjogW1xuXHRcdFx0XHRcInNyY1wiLFxuXHRcdFx0XHRcImV4dGVuc2lvbnNcIlxuXHRcdFx0XSxcblx0XHRcdFwiZXh0ZW5zaW9uc1wiOiBcImpzLGpzeCxzY3NzLGpzb24saHRtbFwiXG5cdFx0fVxuXHR9LFxuXHRcImxpbnQtc3RhZ2VkXCI6IHtcblx0XHRcIioue2pzLGpzeCxqc29uLGNzc31cIjogW1xuXHRcdFx0XCJwcmV0dGllciAtLXdyaXRlXCIsXG5cdFx0XHRcImdpdCBhZGRcIlxuXHRcdF1cblx0fSxcblx0XCJwcmUtY29tbWl0XCI6IHtcblx0XHRcInJ1blwiOiBcInByZWNvbW1pdFwiLFxuXHRcdFwic2lsZW50XCI6IHRydWVcblx0fVxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3BhY2thZ2UuanNvblxuLy8gbW9kdWxlIGlkID0gODBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///80\n");

/***/ }),
/* 81 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = function () {};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2VtYWlscy9pbmRleC5qcz83M2M3Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gKCkgPT4ge31cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gZXh0ZW5zaW9ucy9saXRlL2VtYWlscy9pbmRleC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///81\n");

/***/ }),
/* 82 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nmodule.exports = function (bp) {\n  return {\n    install: function install() {},\n    uninstall: function uninstall() {}\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL21lZGlhdG9yL2luZGV4LmpzPzZiMDUiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBicCA9PiAoe1xuICBpbnN0YWxsOiAoKSA9PiB7fSxcbiAgdW5pbnN0YWxsOiAoKSA9PiB7fVxufSlcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBleHRlbnNpb25zL2xpdGUvbWVkaWF0b3IvaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFGQTtBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///82\n");

/***/ }),
/* 83 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _express = __webpack_require__(15);\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _http = __webpack_require__(84);\n\nvar _http2 = _interopRequireDefault(_http);\n\nvar _socket = __webpack_require__(85);\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _static = __webpack_require__(88);\n\nvar _static2 = _interopRequireDefault(_static);\n\nvar _api = __webpack_require__(89);\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp) {\n  var serveApi = function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(app) {\n      var api;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              api = (0, _api2.default)(bp);\n              return _context.abrupt('return', api.install(app));\n\n            case 2:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function serveApi(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var serveSocket = function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(server) {\n      var socket;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              socket = (0, _socket2.default)(bp);\n              return _context2.abrupt('return', socket.install(server));\n\n            case 2:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    return function serveSocket(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var serveStatic = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(app) {\n      var staticStuff;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              staticStuff = (0, _static2.default)(bp);\n              return _context3.abrupt('return', staticStuff.install(app));\n\n            case 2:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function serveStatic(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var start = function () {\n    var _ref4 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4() {\n      var app, server, port;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              app = (0, _express2.default)();\n              server = _http2.default.createServer(app);\n              port = bp.botfile.port;\n              _context4.next = 5;\n              return serveApi(app);\n\n            case 5:\n              _context4.next = 7;\n              return serveSocket(server);\n\n            case 7:\n              _context4.next = 9;\n              return serveStatic(app);\n\n            case 9:\n              return _context4.abrupt('return', new Promise(function (resolve) {\n                server.listen(port, function () {\n                  return resolve();\n                });\n              }));\n\n            case 10:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, this);\n    }));\n\n    return function start() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return { start: start };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9pbmRleC5qcz82ZTBkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnXG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJ1xuXG5pbXBvcnQgU29ja2V0IGZyb20gJy4vc29ja2V0J1xuaW1wb3J0IFN0YXRpYyBmcm9tICcuL3N0YXRpYydcbmltcG9ydCBBcGkgZnJvbSAnLi9hcGknXG5cbm1vZHVsZS5leHBvcnRzID0gYnAgPT4ge1xuXG4gIGFzeW5jIGZ1bmN0aW9uIHNlcnZlQXBpKGFwcCkge1xuICAgIGNvbnN0IGFwaSA9IEFwaShicClcbiAgICByZXR1cm4gYXBpLmluc3RhbGwoYXBwKVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gc2VydmVTb2NrZXQoc2VydmVyKSB7XG4gICAgY29uc3Qgc29ja2V0ID0gU29ja2V0KGJwKVxuICAgIHJldHVybiBzb2NrZXQuaW5zdGFsbChzZXJ2ZXIpXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBzZXJ2ZVN0YXRpYyhhcHApIHtcbiAgICBjb25zdCBzdGF0aWNTdHVmZiA9IFN0YXRpYyhicClcbiAgICByZXR1cm4gc3RhdGljU3R1ZmYuaW5zdGFsbChhcHApXG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICBjb25zdCBhcHAgPSBleHByZXNzKClcbiAgICBjb25zdCBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcihhcHApXG4gICAgY29uc3QgcG9ydCA9IGJwLmJvdGZpbGUucG9ydFxuXG4gICAgYXdhaXQgc2VydmVBcGkoYXBwKVxuICAgIGF3YWl0IHNlcnZlU29ja2V0KHNlcnZlcilcbiAgICBhd2FpdCBzZXJ2ZVN0YXRpYyhhcHApXG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICBzZXJ2ZXIubGlzdGVuKHBvcnQsICgpID0+IHJlc29sdmUoKSlcbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIHsgc3RhcnQgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9zZXJ2ZXIvaW5kZXguanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFPQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVJBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBWUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFiQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQWlCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFVQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBWkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQWxCQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBOEJBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///83\n");

/***/ }),
/* 84 */
/***/ (function(module, exports) {

eval("module.exports = require(\"http\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJodHRwXCI/OGU0NCJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJodHRwXCIpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiaHR0cFwiXG4vLyBtb2R1bGUgaWQgPSA4NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///84\n");

/***/ }),
/* 85 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _socket = __webpack_require__(86);\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nvar _socketioJwt = __webpack_require__(87);\n\nvar _socketioJwt2 = _interopRequireDefault(_socketioJwt);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp) {\n  var install = function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(server) {\n      var io, admin, guest;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              io = (0, _socket2.default)(server);\n              admin = io.of('/admin');\n              guest = io.of('/guest');\n\n              if (!bp.botfile.login.enabled) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.t0 = admin;\n              _context.t1 = _socketioJwt2.default;\n              _context.next = 8;\n              return bp.security.getSecret();\n\n            case 8:\n              _context.t2 = _context.sent;\n              _context.t3 = {\n                secret: _context.t2,\n                handshake: true\n              };\n              _context.t4 = _context.t1.authorize.call(_context.t1, _context.t3);\n\n              _context.t0.use.call(_context.t0, _context.t4);\n\n            case 12:\n\n              admin.on('connection', function (socket) {\n                var visitorId = _lodash2.default.get(socket, 'handshake.query.visitorId');\n                bp.stats.track('socket', 'connected');\n\n                socket.on('event', function (event) {\n                  bp.events.emit(event.name, event.data, 'client', {\n                    visitorId: visitorId,\n                    socketId: socket.id,\n                    guest: false,\n                    admin: true\n                  });\n                });\n              });\n\n              guest.on('connection', function (socket) {\n                var visitorId = _lodash2.default.get(socket, 'handshake.query.visitorId');\n                bp.stats.track('socket', 'connected');\n\n                if (visitorId && visitorId.length > 0) {\n                  socket.join('visitor:' + visitorId);\n                }\n\n                socket.on('event', function (event) {\n                  bp.events.emit(event.name, event.data, 'client', {\n                    socketId: socket.id,\n                    visitorId: visitorId,\n                    guest: true,\n                    admin: false\n                  });\n                });\n              });\n\n              bp.events.onAny(function (event, data, from) {\n                if (from === 'client') {\n                  return; // we sent this ourselves\n                }\n\n                var c = event.startsWith('guest.') ? guest : admin;\n\n                if (data && (data.__socketId || data.__room)) {\n                  // Send only to this socketId or room\n                  return c.to(data.__socketId || data.__room).emit('event', {\n                    name: event,\n                    data: data\n                  });\n                }\n\n                // broadcast event to the front-end clients\n                c.emit('event', {\n                  name: event,\n                  data: data\n                });\n              });\n\n            case 15:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function install(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return { install: install };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODUuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9zb2NrZXQuanM/Yzk3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgc29ja2V0aW8gZnJvbSAnc29ja2V0LmlvJ1xuaW1wb3J0IHNvY2tldGlvSnd0IGZyb20gJ3NvY2tldGlvLWp3dCdcblxubW9kdWxlLmV4cG9ydHMgPSBicCA9PiB7XG5cbiAgYXN5bmMgZnVuY3Rpb24gaW5zdGFsbChzZXJ2ZXIpIHtcbiAgICBjb25zdCBpbyA9IHNvY2tldGlvKHNlcnZlcilcblxuICAgIGNvbnN0IGFkbWluID0gaW8ub2YoJy9hZG1pbicpXG4gICAgY29uc3QgZ3Vlc3QgPSBpby5vZignL2d1ZXN0JylcblxuICAgIGlmIChicC5ib3RmaWxlLmxvZ2luLmVuYWJsZWQpIHtcbiAgICAgIGFkbWluLnVzZShzb2NrZXRpb0p3dC5hdXRob3JpemUoe1xuICAgICAgICBzZWNyZXQ6IGF3YWl0IGJwLnNlY3VyaXR5LmdldFNlY3JldCgpLFxuICAgICAgICBoYW5kc2hha2U6IHRydWVcbiAgICAgIH0pKVxuICAgIH1cblxuICAgIGFkbWluLm9uKCdjb25uZWN0aW9uJywgZnVuY3Rpb24oc29ja2V0KSB7XG4gICAgICBjb25zdCB2aXNpdG9ySWQgPSBfLmdldChzb2NrZXQsICdoYW5kc2hha2UucXVlcnkudmlzaXRvcklkJylcbiAgICAgIGJwLnN0YXRzLnRyYWNrKCdzb2NrZXQnLCAnY29ubmVjdGVkJylcblxuICAgICAgc29ja2V0Lm9uKCdldmVudCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGJwLmV2ZW50cy5lbWl0KGV2ZW50Lm5hbWUsIGV2ZW50LmRhdGEsICdjbGllbnQnLCB7XG4gICAgICAgICAgdmlzaXRvcklkOiB2aXNpdG9ySWQsXG4gICAgICAgICAgc29ja2V0SWQ6IHNvY2tldC5pZCxcbiAgICAgICAgICBndWVzdDogZmFsc2UsXG4gICAgICAgICAgYWRtaW46IHRydWVcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcblxuICAgIGd1ZXN0Lm9uKCdjb25uZWN0aW9uJywgZnVuY3Rpb24oc29ja2V0KSB7XG4gICAgICBjb25zdCB2aXNpdG9ySWQgPSBfLmdldChzb2NrZXQsICdoYW5kc2hha2UucXVlcnkudmlzaXRvcklkJylcbiAgICAgIGJwLnN0YXRzLnRyYWNrKCdzb2NrZXQnLCAnY29ubmVjdGVkJylcblxuICAgICAgaWYgKHZpc2l0b3JJZCAmJiB2aXNpdG9ySWQubGVuZ3RoID4gMCkge1xuICAgICAgICBzb2NrZXQuam9pbigndmlzaXRvcjonICsgdmlzaXRvcklkKVxuICAgICAgfVxuXG4gICAgICBzb2NrZXQub24oJ2V2ZW50JywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgYnAuZXZlbnRzLmVtaXQoZXZlbnQubmFtZSwgZXZlbnQuZGF0YSwgJ2NsaWVudCcsIHtcbiAgICAgICAgICBzb2NrZXRJZDogc29ja2V0LmlkLFxuICAgICAgICAgIHZpc2l0b3JJZDogdmlzaXRvcklkLFxuICAgICAgICAgIGd1ZXN0OiB0cnVlLFxuICAgICAgICAgIGFkbWluOiBmYWxzZVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgYnAuZXZlbnRzLm9uQW55KGZ1bmN0aW9uKGV2ZW50LCBkYXRhLCBmcm9tKSB7XG4gICAgICBpZiAoZnJvbSA9PT0gJ2NsaWVudCcpIHtcbiAgICAgICAgcmV0dXJuIC8vIHdlIHNlbnQgdGhpcyBvdXJzZWx2ZXNcbiAgICAgIH1cblxuICAgICAgbGV0IGMgPSBldmVudC5zdGFydHNXaXRoKCdndWVzdC4nKSA/IGd1ZXN0IDogYWRtaW5cblxuICAgICAgaWYgKGRhdGEgJiYgKGRhdGEuX19zb2NrZXRJZCB8fCBkYXRhLl9fcm9vbSkpIHtcbiAgICAgICAgLy8gU2VuZCBvbmx5IHRvIHRoaXMgc29ja2V0SWQgb3Igcm9vbVxuICAgICAgICByZXR1cm4gYy50byhkYXRhLl9fc29ja2V0SWQgfHwgZGF0YS5fX3Jvb20pLmVtaXQoJ2V2ZW50Jywge1xuICAgICAgICAgIG5hbWU6IGV2ZW50LFxuICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgLy8gYnJvYWRjYXN0IGV2ZW50IHRvIHRoZSBmcm9udC1lbmQgY2xpZW50c1xuICAgICAgYy5lbWl0KCdldmVudCcsIHtcbiAgICAgICAgbmFtZTogZXZlbnQsXG4gICAgICAgIGRhdGE6IGRhdGFcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB7IGluc3RhbGwgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9zZXJ2ZXIvc29ja2V0LmpzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFMQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQVFBO0FBQ0E7QUFUQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQWxFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBSEE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXFFQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///85\n");

/***/ }),
/* 86 */
/***/ (function(module, exports) {

eval("module.exports = require(\"socket.io\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb2NrZXQuaW9cIj81MTA1Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvY2tldC5pb1wiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInNvY2tldC5pb1wiXG4vLyBtb2R1bGUgaWQgPSA4NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///86\n");

/***/ }),
/* 87 */
/***/ (function(module, exports) {

eval("module.exports = require(\"socketio-jwt\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODcuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb2NrZXRpby1qd3RcIj83OGQ5Il0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNvY2tldGlvLWp3dFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInNvY2tldGlvLWp3dFwiXG4vLyBtb2R1bGUgaWQgPSA4N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///87\n");

/***/ }),
/* 88 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _express = __webpack_require__(15);\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _ms = __webpack_require__(14);\n\nvar _ms2 = _interopRequireDefault(_ms);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; } /* global BP_EDITION */\n\nmodule.exports = function (bp) {\n  var install = function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(app) {\n      var name, _module;\n\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              for (name in bp._loadedModules) {\n                _module = bp._loadedModules[name];\n\n                serveModule(app, _module);\n              }\n\n              app.use('/js/env.js', function (req, res) {\n                var _bp$botfile$login = bp.botfile.login,\n                    tokenExpiry = _bp$botfile$login.tokenExpiry,\n                    enabled = _bp$botfile$login.enabled;\n\n                var optOutStats = !!bp.botfile.optOutStats;\n                var appName = bp.botfile.appName || 'Botpress';\n\n                var isFirstRun = bp.isFirstRun,\n                    version = bp.version;\n\n                res.contentType('text/javascript');\n                res.send('(function(window) {\\n        window.NODE_ENV = \"' + (process.env.NODE_ENV || 'development') + '\";\\n        window.DEV_MODE = ' + _util2.default.isDeveloping + ';\\n        window.AUTH_ENABLED = ' + enabled + ';\\n        window.AUTH_TOKEN_DURATION = ' + (0, _ms2.default)(tokenExpiry) + ';\\n        window.OPT_OUT_STATS = ' + optOutStats + ';\\n        window.SHOW_GUIDED_TOUR = ' + isFirstRun + ';\\n        window.BOTPRESS_VERSION = \"' + version + '\";\\n        window.APP_NAME = \"' + appName + '\";\\n      })(window || {})');\n              });\n\n              serveCustomTheme(app);\n\n              app.use(_express2.default.static(_path2.default.join(bp.projectLocation, 'static')));\n\n              app.use(_express2.default.static(_path2.default.join(__dirname, '../lib/web')));\n\n              app.get('*', function (req, res, next) {\n                // If browser requests HTML and request isn't an API request\n                if (/html/i.test(req.headers.accept) && !/^\\/api\\//i.test(req.url)) {\n                  if (req.url && /^\\/lite\\//i.test(req.url)) {\n                    return res.sendFile(_path2.default.join(__dirname, '../lib/web/lite.html'));\n                  }\n\n                  return res.sendFile(_path2.default.join(__dirname, '../lib/web/index.html'));\n                }\n                next();\n              });\n\n              return _context.abrupt('return', _bluebird2.default.resolve(true));\n\n            case 7:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function install(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  function serveModule(app, module) {\n    var name = module.name;\n    var shortName = module.name.replace(/botpress-/i, '');\n\n    if (module.settings.menuIcon === 'custom') {\n      (function () {\n        var iconRequestPath = '/img/modules/' + name + '.png';\n        var iconPath = _path2.default.join(module.root, 'icon.png');\n\n        app.get(iconRequestPath, function (req, res) {\n          try {\n            var content = _fs2.default.readFileSync(iconPath);\n            res.contentType('image/png');\n            res.send(content);\n          } catch (err) {\n            bp.logger.warn('Could not serve module icon [' + name + '] at: ' + iconPath);\n          }\n        });\n      })();\n    }\n\n    var liteDir = _path2.default.join(module.root, module.settings.liteDir || 'bin/lite');\n    var liteViews = _fs2.default.existsSync(liteDir) ? _fs2.default.readdirSync(liteDir).filter(function (b) {\n      return b.endsWith('.js');\n    }) : [];\n\n    app.get(['/js/modules/' + shortName, // The full module view\n    '/js/modules/' + name + '.js', // <<-- DEPRECATED: Will be removed shortly. Only use shortNames\n    '/js/modules/' + shortName + '/:subview' // Lite view\n    ], function (req, res) {\n      var settingsKey = module.settings.webBundle;\n      var bundlePath = _path2.default.join(module.root, settingsKey || 'bin/web.bundle.js');\n\n      if (req.params && req.params.subview) {\n        // Render lite view\n        bundlePath = _path2.default.join(liteDir, req.params.subview + '.bundle.js');\n      }\n\n      try {\n        var content = _fs2.default.readFileSync(bundlePath);\n        res.contentType('text/javascript');\n        res.send(content);\n      } catch (err) {\n        bp.logger.warn('Could not serve module [' + name + '] at: ' + bundlePath);\n        res.sendStatus(404);\n      }\n    });\n  }\n\n  function serveCustomTheme(app) {\n    var customTheme = '';\n\n    if (false) {\n      var themeLocation = _path2.default.join(bp.projectLocation, 'theme.css');\n      if (_fs2.default.existsSync(themeLocation)) {\n        customTheme = _fs2.default.readFileSync(themeLocation);\n      }\n    }\n\n    app.use('/style/custom-theme.css', function (req, res) {\n      res.contentType('text/css');\n      res.send(customTheme);\n    });\n  }\n\n  return { install: install };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODguanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9zdGF0aWMuanM/MDY0MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgQlBfRURJVElPTiAqL1xuXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdibHVlYmlyZCdcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IG1zIGZyb20gJ21zJ1xuaW1wb3J0IHV0aWwgZnJvbSAnLi4vdXRpbCdcblxubW9kdWxlLmV4cG9ydHMgPSBicCA9PiB7XG4gIGZ1bmN0aW9uIHNlcnZlTW9kdWxlKGFwcCwgbW9kdWxlKSB7XG4gICAgY29uc3QgbmFtZSA9IG1vZHVsZS5uYW1lXG4gICAgY29uc3Qgc2hvcnROYW1lID0gbW9kdWxlLm5hbWUucmVwbGFjZSgvYm90cHJlc3MtL2ksICcnKVxuXG4gICAgaWYgKG1vZHVsZS5zZXR0aW5ncy5tZW51SWNvbiA9PT0gJ2N1c3RvbScpIHtcbiAgICAgIGNvbnN0IGljb25SZXF1ZXN0UGF0aCA9IGAvaW1nL21vZHVsZXMvJHtuYW1lfS5wbmdgXG4gICAgICBjb25zdCBpY29uUGF0aCA9IHBhdGguam9pbihtb2R1bGUucm9vdCwgJ2ljb24ucG5nJylcblxuICAgICAgYXBwLmdldChpY29uUmVxdWVzdFBhdGgsIChyZXEsIHJlcykgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoaWNvblBhdGgpXG4gICAgICAgICAgcmVzLmNvbnRlbnRUeXBlKCdpbWFnZS9wbmcnKVxuICAgICAgICAgIHJlcy5zZW5kKGNvbnRlbnQpXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGJwLmxvZ2dlci53YXJuKGBDb3VsZCBub3Qgc2VydmUgbW9kdWxlIGljb24gWyR7bmFtZX1dIGF0OiAke2ljb25QYXRofWApXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgbGl0ZURpciA9IHBhdGguam9pbihtb2R1bGUucm9vdCwgbW9kdWxlLnNldHRpbmdzLmxpdGVEaXIgfHwgJ2Jpbi9saXRlJylcbiAgICBjb25zdCBsaXRlVmlld3MgPSBmcy5leGlzdHNTeW5jKGxpdGVEaXIpID8gZnMucmVhZGRpclN5bmMobGl0ZURpcikuZmlsdGVyKGIgPT4gYi5lbmRzV2l0aCgnLmpzJykpIDogW11cblxuICAgIGFwcC5nZXQoXG4gICAgICBbXG4gICAgICAgIGAvanMvbW9kdWxlcy8ke3Nob3J0TmFtZX1gLCAvLyBUaGUgZnVsbCBtb2R1bGUgdmlld1xuICAgICAgICBgL2pzL21vZHVsZXMvJHtuYW1lfS5qc2AsIC8vIDw8LS0gREVQUkVDQVRFRDogV2lsbCBiZSByZW1vdmVkIHNob3J0bHkuIE9ubHkgdXNlIHNob3J0TmFtZXNcbiAgICAgICAgYC9qcy9tb2R1bGVzLyR7c2hvcnROYW1lfS86c3Vidmlld2AgLy8gTGl0ZSB2aWV3XG4gICAgICBdLFxuICAgICAgKHJlcSwgcmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzS2V5ID0gbW9kdWxlLnNldHRpbmdzLndlYkJ1bmRsZVxuICAgICAgICBsZXQgYnVuZGxlUGF0aCA9IHBhdGguam9pbihtb2R1bGUucm9vdCwgc2V0dGluZ3NLZXkgfHwgJ2Jpbi93ZWIuYnVuZGxlLmpzJylcblxuICAgICAgICBpZiAocmVxLnBhcmFtcyAmJiByZXEucGFyYW1zLnN1YnZpZXcpIHtcbiAgICAgICAgICAvLyBSZW5kZXIgbGl0ZSB2aWV3XG4gICAgICAgICAgYnVuZGxlUGF0aCA9IHBhdGguam9pbihsaXRlRGlyLCByZXEucGFyYW1zLnN1YnZpZXcgKyAnLmJ1bmRsZS5qcycpXG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoYnVuZGxlUGF0aClcbiAgICAgICAgICByZXMuY29udGVudFR5cGUoJ3RleHQvamF2YXNjcmlwdCcpXG4gICAgICAgICAgcmVzLnNlbmQoY29udGVudClcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgYnAubG9nZ2VyLndhcm4oYENvdWxkIG5vdCBzZXJ2ZSBtb2R1bGUgWyR7bmFtZX1dIGF0OiAke2J1bmRsZVBhdGh9YClcbiAgICAgICAgICByZXMuc2VuZFN0YXR1cyg0MDQpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApXG4gIH1cblxuICBmdW5jdGlvbiBzZXJ2ZUN1c3RvbVRoZW1lKGFwcCkge1xuICAgIGxldCBjdXN0b21UaGVtZSA9ICcnXG5cbiAgICBpZiAoQlBfRURJVElPTiAhPT0gJ2xpdGUnICYmIGJwLmxpY2Vuc2luZy5nZXRGZWF0dXJlcygpLndoaXRlbGFiZWwgPT09IHRydWUpIHtcbiAgICAgIGNvbnN0IHRoZW1lTG9jYXRpb24gPSBwYXRoLmpvaW4oYnAucHJvamVjdExvY2F0aW9uLCAndGhlbWUuY3NzJylcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKHRoZW1lTG9jYXRpb24pKSB7XG4gICAgICAgIGN1c3RvbVRoZW1lID0gZnMucmVhZEZpbGVTeW5jKHRoZW1lTG9jYXRpb24pXG4gICAgICB9XG4gICAgfVxuXG4gICAgYXBwLnVzZSgnL3N0eWxlL2N1c3RvbS10aGVtZS5jc3MnLCAocmVxLCByZXMpID0+IHtcbiAgICAgIHJlcy5jb250ZW50VHlwZSgndGV4dC9jc3MnKVxuICAgICAgcmVzLnNlbmQoY3VzdG9tVGhlbWUpXG4gICAgfSlcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGluc3RhbGwoYXBwKSB7XG4gICAgZm9yIChsZXQgbmFtZSBpbiBicC5fbG9hZGVkTW9kdWxlcykge1xuICAgICAgY29uc3QgbW9kdWxlID0gYnAuX2xvYWRlZE1vZHVsZXNbbmFtZV1cbiAgICAgIHNlcnZlTW9kdWxlKGFwcCwgbW9kdWxlKVxuICAgIH1cblxuICAgIGFwcC51c2UoJy9qcy9lbnYuanMnLCAocmVxLCByZXMpID0+IHtcbiAgICAgIGNvbnN0IHsgdG9rZW5FeHBpcnksIGVuYWJsZWQgfSA9IGJwLmJvdGZpbGUubG9naW5cbiAgICAgIGNvbnN0IG9wdE91dFN0YXRzID0gISFicC5ib3RmaWxlLm9wdE91dFN0YXRzXG4gICAgICBjb25zdCBhcHBOYW1lID0gYnAuYm90ZmlsZS5hcHBOYW1lIHx8ICdCb3RwcmVzcydcblxuICAgICAgY29uc3QgeyBpc0ZpcnN0UnVuLCB2ZXJzaW9uIH0gPSBicFxuICAgICAgcmVzLmNvbnRlbnRUeXBlKCd0ZXh0L2phdmFzY3JpcHQnKVxuICAgICAgcmVzLnNlbmQoYChmdW5jdGlvbih3aW5kb3cpIHtcbiAgICAgICAgd2luZG93Lk5PREVfRU5WID0gXCIke3Byb2Nlc3MuZW52Lk5PREVfRU5WIHx8ICdkZXZlbG9wbWVudCd9XCI7XG4gICAgICAgIHdpbmRvdy5ERVZfTU9ERSA9ICR7dXRpbC5pc0RldmVsb3Bpbmd9O1xuICAgICAgICB3aW5kb3cuQVVUSF9FTkFCTEVEID0gJHtlbmFibGVkfTtcbiAgICAgICAgd2luZG93LkFVVEhfVE9LRU5fRFVSQVRJT04gPSAke21zKHRva2VuRXhwaXJ5KX07XG4gICAgICAgIHdpbmRvdy5PUFRfT1VUX1NUQVRTID0gJHtvcHRPdXRTdGF0c307XG4gICAgICAgIHdpbmRvdy5TSE9XX0dVSURFRF9UT1VSID0gJHtpc0ZpcnN0UnVufTtcbiAgICAgICAgd2luZG93LkJPVFBSRVNTX1ZFUlNJT04gPSBcIiR7dmVyc2lvbn1cIjtcbiAgICAgICAgd2luZG93LkFQUF9OQU1FID0gXCIke2FwcE5hbWV9XCI7XG4gICAgICB9KSh3aW5kb3cgfHwge30pYClcbiAgICB9KVxuXG4gICAgc2VydmVDdXN0b21UaGVtZShhcHApXG5cbiAgICBhcHAudXNlKGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihicC5wcm9qZWN0TG9jYXRpb24sICdzdGF0aWMnKSkpXG5cbiAgICBhcHAudXNlKGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9saWIvd2ViJykpKVxuXG4gICAgYXBwLmdldCgnKicsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgLy8gSWYgYnJvd3NlciByZXF1ZXN0cyBIVE1MIGFuZCByZXF1ZXN0IGlzbid0IGFuIEFQSSByZXF1ZXN0XG4gICAgICBpZiAoL2h0bWwvaS50ZXN0KHJlcS5oZWFkZXJzLmFjY2VwdCkgJiYgIS9eXFwvYXBpXFwvL2kudGVzdChyZXEudXJsKSkge1xuICAgICAgICBpZiAocmVxLnVybCAmJiAvXlxcL2xpdGVcXC8vaS50ZXN0KHJlcS51cmwpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vbGliL3dlYi9saXRlLmh0bWwnKSlcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXMuc2VuZEZpbGUocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL2xpYi93ZWIvaW5kZXguaHRtbCcpKVxuICAgICAgfVxuICAgICAgbmV4dCgpXG4gICAgfSlcblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodHJ1ZSlcbiAgfVxuXG4gIHJldHVybiB7IGluc3RhbGwgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9zZXJ2ZXIvc3RhdGljLmpzIl0sIm1hcHBpbmdzIjoiOztBQUVBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7OztBQUFBO0FBQ0E7Ozs7O0FBUkE7QUFDQTtBQVFBO0FBQUE7QUFBQTtBQWtFQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFBQTtBQUNBO0FBS0E7QUFDQTtBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQ0E7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFuRUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVpBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUErQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///88\n");

/***/ }),
/* 89 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _bodyParser = __webpack_require__(90);\n\nvar _bodyParser2 = _interopRequireDefault(_bodyParser);\n\nvar _express = __webpack_require__(15);\n\nvar _express2 = _interopRequireDefault(_express);\n\nvar _ServiceLocator = __webpack_require__(23);\n\nvar _ServiceLocator2 = _interopRequireDefault(_ServiceLocator);\n\nvar _anonymous = __webpack_require__(91);\n\nvar _anonymous2 = _interopRequireDefault(_anonymous);\n\nvar _secured = __webpack_require__(93);\n\nvar _secured2 = _interopRequireDefault(_secured);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar routersConditions = {};\nvar routers = {};\n\nmodule.exports = function (bp) {\n  var _authenticationMiddleware = function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(req, res, next) {\n      var user;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              res.maybeSendRequireLogin = function () {\n                if (!bp.botfile.login.enabled) {\n                  res.status(400).send({\n                    message: 'Login must be turned on for this API method'\n                  });\n\n                  return true;\n                } else {\n                  return false;\n                }\n              };\n\n              if (bp.botfile.login.enabled) {\n                _context.next = 3;\n                break;\n              }\n\n              return _context.abrupt('return', next());\n\n            case 3:\n              _context.next = 5;\n              return bp.security.authenticate(req.headers.authorization);\n\n            case 5:\n              user = _context.sent;\n\n              if (!!user) {\n                req.user = user;\n                next();\n              } else {\n                res.status(401).location('/login').end();\n              }\n\n            case 7:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    return function _authenticationMiddleware(_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var install = function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(app) {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              installRouter(app);\n              installProtector(app);\n              installMaybeUse(app);\n\n              app.maybeUse('bodyParser.json', _bodyParser2.default.json());\n              app.maybeUse('bodyParser.urlencoded', _bodyParser2.default.urlencoded({ extended: true }));\n\n              (0, _anonymous2.default)(bp, app);\n\n              app.use('/api/*', maybeApply('auth', _authenticationMiddleware));\n\n              (0, _secured2.default)(bp, app);\n\n            case 8:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, this);\n    }));\n\n    return function install(_x7) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  function installRouter(app) {\n    bp.getRouter = function (name, conditions) {\n      if (!/^botpress-/.test(name)) {\n        throw new Error('The name of a router must start with \\'botpress-\\'. Received: ' + name);\n      }\n\n      if (!routers[name]) {\n        var router = _express2.default.Router();\n        routers[name] = router;\n        app.use('/api/' + name + '/', router);\n      }\n\n      if (conditions) {\n        routersConditions[name] = Object.assign(routersConditions[name] || {}, conditions);\n      }\n\n      installProtector(routers[name]);\n      return routers[name];\n    };\n  }\n\n  function installProtector(app) {\n    app.secure = function (operation, ressource) {\n      var wrap = function wrap(method) {\n        return function (name) {\n          var _app$method;\n\n          var secure = function () {\n            var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(req, res, next) {\n              var authorizeApi, authorized;\n              return regeneratorRuntime.wrap(function _callee2$(_context2) {\n                while (1) {\n                  switch (_context2.prev = _context2.next) {\n                    case 0:\n                      _context2.prev = 0;\n\n                      if (req.user) {\n                        _context2.next = 3;\n                        break;\n                      }\n\n                      return _context2.abrupt('return', next());\n\n                    case 3:\n                      _context2.next = 5;\n                      return _ServiceLocator2.default.getService('authorizeApi', false);\n\n                    case 5:\n                      authorizeApi = _context2.sent;\n\n                      if (authorizeApi) {\n                        _context2.next = 8;\n                        break;\n                      }\n\n                      return _context2.abrupt('return', next());\n\n                    case 8:\n                      _context2.next = 10;\n                      return authorizeApi({ userId: req.user.id, operation: operation, ressource: ressource });\n\n                    case 10:\n                      authorized = _context2.sent;\n\n                      if (!authorized) {\n                        _context2.next = 13;\n                        break;\n                      }\n\n                      return _context2.abrupt('return', next());\n\n                    case 13:\n                      return _context2.abrupt('return', res.sendStatus(403));\n\n                    case 16:\n                      _context2.prev = 16;\n                      _context2.t0 = _context2['catch'](0);\n                      return _context2.abrupt('return', res.status(500).send({ message: _context2.t0.message }));\n\n                    case 19:\n                    case 'end':\n                      return _context2.stop();\n                  }\n                }\n              }, _callee2, this, [[0, 16]]);\n            }));\n\n            return function secure(_x4, _x5, _x6) {\n              return _ref2.apply(this, arguments);\n            };\n          }();\n\n          for (var _len = arguments.length, handlers = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            handlers[_key - 1] = arguments[_key];\n          }\n\n          return (_app$method = app[method]).call.apply(_app$method, [app, name, secure].concat(handlers));\n        };\n      };\n\n      return {\n        get: wrap('get'),\n        post: wrap('post'),\n        put: wrap('put'),\n        delete: wrap('delete')\n      };\n    };\n  }\n\n  function installMaybeUse(app) {\n    app.maybeUse = function () {\n      if (arguments.length === 3) {\n        app.use(arguments[0], maybeApply(arguments[1], arguments[2]));\n      } else if (arguments.length === 2) {\n        app.use(maybeApply(arguments[0], arguments[1]));\n      }\n    };\n  }\n\n  return { install: install };\n};\n\nfunction maybeApply(name, fn) {\n  return function (req, res, next) {\n    var router = req.originalUrl.match(/\\/api\\/(botpress-[^\\/]+).*$/i);\n    if (!router) {\n      return fn(req, res, next);\n    }\n\n    if (!routersConditions[router[1]]) {\n      return fn(req, res, next);\n    }\n\n    var condition = routersConditions[router[1]][name];\n    if (condition === false) {\n      next();\n    } else if (typeof condition === 'function' && condition(req) === false) {\n      next();\n    } else {\n      return fn(req, res, next);\n    }\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiODkuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9hcGkuanM/OTZlZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5pbXBvcnQgYm9keVBhcnNlciBmcm9tICdib2R5LXBhcnNlcidcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnXG5cbmltcG9ydCBTZXJ2aWNlTG9jYXRvciBmcm9tICcrL1NlcnZpY2VMb2NhdG9yJ1xuaW1wb3J0IGFub255bW91c0FwaXMgZnJvbSAnLi9hbm9ueW1vdXMnXG5pbXBvcnQgc2VjdXJlZEFwaXMgZnJvbSAnLi9zZWN1cmVkJ1xuXG5jb25zdCByb3V0ZXJzQ29uZGl0aW9ucyA9IHt9XG5jb25zdCByb3V0ZXJzID0ge31cblxubW9kdWxlLmV4cG9ydHMgPSBicCA9PiB7XG4gIGFzeW5jIGZ1bmN0aW9uIF9hdXRoZW50aWNhdGlvbk1pZGRsZXdhcmUocmVxLCByZXMsIG5leHQpIHtcbiAgICByZXMubWF5YmVTZW5kUmVxdWlyZUxvZ2luID0gKCkgPT4ge1xuICAgICAgaWYgKCFicC5ib3RmaWxlLmxvZ2luLmVuYWJsZWQpIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoe1xuICAgICAgICAgIG1lc3NhZ2U6ICdMb2dpbiBtdXN0IGJlIHR1cm5lZCBvbiBmb3IgdGhpcyBBUEkgbWV0aG9kJ1xuICAgICAgICB9KVxuXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWJwLmJvdGZpbGUubG9naW4uZW5hYmxlZCkge1xuICAgICAgcmV0dXJuIG5leHQoKVxuICAgIH1cblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBicC5zZWN1cml0eS5hdXRoZW50aWNhdGUocmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbilcbiAgICBpZiAoISF1c2VyKSB7XG4gICAgICByZXEudXNlciA9IHVzZXJcbiAgICAgIG5leHQoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cyg0MDEpXG4gICAgICAgIC5sb2NhdGlvbignL2xvZ2luJylcbiAgICAgICAgLmVuZCgpXG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaW5zdGFsbFJvdXRlcihhcHApIHtcbiAgICBicC5nZXRSb3V0ZXIgPSBmdW5jdGlvbihuYW1lLCBjb25kaXRpb25zKSB7XG4gICAgICBpZiAoIS9eYm90cHJlc3MtLy50ZXN0KG5hbWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIG5hbWUgb2YgYSByb3V0ZXIgbXVzdCBzdGFydCB3aXRoICdib3RwcmVzcy0nLiBSZWNlaXZlZDogJHtuYW1lfWApXG4gICAgICB9XG5cbiAgICAgIGlmICghcm91dGVyc1tuYW1lXSkge1xuICAgICAgICBjb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpXG4gICAgICAgIHJvdXRlcnNbbmFtZV0gPSByb3V0ZXJcbiAgICAgICAgYXBwLnVzZShgL2FwaS8ke25hbWV9L2AsIHJvdXRlcilcbiAgICAgIH1cblxuICAgICAgaWYgKGNvbmRpdGlvbnMpIHtcbiAgICAgICAgcm91dGVyc0NvbmRpdGlvbnNbbmFtZV0gPSBPYmplY3QuYXNzaWduKHJvdXRlcnNDb25kaXRpb25zW25hbWVdIHx8IHt9LCBjb25kaXRpb25zKVxuICAgICAgfVxuXG4gICAgICBpbnN0YWxsUHJvdGVjdG9yKHJvdXRlcnNbbmFtZV0pXG4gICAgICByZXR1cm4gcm91dGVyc1tuYW1lXVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGluc3RhbGxQcm90ZWN0b3IoYXBwKSB7XG4gICAgYXBwLnNlY3VyZSA9IGZ1bmN0aW9uKG9wZXJhdGlvbiwgcmVzc291cmNlKSB7XG4gICAgICBjb25zdCB3cmFwID0gbWV0aG9kID0+XG4gICAgICAgIGZ1bmN0aW9uKG5hbWUsIC4uLmhhbmRsZXJzKSB7XG4gICAgICAgICAgY29uc3Qgc2VjdXJlID0gYXN5bmMgZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGlmICghcmVxLnVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV4dCgpXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjb25zdCBhdXRob3JpemVBcGkgPSBhd2FpdCBTZXJ2aWNlTG9jYXRvci5nZXRTZXJ2aWNlKCdhdXRob3JpemVBcGknLCBmYWxzZSlcblxuICAgICAgICAgICAgICBpZiAoIWF1dGhvcml6ZUFwaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KClcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGNvbnN0IGF1dGhvcml6ZWQgPSBhd2FpdCBhdXRob3JpemVBcGkoeyB1c2VySWQ6IHJlcS51c2VyLmlkLCBvcGVyYXRpb24sIHJlc3NvdXJjZSB9KVxuXG4gICAgICAgICAgICAgIGlmIChhdXRob3JpemVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHQoKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMykgLy8gSFRUUCBGb3JiaWRkZW5cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiBlcnIubWVzc2FnZSB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBhcHBbbWV0aG9kXS5jYWxsKGFwcCwgbmFtZSwgc2VjdXJlLCAuLi5oYW5kbGVycylcbiAgICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBnZXQ6IHdyYXAoJ2dldCcpLFxuICAgICAgICBwb3N0OiB3cmFwKCdwb3N0JyksXG4gICAgICAgIHB1dDogd3JhcCgncHV0JyksXG4gICAgICAgIGRlbGV0ZTogd3JhcCgnZGVsZXRlJylcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpbnN0YWxsTWF5YmVVc2UoYXBwKSB7XG4gICAgYXBwLm1heWJlVXNlID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgICBhcHAudXNlKGFyZ3VtZW50c1swXSwgbWF5YmVBcHBseShhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSkpXG4gICAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgYXBwLnVzZShtYXliZUFwcGx5KGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBpbnN0YWxsKGFwcCkge1xuICAgIGluc3RhbGxSb3V0ZXIoYXBwKVxuICAgIGluc3RhbGxQcm90ZWN0b3IoYXBwKVxuICAgIGluc3RhbGxNYXliZVVzZShhcHApXG5cbiAgICBhcHAubWF5YmVVc2UoJ2JvZHlQYXJzZXIuanNvbicsIGJvZHlQYXJzZXIuanNvbigpKVxuICAgIGFwcC5tYXliZVVzZSgnYm9keVBhcnNlci51cmxlbmNvZGVkJywgYm9keVBhcnNlci51cmxlbmNvZGVkKHsgZXh0ZW5kZWQ6IHRydWUgfSkpXG5cbiAgICBhbm9ueW1vdXNBcGlzKGJwLCBhcHApXG5cbiAgICBhcHAudXNlKCcvYXBpLyonLCBtYXliZUFwcGx5KCdhdXRoJywgX2F1dGhlbnRpY2F0aW9uTWlkZGxld2FyZSkpXG5cbiAgICBzZWN1cmVkQXBpcyhicCwgYXBwKVxuICB9XG5cbiAgcmV0dXJuIHsgaW5zdGFsbCB9XG59XG5cbmZ1bmN0aW9uIG1heWJlQXBwbHkobmFtZSwgZm4pIHtcbiAgcmV0dXJuIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIGNvbnN0IHJvdXRlciA9IHJlcS5vcmlnaW5hbFVybC5tYXRjaCgvXFwvYXBpXFwvKGJvdHByZXNzLVteXFwvXSspLiokL2kpXG4gICAgaWYgKCFyb3V0ZXIpIHtcbiAgICAgIHJldHVybiBmbihyZXEsIHJlcywgbmV4dClcbiAgICB9XG5cbiAgICBpZiAoIXJvdXRlcnNDb25kaXRpb25zW3JvdXRlclsxXV0pIHtcbiAgICAgIHJldHVybiBmbihyZXEsIHJlcywgbmV4dClcbiAgICB9XG5cbiAgICBjb25zdCBjb25kaXRpb24gPSByb3V0ZXJzQ29uZGl0aW9uc1tyb3V0ZXJbMV1dW25hbWVdXG4gICAgaWYgKGNvbmRpdGlvbiA9PT0gZmFsc2UpIHtcbiAgICAgIG5leHQoKVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmRpdGlvbiA9PT0gJ2Z1bmN0aW9uJyAmJiBjb25kaXRpb24ocmVxKSA9PT0gZmFsc2UpIHtcbiAgICAgIG5leHQoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZm4ocmVxLCByZXMsIG5leHQpXG4gICAgfVxuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3NlcnZlci9hcGkuanMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQ0E7QUFDQTs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFaQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFpQkE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBM0JBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQXFHQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQXRHQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBNkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQU1BO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFZQTtBQUNBO0FBYkE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFGQTtBQUFBO0FBQUE7QUFDQTtBQXdCQTtBQUNBO0FBM0JBO0FBQ0E7QUE0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFnQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///89\n");

/***/ }),
/* 90 */
/***/ (function(module, exports) {

eval("module.exports = require(\"body-parser\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTAuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiPzQ2NTciXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYm9keS1wYXJzZXJcIik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJib2R5LXBhcnNlclwiXG4vLyBtb2R1bGUgaWQgPSA5MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///90\n");

/***/ }),
/* 91 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _api = __webpack_require__(28);\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp, app) {\n\n  app.post('/api/login', function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(req, res) {\n      var result;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              bp.stats.track('api', 'auth', 'login');\n              _context.next = 3;\n              return bp.security.login(req.body.user, req.body.password, req.ip);\n\n            case 3:\n              result = _context.sent;\n\n              res.send(result);\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  var apis = (0, _api2.default)(bp, app);\n  apis.anonymous.map(function (x) {\n    return x && x();\n  }); // Install all anonymous APIs\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTEuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9hbm9ueW1vdXMuanM/MTE0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRXh0cmFBcGlQcm92aWRlcnMgZnJvbSAnKy9hcGknXG5cbm1vZHVsZS5leHBvcnRzID0gKGJwLCBhcHApID0+IHtcblxuICBhcHAucG9zdCgnL2FwaS9sb2dpbicsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnYXV0aCcsICdsb2dpbicpXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYnAuc2VjdXJpdHkubG9naW4ocmVxLmJvZHkudXNlciwgcmVxLmJvZHkucGFzc3dvcmQsIHJlcS5pcClcbiAgICByZXMuc2VuZChyZXN1bHQpXG4gIH0pXG5cbiAgY29uc3QgYXBpcyA9IEV4dHJhQXBpUHJvdmlkZXJzKGJwLCBhcHApXG4gIGFwaXMuYW5vbnltb3VzLm1hcCh4ID0+IHggJiYgeCgpKSAvLyBJbnN0YWxsIGFsbCBhbm9ueW1vdXMgQVBJc1xuICBcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBzcmMvc2VydmVyL2Fub255bW91cy5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFLQTtBQUNBO0FBQUE7QUFBQTtBQUVBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///91\n");

/***/ }),
/* 92 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nmodule.exports = function (bp, app) {\n\n  var installSecured = function installSecured() {\n\n    app.get('/api/my-account', function () {\n      var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(req, res) {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                res.send(req.user);\n\n              case 1:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, undefined);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  };\n\n  var installAnonymous = function installAnonymous() {};\n\n  return {\n    name: '[Lite] Accounts Management',\n    installSecured: installSecured,\n    installAnonymous: installAnonymous\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZW5zaW9ucy9saXRlL2FwaS9hY2NvdW50cy5qcz81ZThhIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gKGJwLCBhcHApID0+IHtcblxuICBjb25zdCBpbnN0YWxsU2VjdXJlZCA9ICgpID0+IHtcbiAgICBcbiAgICBhcHAuZ2V0KCcvYXBpL215LWFjY291bnQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIHJlcy5zZW5kKHJlcS51c2VyKVxuICAgIH0pXG5cbiAgfVxuXG4gIGNvbnN0IGluc3RhbGxBbm9ueW1vdXMgPSAoKSA9PiB7fVxuXG4gIHJldHVybiB7XG4gICAgbmFtZTogJ1tMaXRlXSBBY2NvdW50cyBNYW5hZ2VtZW50JyxcbiAgICBpbnN0YWxsU2VjdXJlZCxcbiAgICBpbnN0YWxsQW5vbnltb3VzXG4gIH1cbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBleHRlbnNpb25zL2xpdGUvYXBpL2FjY291bnRzLmpzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///92\n");

/***/ }),
/* 93 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _lodash = __webpack_require__(0);\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _fs = __webpack_require__(2);\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _path = __webpack_require__(1);\n\nvar _path2 = _interopRequireDefault(_path);\n\nvar _uuid = __webpack_require__(13);\n\nvar _uuid2 = _interopRequireDefault(_uuid);\n\nvar _multer = __webpack_require__(94);\n\nvar _multer2 = _interopRequireDefault(_multer);\n\nvar _bluebird = __webpack_require__(4);\n\nvar _bluebird2 = _interopRequireDefault(_bluebird);\n\nvar _util = __webpack_require__(3);\n\nvar _util2 = _interopRequireDefault(_util);\n\nvar _api = __webpack_require__(28);\n\nvar _api2 = _interopRequireDefault(_api);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new _bluebird2.default(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return _bluebird2.default.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\nvar logsSecret = _uuid2.default.v4();\n\nmodule.exports = function (bp, app) {\n  app.get('/api/ping', function (req, res) {\n    res.send('pong');\n  });\n\n  app.secure('read', 'modules/list').get('/api/modules', function (req, res) {\n    var modules = _lodash2.default.map(bp._loadedModules, function (module) {\n      return {\n        name: module.name,\n        homepage: module.homepage,\n        menuText: module.settings.menuText || module.name,\n        menuIcon: module.settings.menuIcon || 'view_module',\n        noInterface: !!module.settings.noInterface,\n        plugins: module.settings.plugins || []\n      };\n    });\n    res.send(modules);\n  });\n\n  app.secure('read', 'middleware/list').get('/api/middlewares', function (req, res) {\n    res.send(bp.middlewares.list());\n  });\n\n  app.secure('write', 'middleware/customizations').post('/api/middlewares/customizations', function (req, res) {\n    bp.stats.track('api', 'middlewares', 'customizations');\n    var middlewares = req.body.middlewares;\n\n    bp.middlewares.setCustomizations(middlewares);\n    bp.middlewares.load();\n    res.send(bp.middlewares.list());\n  });\n\n  app.secure('write', 'middleware/customizations').delete('/api/middlewares/customizations', function (req, res) {\n    bp.stats.track('api', 'middlewares', 'customizations');\n    bp.middlewares.resetCustomizations();\n    bp.middlewares.load();\n    res.send(bp.middlewares.list());\n  });\n\n  // DEPRECATED in Botpress 1.1\n  app.secure('read', 'notifications').get('/api/notifications', function () {\n    var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(req, res) {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = res;\n              _context.next = 3;\n              return bp.notifications.getInbox();\n\n            case 3:\n              _context.t1 = _context.sent;\n\n              _context.t0.send.call(_context.t0, _context.t1);\n\n            case 5:\n            case 'end':\n              return _context.stop();\n          }\n        }\n      }, _callee, undefined);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'notifications').get('/api/notifications/inbox', function () {\n    var _ref2 = _asyncToGenerator(regeneratorRuntime.mark(function _callee2(req, res) {\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.t0 = res;\n              _context2.next = 3;\n              return bp.notifications.getInbox();\n\n            case 3:\n              _context2.t1 = _context2.sent;\n\n              _context2.t0.send.call(_context2.t0, _context2.t1);\n\n            case 5:\n            case 'end':\n              return _context2.stop();\n          }\n        }\n      }, _callee2, undefined);\n    }));\n\n    return function (_x3, _x4) {\n      return _ref2.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot/information').get('/api/bot/information', function (req, res) {\n    res.send(bp.about.getBotInformation());\n  });\n\n  app.secure('read', 'modules/list/community').get('/api/module/all', function (req, res) {\n    bp.modules.listAllCommunityModules().then(function (modules) {\n      return res.send(modules);\n    });\n  });\n\n  app.secure('read', 'modules/list/community').get('/api/module/hero', function (req, res) {\n    bp.modules.getRandomCommunityHero().then(function (hero) {\n      return res.send(hero);\n    });\n  });\n\n  app.get('/api/bot/production', function (req, res) {\n    res.send(!_util2.default.isDeveloping);\n  });\n\n  app.secure('read', 'modules/list/community').get('/api/bot/contributor', function (req, res) {\n    res.send(bp.bot.getContributor());\n  });\n\n  app.get('/api/license', function () {\n    var _ref3 = _asyncToGenerator(regeneratorRuntime.mark(function _callee3(req, res) {\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.t0 = res;\n              _context3.next = 3;\n              return bp.licensing.getLicensing();\n\n            case 3:\n              _context3.t1 = _context3.sent;\n\n              _context3.t0.send.call(_context3.t0, _context3.t1);\n\n            case 5:\n            case 'end':\n              return _context3.stop();\n          }\n        }\n      }, _callee3, undefined);\n    }));\n\n    return function (_x5, _x6) {\n      return _ref3.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot/information/license').post('/api/license', function (req, res) {\n    bp.stats.track('api', 'license', 'change');\n    bp.licensing.changeLicense(req.body.license).then(function () {\n      res.sendStatus(200);\n    }).catch(function (err) {\n      return res.status(500).send({\n        message: err && err.message\n      });\n    });\n  });\n\n  app.secure('write', 'modules/list/install').post('/api/module/install/:name', function (req, res) {\n    bp.stats.track('api', 'modules', 'install');\n    var name = req.params.name;\n\n    bp.modules.install(name).then(function () {\n      res.sendStatus(200);\n      bp.restart(1000);\n    }).catch(function (err) {\n      return res.status(500).send({\n        message: err && err.message\n      });\n    });\n  });\n\n  app.secure('write', 'modules/list/uninstall').delete('/api/module/uninstall/:name', function (req, res) {\n    bp.stats.track('api', 'modules', 'uninstall');\n    var name = req.params.name;\n\n    bp.modules.uninstall(name).then(function () {\n      res.sendStatus(200);\n      bp.restart(1000);\n    }).catch(function (err) {\n      return res.status(500).send({\n        message: err && err.message\n      });\n    });\n  });\n\n  app.delete('/api/guided-tour', function (req, res) {\n    _fs2.default.unlink(_path2.default.join(bp.projectLocation, '.welcome'), function () {\n      bp.isFirstRun = false;\n      res.sendStatus(200);\n    });\n  });\n\n  app.secure('read', 'bot/logs').get('/api/logs', function (req, res) {\n    var options = {\n      from: new Date() - 7 * 24 * 60 * 60 * 1000,\n      until: new Date(),\n      limit: req.query && req.query.limit || 50,\n      start: 0,\n      order: 'desc',\n      fields: ['message', 'level', 'timestamp']\n    };\n\n    bp.logger.query(options, function (err, results) {\n      if (err) {\n        return console.log(err);\n      }\n      res.send(results.file);\n    });\n  });\n\n  app.secure('read', 'bot/logs').get('/api/logs/key', function (req, res) {\n    res.send({ secret: logsSecret });\n  });\n\n  app.secure('read', 'bot/logs/archive').get('/logs/archive/:key', function (req, res) {\n    bp.stats.track('api', 'logs', 'archive');\n    if (req.params.key !== logsSecret) {\n      return res.sendStatus(403);\n    }\n\n    bp.logger.archiveToFile().then(function (archivePath) {\n      logsSecret = _uuid2.default.v4();\n      res.download(archivePath);\n    });\n  });\n\n  app.secure('read', 'bot/umm/blocs').get('/umm/blocs', function (req, res) {\n    var content = bp.umm.getDocument();\n    res.send({ content: content });\n  });\n\n  app.secure('read', 'bot/umm/templates').get('/umm/templates', function (req, res) {\n    res.send({ templates: bp.umm.getTemplates() });\n  });\n\n  app.secure('write', 'bot/umm/blocs').post('/umm/blocs', function (req, res) {\n    var _ref4 = req.body || {},\n        content = _ref4.content;\n\n    if (_lodash2.default.isNil(content)) {\n      return res.status(400).send({ message: 'You need to specify the content' });\n    }\n\n    bp.umm.saveDocument(content);\n\n    return res.sendStatus(200);\n  });\n\n  app.secure('write', 'bot/umm/simulation').post('/umm/simulate', function (req, res) {\n    try {\n      var _req$body = req.body,\n          context = _req$body.context,\n          content = _req$body.content,\n          outputPlatform = _req$body.outputPlatform,\n          incomingEvent = _req$body.incomingEvent;\n\n      var blocs = bp.umm.parse({ context: context, outputPlatform: outputPlatform, markdown: content, incomingEvent: incomingEvent });\n      res.send(blocs);\n    } catch (err) {\n      res.status(400).send({ message: err.message });\n    }\n  });\n\n  app.secure('read', 'bot/content').get('/content/categories', function () {\n    var _ref5 = _asyncToGenerator(regeneratorRuntime.mark(function _callee4(req, res) {\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.t0 = res;\n              _context4.next = 3;\n              return bp.contentManager.listAvailableCategories();\n\n            case 3:\n              _context4.t1 = _context4.sent;\n\n              _context4.t0.send.call(_context4.t0, _context4.t1);\n\n            case 5:\n            case 'end':\n              return _context4.stop();\n          }\n        }\n      }, _callee4, undefined);\n    }));\n\n    return function (_x7, _x8) {\n      return _ref5.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot/content').get('/content/categories/:id/schema', function () {\n    var _ref6 = _asyncToGenerator(regeneratorRuntime.mark(function _callee5(req, res) {\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.t0 = res;\n              _context5.next = 3;\n              return bp.contentManager.getCategorySchema(req.params.id);\n\n            case 3:\n              _context5.t1 = _context5.sent;\n\n              _context5.t0.send.call(_context5.t0, _context5.t1);\n\n            case 5:\n            case 'end':\n              return _context5.stop();\n          }\n        }\n      }, _callee5, undefined);\n    }));\n\n    return function (_x9, _x10) {\n      return _ref6.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot/content').get('/content/categories/:id/items', function () {\n    var _ref7 = _asyncToGenerator(regeneratorRuntime.mark(function _callee6(req, res) {\n      var from, count, searchTerm;\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              if (req.params.id === 'all') {\n                req.params.id = null;\n              }\n\n              from = req.query.from || 0;\n              count = req.query.count || 50;\n              searchTerm = req.query.search;\n              _context6.t0 = res;\n              _context6.next = 7;\n              return bp.contentManager.listCategoryItems(req.params.id, from, count, searchTerm);\n\n            case 7:\n              _context6.t1 = _context6.sent;\n\n              _context6.t0.send.call(_context6.t0, _context6.t1);\n\n            case 9:\n            case 'end':\n              return _context6.stop();\n          }\n        }\n      }, _callee6, undefined);\n    }));\n\n    return function (_x11, _x12) {\n      return _ref7.apply(this, arguments);\n    };\n  }());\n\n  app.secure('read', 'bot/content').get('/content/export', function () {\n    var _ref8 = _asyncToGenerator(regeneratorRuntime.mark(function _callee7(req, res) {\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              res.setHeader('Content-disposition', 'attachment; filename=content-export.json');\n              _context7.t0 = res;\n              _context7.next = 4;\n              return bp.contentManager.exportContent();\n\n            case 4:\n              _context7.t1 = _context7.sent;\n\n              _context7.t0.send.call(_context7.t0, _context7.t1);\n\n            case 6:\n            case 'end':\n              return _context7.stop();\n          }\n        }\n      }, _callee7, undefined);\n    }));\n\n    return function (_x13, _x14) {\n      return _ref8.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot/content').post('/content/categories/:id/items', function () {\n    var _ref9 = _asyncToGenerator(regeneratorRuntime.mark(function _callee8(req, res) {\n      return regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.t0 = res;\n              _context8.next = 3;\n              return bp.contentManager.createOrUpdateCategoryItem({\n                formData: req.body.formData,\n                categoryId: req.params.id\n              });\n\n            case 3:\n              _context8.t1 = _context8.sent;\n\n              _context8.t0.send.call(_context8.t0, _context8.t1);\n\n            case 5:\n            case 'end':\n              return _context8.stop();\n          }\n        }\n      }, _callee8, undefined);\n    }));\n\n    return function (_x15, _x16) {\n      return _ref9.apply(this, arguments);\n    };\n  }());\n\n  var contentUploadMulter = (0, _multer2.default)({\n    limits: {\n      fileSize: 1024 * 1000 * 10, // 10mb\n      files: 5 // Max 5 files\n    },\n    fileFilter: function fileFilter(req, file, cb) {\n      if (file.mimetype !== 'application/json') {\n        cb(null, false);\n      } else {\n        cb(null, true);\n      }\n    }\n  });\n\n  app.secure('write', 'bot/content').post('/content/upload', contentUploadMulter.array('files[]'), function () {\n    var _ref10 = _asyncToGenerator(regeneratorRuntime.mark(function _callee9(req, res) {\n      var documents;\n      return regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              _context9.prev = 0;\n              documents = req.files.map(function (file) {\n                return JSON.parse(file.buffer.toString());\n              });\n              _context9.next = 4;\n              return _bluebird2.default.mapSeries(documents, function (doc) {\n                return bp.contentManager.importContent(doc);\n              });\n\n            case 4:\n              res.send({ success: true });\n              _context9.next = 10;\n              break;\n\n            case 7:\n              _context9.prev = 7;\n              _context9.t0 = _context9['catch'](0);\n\n              res.status(500).send(_context9.t0.message);\n\n            case 10:\n            case 'end':\n              return _context9.stop();\n          }\n        }\n      }, _callee9, undefined, [[0, 7]]);\n    }));\n\n    return function (_x17, _x18) {\n      return _ref10.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot/content').post('/content/categories/:id/items/:itemId', function () {\n    var _ref11 = _asyncToGenerator(regeneratorRuntime.mark(function _callee10(req, res) {\n      return regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.next = 2;\n              return bp.contentManager.createOrUpdateCategoryItem({\n                itemId: req.params.itemId,\n                formData: req.body.formData,\n                categoryId: req.params.id\n              });\n\n            case 2:\n              res.sendStatus(200);\n\n            case 3:\n            case 'end':\n              return _context10.stop();\n          }\n        }\n      }, _callee10, undefined);\n    }));\n\n    return function (_x19, _x20) {\n      return _ref11.apply(this, arguments);\n    };\n  }());\n\n  app.secure('write', 'bot/content').post('/content/categories/all/bulk_delete', function () {\n    var _ref12 = _asyncToGenerator(regeneratorRuntime.mark(function _callee11(req, res) {\n      return regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              _context11.next = 2;\n              return bp.contentManager.deleteCategoryItems(req.body);\n\n            case 2:\n              res.sendStatus(200);\n\n            case 3:\n            case 'end':\n              return _context11.stop();\n          }\n        }\n      }, _callee11, undefined);\n    }));\n\n    return function (_x21, _x22) {\n      return _ref12.apply(this, arguments);\n    };\n  }());\n\n  var apis = (0, _api2.default)(bp, app);\n  apis.secured.map(function (x) {\n    return x && x();\n  }); // Install all secured APIs\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vc3JjL3NlcnZlci9zZWN1cmVkLmpzPzExNjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJ1xuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCB1dWlkIGZyb20gJ3V1aWQnXG5pbXBvcnQgbXVsdGVyIGZyb20gJ211bHRlcidcbmltcG9ydCBQcm9taXNlIGZyb20gJ2JsdWViaXJkJ1xuXG5pbXBvcnQgdXRpbCBmcm9tICcuLi91dGlsJ1xuaW1wb3J0IEV4dHJhQXBpUHJvdmlkZXJzIGZyb20gJysvYXBpJ1xuXG5sZXQgbG9nc1NlY3JldCA9IHV1aWQudjQoKVxuXG5tb2R1bGUuZXhwb3J0cyA9IChicCwgYXBwKSA9PiB7XG4gIGFwcC5nZXQoJy9hcGkvcGluZycsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKCdwb25nJylcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ21vZHVsZXMvbGlzdCcpLmdldCgnL2FwaS9tb2R1bGVzJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlcyA9IF8ubWFwKGJwLl9sb2FkZWRNb2R1bGVzLCBtb2R1bGUgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogbW9kdWxlLm5hbWUsXG4gICAgICAgIGhvbWVwYWdlOiBtb2R1bGUuaG9tZXBhZ2UsXG4gICAgICAgIG1lbnVUZXh0OiBtb2R1bGUuc2V0dGluZ3MubWVudVRleHQgfHwgbW9kdWxlLm5hbWUsXG4gICAgICAgIG1lbnVJY29uOiBtb2R1bGUuc2V0dGluZ3MubWVudUljb24gfHwgJ3ZpZXdfbW9kdWxlJyxcbiAgICAgICAgbm9JbnRlcmZhY2U6ICEhbW9kdWxlLnNldHRpbmdzLm5vSW50ZXJmYWNlLFxuICAgICAgICBwbHVnaW5zOiBtb2R1bGUuc2V0dGluZ3MucGx1Z2lucyB8fCBbXVxuICAgICAgfVxuICAgIH0pXG4gICAgcmVzLnNlbmQobW9kdWxlcylcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ21pZGRsZXdhcmUvbGlzdCcpLmdldCgnL2FwaS9taWRkbGV3YXJlcycsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGJwLm1pZGRsZXdhcmVzLmxpc3QoKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdtaWRkbGV3YXJlL2N1c3RvbWl6YXRpb25zJykucG9zdCgnL2FwaS9taWRkbGV3YXJlcy9jdXN0b21pemF0aW9ucycsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnbWlkZGxld2FyZXMnLCAnY3VzdG9taXphdGlvbnMnKVxuICAgIGNvbnN0IHsgbWlkZGxld2FyZXMgfSA9IHJlcS5ib2R5XG4gICAgYnAubWlkZGxld2FyZXMuc2V0Q3VzdG9taXphdGlvbnMobWlkZGxld2FyZXMpXG4gICAgYnAubWlkZGxld2FyZXMubG9hZCgpXG4gICAgcmVzLnNlbmQoYnAubWlkZGxld2FyZXMubGlzdCgpKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3dyaXRlJywgJ21pZGRsZXdhcmUvY3VzdG9taXphdGlvbnMnKS5kZWxldGUoJy9hcGkvbWlkZGxld2FyZXMvY3VzdG9taXphdGlvbnMnLCAocmVxLCByZXMpID0+IHtcbiAgICBicC5zdGF0cy50cmFjaygnYXBpJywgJ21pZGRsZXdhcmVzJywgJ2N1c3RvbWl6YXRpb25zJylcbiAgICBicC5taWRkbGV3YXJlcy5yZXNldEN1c3RvbWl6YXRpb25zKClcbiAgICBicC5taWRkbGV3YXJlcy5sb2FkKClcbiAgICByZXMuc2VuZChicC5taWRkbGV3YXJlcy5saXN0KCkpXG4gIH0pXG5cbiAgLy8gREVQUkVDQVRFRCBpbiBCb3RwcmVzcyAxLjFcbiAgYXBwLnNlY3VyZSgncmVhZCcsICdub3RpZmljYXRpb25zJykuZ2V0KCcvYXBpL25vdGlmaWNhdGlvbnMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5ub3RpZmljYXRpb25zLmdldEluYm94KCkpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdub3RpZmljYXRpb25zJykuZ2V0KCcvYXBpL25vdGlmaWNhdGlvbnMvaW5ib3gnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5ub3RpZmljYXRpb25zLmdldEluYm94KCkpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QvaW5mb3JtYXRpb24nKS5nZXQoJy9hcGkvYm90L2luZm9ybWF0aW9uJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoYnAuYWJvdXQuZ2V0Qm90SW5mb3JtYXRpb24oKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ21vZHVsZXMvbGlzdC9jb21tdW5pdHknKS5nZXQoJy9hcGkvbW9kdWxlL2FsbCcsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLm1vZHVsZXMubGlzdEFsbENvbW11bml0eU1vZHVsZXMoKS50aGVuKG1vZHVsZXMgPT4gcmVzLnNlbmQobW9kdWxlcykpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdtb2R1bGVzL2xpc3QvY29tbXVuaXR5JykuZ2V0KCcvYXBpL21vZHVsZS9oZXJvJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgYnAubW9kdWxlcy5nZXRSYW5kb21Db21tdW5pdHlIZXJvKCkudGhlbihoZXJvID0+IHJlcy5zZW5kKGhlcm8pKVxuICB9KVxuXG4gIGFwcC5nZXQoJy9hcGkvYm90L3Byb2R1Y3Rpb24nLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZCghdXRpbC5pc0RldmVsb3BpbmcpXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdtb2R1bGVzL2xpc3QvY29tbXVuaXR5JykuZ2V0KCcvYXBpL2JvdC9jb250cmlidXRvcicsIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGJwLmJvdC5nZXRDb250cmlidXRvcigpKVxuICB9KVxuXG4gIGFwcC5nZXQoJy9hcGkvbGljZW5zZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHJlcy5zZW5kKGF3YWl0IGJwLmxpY2Vuc2luZy5nZXRMaWNlbnNpbmcoKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QvaW5mb3JtYXRpb24vbGljZW5zZScpLnBvc3QoJy9hcGkvbGljZW5zZScsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnbGljZW5zZScsICdjaGFuZ2UnKVxuICAgIGJwLmxpY2Vuc2luZ1xuICAgICAgLmNoYW5nZUxpY2Vuc2UocmVxLmJvZHkubGljZW5zZSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT5cbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoe1xuICAgICAgICAgIG1lc3NhZ2U6IGVyciAmJiBlcnIubWVzc2FnZVxuICAgICAgICB9KVxuICAgICAgKVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3dyaXRlJywgJ21vZHVsZXMvbGlzdC9pbnN0YWxsJykucG9zdCgnL2FwaS9tb2R1bGUvaW5zdGFsbC86bmFtZScsIChyZXEsIHJlcykgPT4ge1xuICAgIGJwLnN0YXRzLnRyYWNrKCdhcGknLCAnbW9kdWxlcycsICdpbnN0YWxsJylcbiAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5wYXJhbXNcbiAgICBicC5tb2R1bGVzXG4gICAgICAuaW5zdGFsbChuYW1lKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXMuc2VuZFN0YXR1cygyMDApXG4gICAgICAgIGJwLnJlc3RhcnQoMTAwMClcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+XG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHtcbiAgICAgICAgICBtZXNzYWdlOiBlcnIgJiYgZXJyLm1lc3NhZ2VcbiAgICAgICAgfSlcbiAgICAgIClcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdtb2R1bGVzL2xpc3QvdW5pbnN0YWxsJykuZGVsZXRlKCcvYXBpL21vZHVsZS91bmluc3RhbGwvOm5hbWUnLCAocmVxLCByZXMpID0+IHtcbiAgICBicC5zdGF0cy50cmFjaygnYXBpJywgJ21vZHVsZXMnLCAndW5pbnN0YWxsJylcbiAgICBjb25zdCB7IG5hbWUgfSA9IHJlcS5wYXJhbXNcbiAgICBicC5tb2R1bGVzXG4gICAgICAudW5pbnN0YWxsKG5hbWUpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcbiAgICAgICAgYnAucmVzdGFydCgxMDAwKVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT5cbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoe1xuICAgICAgICAgIG1lc3NhZ2U6IGVyciAmJiBlcnIubWVzc2FnZVxuICAgICAgICB9KVxuICAgICAgKVxuICB9KVxuXG4gIGFwcC5kZWxldGUoJy9hcGkvZ3VpZGVkLXRvdXInLCAocmVxLCByZXMpID0+IHtcbiAgICBmcy51bmxpbmsocGF0aC5qb2luKGJwLnByb2plY3RMb2NhdGlvbiwgJy53ZWxjb21lJyksICgpID0+IHtcbiAgICAgIGJwLmlzRmlyc3RSdW4gPSBmYWxzZVxuICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgIH0pXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QvbG9ncycpLmdldCgnL2FwaS9sb2dzJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGZyb206IG5ldyBEYXRlKCkgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgIHVudGlsOiBuZXcgRGF0ZSgpLFxuICAgICAgbGltaXQ6IChyZXEucXVlcnkgJiYgcmVxLnF1ZXJ5LmxpbWl0KSB8fCA1MCxcbiAgICAgIHN0YXJ0OiAwLFxuICAgICAgb3JkZXI6ICdkZXNjJyxcbiAgICAgIGZpZWxkczogWydtZXNzYWdlJywgJ2xldmVsJywgJ3RpbWVzdGFtcCddXG4gICAgfVxuXG4gICAgYnAubG9nZ2VyLnF1ZXJ5KG9wdGlvbnMsIChlcnIsIHJlc3VsdHMpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycilcbiAgICAgIH1cbiAgICAgIHJlcy5zZW5kKHJlc3VsdHMuZmlsZSlcbiAgICB9KVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90L2xvZ3MnKS5nZXQoJy9hcGkvbG9ncy9rZXknLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZCh7IHNlY3JldDogbG9nc1NlY3JldCB9KVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3JlYWQnLCAnYm90L2xvZ3MvYXJjaGl2ZScpLmdldCgnL2xvZ3MvYXJjaGl2ZS86a2V5JywgKHJlcSwgcmVzKSA9PiB7XG4gICAgYnAuc3RhdHMudHJhY2soJ2FwaScsICdsb2dzJywgJ2FyY2hpdmUnKVxuICAgIGlmIChyZXEucGFyYW1zLmtleSAhPT0gbG9nc1NlY3JldCkge1xuICAgICAgcmV0dXJuIHJlcy5zZW5kU3RhdHVzKDQwMylcbiAgICB9XG5cbiAgICBicC5sb2dnZXIuYXJjaGl2ZVRvRmlsZSgpLnRoZW4oYXJjaGl2ZVBhdGggPT4ge1xuICAgICAgbG9nc1NlY3JldCA9IHV1aWQudjQoKVxuICAgICAgcmVzLmRvd25sb2FkKGFyY2hpdmVQYXRoKVxuICAgIH0pXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QvdW1tL2Jsb2NzJykuZ2V0KCcvdW1tL2Jsb2NzJywgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgY29udGVudCA9IGJwLnVtbS5nZXREb2N1bWVudCgpXG4gICAgcmVzLnNlbmQoeyBjb250ZW50OiBjb250ZW50IH0pXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgncmVhZCcsICdib3QvdW1tL3RlbXBsYXRlcycpLmdldCgnL3VtbS90ZW1wbGF0ZXMnLCAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZCh7IHRlbXBsYXRlczogYnAudW1tLmdldFRlbXBsYXRlcygpIH0pXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90L3VtbS9ibG9jcycpLnBvc3QoJy91bW0vYmxvY3MnLCAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGNvbnRlbnQgfSA9IHJlcS5ib2R5IHx8IHt9XG4gICAgaWYgKF8uaXNOaWwoY29udGVudCkpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdZb3UgbmVlZCB0byBzcGVjaWZ5IHRoZSBjb250ZW50JyB9KVxuICAgIH1cblxuICAgIGJwLnVtbS5zYXZlRG9jdW1lbnQoY29udGVudClcblxuICAgIHJldHVybiByZXMuc2VuZFN0YXR1cygyMDApXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90L3VtbS9zaW11bGF0aW9uJykucG9zdCgnL3VtbS9zaW11bGF0ZScsIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNvbnRleHQsIGNvbnRlbnQsIG91dHB1dFBsYXRmb3JtLCBpbmNvbWluZ0V2ZW50IH0gPSByZXEuYm9keVxuICAgICAgY29uc3QgYmxvY3MgPSBicC51bW0ucGFyc2UoeyBjb250ZXh0LCBvdXRwdXRQbGF0Zm9ybSwgbWFya2Rvd246IGNvbnRlbnQsIGluY29taW5nRXZlbnQgfSlcbiAgICAgIHJlcy5zZW5kKGJsb2NzKVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmVzLnN0YXR1cyg0MDApLnNlbmQoeyBtZXNzYWdlOiBlcnIubWVzc2FnZSB9KVxuICAgIH1cbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC9jb250ZW50JykuZ2V0KCcvY29udGVudC9jYXRlZ29yaWVzJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoYXdhaXQgYnAuY29udGVudE1hbmFnZXIubGlzdEF2YWlsYWJsZUNhdGVnb3JpZXMoKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC9jb250ZW50JykuZ2V0KCcvY29udGVudC9jYXRlZ29yaWVzLzppZC9zY2hlbWEnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2VuZChhd2FpdCBicC5jb250ZW50TWFuYWdlci5nZXRDYXRlZ29yeVNjaGVtYShyZXEucGFyYW1zLmlkKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC9jb250ZW50JykuZ2V0KCcvY29udGVudC9jYXRlZ29yaWVzLzppZC9pdGVtcycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmIChyZXEucGFyYW1zLmlkID09PSAnYWxsJykge1xuICAgICAgcmVxLnBhcmFtcy5pZCA9IG51bGxcbiAgICB9XG5cbiAgICBjb25zdCBmcm9tID0gcmVxLnF1ZXJ5LmZyb20gfHwgMFxuICAgIGNvbnN0IGNvdW50ID0gcmVxLnF1ZXJ5LmNvdW50IHx8IDUwXG4gICAgY29uc3Qgc2VhcmNoVGVybSA9IHJlcS5xdWVyeS5zZWFyY2hcblxuICAgIHJlcy5zZW5kKGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmxpc3RDYXRlZ29yeUl0ZW1zKHJlcS5wYXJhbXMuaWQsIGZyb20sIGNvdW50LCBzZWFyY2hUZXJtKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCdyZWFkJywgJ2JvdC9jb250ZW50JykuZ2V0KCcvY29udGVudC9leHBvcnQnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LWRpc3Bvc2l0aW9uJywgJ2F0dGFjaG1lbnQ7IGZpbGVuYW1lPWNvbnRlbnQtZXhwb3J0Lmpzb24nKVxuICAgIHJlcy5zZW5kKGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmV4cG9ydENvbnRlbnQoKSlcbiAgfSlcblxuICBhcHAuc2VjdXJlKCd3cml0ZScsICdib3QvY29udGVudCcpLnBvc3QoJy9jb250ZW50L2NhdGVnb3JpZXMvOmlkL2l0ZW1zJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgcmVzLnNlbmQoXG4gICAgICBhd2FpdCBicC5jb250ZW50TWFuYWdlci5jcmVhdGVPclVwZGF0ZUNhdGVnb3J5SXRlbSh7XG4gICAgICAgIGZvcm1EYXRhOiByZXEuYm9keS5mb3JtRGF0YSxcbiAgICAgICAgY2F0ZWdvcnlJZDogcmVxLnBhcmFtcy5pZFxuICAgICAgfSlcbiAgICApXG4gIH0pXG5cbiAgY29uc3QgY29udGVudFVwbG9hZE11bHRlciA9IG11bHRlcih7XG4gICAgbGltaXRzOiB7XG4gICAgICBmaWxlU2l6ZTogMTAyNCAqIDEwMDAgKiAxMCwgLy8gMTBtYlxuICAgICAgZmlsZXM6IDUgLy8gTWF4IDUgZmlsZXNcbiAgICB9LFxuICAgIGZpbGVGaWx0ZXI6IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICBpZiAoZmlsZS5taW1ldHlwZSAhPT0gJ2FwcGxpY2F0aW9uL2pzb24nKSB7XG4gICAgICAgIGNiKG51bGwsIGZhbHNlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2IobnVsbCwgdHJ1ZSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90L2NvbnRlbnQnKS5wb3N0KCcvY29udGVudC91cGxvYWQnLCBjb250ZW50VXBsb2FkTXVsdGVyLmFycmF5KCdmaWxlc1tdJyksIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkb2N1bWVudHMgPSByZXEuZmlsZXMubWFwKGZpbGUgPT4gSlNPTi5wYXJzZShmaWxlLmJ1ZmZlci50b1N0cmluZygpKSlcbiAgICAgIGF3YWl0IFByb21pc2UubWFwU2VyaWVzKGRvY3VtZW50cywgZG9jID0+IGJwLmNvbnRlbnRNYW5hZ2VyLmltcG9ydENvbnRlbnQoZG9jKSlcbiAgICAgIHJlcy5zZW5kKHsgc3VjY2VzczogdHJ1ZSB9KVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyLm1lc3NhZ2UpXG4gICAgfVxuICB9KVxuXG4gIGFwcC5zZWN1cmUoJ3dyaXRlJywgJ2JvdC9jb250ZW50JykucG9zdCgnL2NvbnRlbnQvY2F0ZWdvcmllcy86aWQvaXRlbXMvOml0ZW1JZCcsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmNyZWF0ZU9yVXBkYXRlQ2F0ZWdvcnlJdGVtKHtcbiAgICAgIGl0ZW1JZDogcmVxLnBhcmFtcy5pdGVtSWQsXG4gICAgICBmb3JtRGF0YTogcmVxLmJvZHkuZm9ybURhdGEsXG4gICAgICBjYXRlZ29yeUlkOiByZXEucGFyYW1zLmlkXG4gICAgfSlcbiAgICByZXMuc2VuZFN0YXR1cygyMDApXG4gIH0pXG5cbiAgYXBwLnNlY3VyZSgnd3JpdGUnLCAnYm90L2NvbnRlbnQnKS5wb3N0KCcvY29udGVudC9jYXRlZ29yaWVzL2FsbC9idWxrX2RlbGV0ZScsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGF3YWl0IGJwLmNvbnRlbnRNYW5hZ2VyLmRlbGV0ZUNhdGVnb3J5SXRlbXMocmVxLmJvZHkpXG4gICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICB9KVxuXG4gIGNvbnN0IGFwaXMgPSBFeHRyYUFwaVByb3ZpZGVycyhicCwgYXBwKVxuICBhcGlzLnNlY3VyZWQubWFwKHggPT4geCAmJiB4KCkpIC8vIEluc3RhbGwgYWxsIHNlY3VyZWQgQVBJc1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHNyYy9zZXJ2ZXIvc2VjdXJlZC5qcyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFBQTtBQUNBOzs7QUFDQTtBQUNBOzs7QUFBQTtBQUNBOzs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFEQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFEQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQURBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTkE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRkE7QUFDQTtBQUhBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVhBO0FBQ0E7QUFhQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUFBO0FBRkE7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUpBO0FBSUE7QUFKQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQUNBO0FBRkE7QUFNQTtBQUNBO0FBUEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFRQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUVBO0FBQ0E7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///93\n");

/***/ }),
/* 94 */
/***/ (function(module, exports) {

eval("module.exports = require(\"multer\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOTQuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtdWx0ZXJcIj9jMjkxIl0sInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm11bHRlclwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcIm11bHRlclwiXG4vLyBtb2R1bGUgaWQgPSA5NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwibWFwcGluZ3MiOiJBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///94\n");

/***/ })
/******/ ]);